To determine the most likely ATT&CK technique that occurred after the malspam campaign and before the ComboJack malware ensured persistence, let's analyze the given information step by step.

1. **Analyzing the Question**: The question describes a sequence of events starting with a malspam campaign that uses an HTA (HTML Application) file. This HTA file contains encoded commands designed to exploit CVE-2017-8579, a vulnerability in Microsoft Office. After the exploitation, the question asks which technique likely occurred before ComboJack malware ensured persistence by setting a registry key.

2. **Understanding the Initial Exploitation**: The initial step involves exploiting CVE-2017-8579, which is a vulnerability that can allow remote code execution. This exploitation is followed by the execution of encoded commands within an HTA file, which suggests the adversary is using a scripting or command execution technique to achieve their goals.

3. **Analyzing the Related TTPs**: The provided TTPs (Tactics, Techniques, and Procedures) include Defense Evasion (with a focus on code signing policy modification), and Persistence (focusing on registry run keys/startup folders and boot or logon autostart execution). These TTPs give context to the adversary's goals post-exploitation, including evading detection and maintaining access.

4. **Evaluating Answer Choices**:
   - **A: T1129-Shared Modules**: This technique involves using shared modules to evade detection. While it could be part of the attack, it doesn't directly relate to the execution of commands post-exploitation or the setup for persistence.
   - **B: T1059-Command and Scripting Interpreter**: Given the HTA file contains encoded commands, this technique directly aligns with the execution of these commands post-exploitation. It's a plausible step after the initial exploitation and before setting up persistence, as it involves using a scripting interpreter (like the one embedded in HTA files) to execute malicious commands.
   - **C: T1564-Hide Artifacts**: This technique is about hiding artifacts to evade detection. While relevant to the broader context of defense evasion, it doesn't directly fit the sequence of executing commands and then setting up persistence.
   - **D: T1048.001-Exfiltration Over Symmetric Encrypted Non-C2 Protocol**: This technique involves exfiltrating data, which might not be the immediate next step after exploitation and before setting up persistence.

5. **Conclusion**: Based on the analysis, the most likely technique to occur after the exploitation via the HTA file and before ensuring persistence with ComboJack malware is **B: T1059-Command and Scripting Interpreter**. This is because the execution of encoded commands within the HTA file directly aligns with using a command and scripting interpreter, setting the stage for further malicious activities, including persistence.

Final Answer: B