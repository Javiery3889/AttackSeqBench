Analysis of the Question:
The question describes an attacker using discovery techniques to query registry values and manipulate thread contexts, which suggests the attacker is trying to establish a means of communication. The question specifically asks about establishing communication using HTTP and HTTPS protocols.

Analysis of Related TTPs:
The related TTPs are related to Command and Control (C2) tactics and the technique T1071.001-Web Protocols. T1071.001-Web Protocols is a technique that involves using web protocols (HTTP and HTTPS) to establish a C2 channel.

Comparison and Evaluation:
- Answer Choice A: T1090.002-External Proxy is related to using an external proxy to communicate, but it's not directly related to using HTTP and HTTPS protocols.
- Answer Choice B: T1498-Network Denial of Service is a technique that involves disrupting network communication, which is the opposite of establishing communication.
- Answer Choice C: T1071-Application Layer Protocol is the correct answer because it involves using application-layer protocols, which includes HTTP and HTTPS, to establish a C2 channel.
- Answer Choice D: T1106-Native API is related to using native APIs to interact with the system, but it's not directly related to establishing communication using HTTP and HTTPS protocols.

Step-by-Step Reasoning:
1. The question mentions the use of discovery techniques to query registry values and manipulate thread contexts, which suggests the attacker is trying to establish a means of communication.
2. The related TTPs mention T1071.001-Web Protocols, which involves using web protocols (HTTP and HTTPS) to establish a C2 channel.
3. Based on the related TTPs, the correct answer is the one that involves using application-layer protocols, which includes HTTP and HTTPS.

Final Answer: C: T1071-Application Layer Protocol