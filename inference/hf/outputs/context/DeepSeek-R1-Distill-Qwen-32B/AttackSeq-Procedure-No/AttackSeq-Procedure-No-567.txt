Okay, so I need to figure out whether UNC2452 used Discovery techniques like querying the registry and identifying running processes only after establishing command and control (C2) communications using an application layer protocol. Let me break this down step by step.

First, I'll look at the CTI report provided. The report outlines the MITRE ATT&CK tactics used by UNC2452 in the SolarWinds compromise. Let's go through each tactic mentioned:

1. **Reconnaissance**: The report says they had intimate knowledge of SolarWinds' systems, implying thorough recon, but doesn't specify the exact techniques used.

2. **Resource Development**: They parked domains and possibly used private servers, which relates to infrastructure acquisition.

3. **Initial Access**: They used a supply chain compromise, specifically a malicious software update (T1195.002).

4. **Execution**: They used software deployment tools (T1072) and system services (T1569) to run their code.

5. **Defense Evasion**: They used several techniques like indicator removal, masquerading, subverting trust controls, and sandbox evasion.

6. **Discovery**: The report explicitly mentions T1057 (Process Discovery) and T1012 (Query Registry). So, they did use these techniques.

7. **Lateral Movement, Collection, Exfiltration, Impact**: These aren't detailed, but the report suggests they moved laterally and exfiltrated data.

Now, the question is about the timing of the Discovery techniques relative to C2 communications. The question asks if they used Discovery only after establishing C2 using an application layer protocol.

Looking at the report, it doesn't mention the specific order of when they used C2 versus Discovery. However, in typical attack sequences, after initial access, attackers often establish persistence and then use C2 to communicate. Once C2 is established, they can then perform Discovery to map the network and systems.

But wait, the report says they used T1057 and T1012 for Discovery. These are usually done after gaining initial access to understand the environment. So, they might have used these techniques before establishing a more formal C2 channel, or perhaps during the initial stages.

However, the question specifies "after using the Application Layer Protocol for Command and Control." The report doesn't mention the use of application layer protocols for C2. It does mention T1569 (System Services) for execution, which could involve using legitimate services for C2, but that's not the same as an application layer protocol.

So, without explicit information that they used an application layer protocol for C2, it's hard to say they used Discovery after that. Moreover, the report doesn't specify the order between C2 establishment and Discovery. It's possible that they used Discovery before establishing a dedicated C2 channel, especially since they needed to gather information to move laterally.

Therefore, the answer is likely "No," because the report doesn't indicate that they used Discovery only after establishing C2 via an application layer protocol. It's possible they did Discovery earlier in the process.
</think>

The CTI report indicates that UNC2452 used Discovery techniques such as querying the registry and identifying running processes (T1057 and T1012) but does not specify that these were employed after establishing Command and Control (C2) communications using an application layer protocol. Typically, Discovery occurs after initial access to understand the environment, which might precede the establishment of a dedicated C2 channel. Additionally, the report does not mention the use of an application layer protocol for C2, making it unlikely that Discovery was conducted solely after such a step. 

Final Answer: B: No