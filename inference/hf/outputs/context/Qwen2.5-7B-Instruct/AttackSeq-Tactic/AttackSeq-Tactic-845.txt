Let's break down the analysis step-by-step:

1. **Analyze the CTI Outline:**
   - **Initial Access:** Longhorn uses backdoor Trojans and zero-day vulnerabilities to compromise targets.
   - **Defense Evasion:** Longhorn employs various techniques to avoid detection.
   - **Discovery:** Longhorn's malware is built for espionage with detailed system fingerprinting, discovery, and exfiltration capabilities.
   - **Command and Control:** Longhorn configures specific domain and IP addresses for C&C servers and uses HTTPS with a custom cryptographic protocol for communication.

2. **Analyze the Question:**
   - The question asks for the ATT&CK tactic that occurred after detailed system fingerprinting and discovery but before communicating with C&C servers using a custom cryptographic protocol over HTTPS.

3. **Compare and Evaluate:**
   - **Discovery (C):** This tactic involves the gathering of information about the network and systems to identify potential targets and understand the environment. The CTI outline mentions that Longhorn's malware is built for espionage with detailed system fingerprinting and discovery capabilities.
   - **Collection (B):** This tactic involves gathering the data that has been identified as valuable through the discovery phase. It is likely that after detailed system fingerprinting and discovery, the next step would be to collect the data of interest.
   - **Defense Evasion (A):** This tactic involves techniques to avoid detection by defenders. While Longhorn does use defense evasion techniques, it is not the immediate next step after discovery.
   - **Privilege Escalation (D):** This tactic involves gaining higher-level access to the system. It is not directly related to the sequence of actions after discovery and before communication with C&C servers.

4. **Step-by-Step Reasoning:**
   - The CTI outline clearly states that Longhorn's malware is built for espionage with detailed system fingerprinting and discovery capabilities.
   - After the discovery phase, the next logical step would be to collect the data of interest.
   - The communication with C&C servers using a custom cryptographic protocol over HTTPS is a later step in the attack sequence.

**Final Answer: B: Collection**