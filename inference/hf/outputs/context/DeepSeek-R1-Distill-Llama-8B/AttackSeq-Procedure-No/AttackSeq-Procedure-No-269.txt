Okay, so I need to figure out whether the Korplug variant communicates with its C&C servers using a custom TCP-based protocol, and whether the initial handshake is over HTTPS or TCP, specifically before it starts collecting data from the local system, removable media, and network shared drives.

First, I'll go back to the CTI outline provided. The outline mentions that the Korplug variant uses a custom protocol for exfiltration. It says that data exfiltration is done via a custom protocol involving TCP messages with a header and an encrypted body. So, the communication between Korplug and its C&C is definitely using a custom TCP-based protocol.

Now, the question is about the initial handshake. The outline doesn't explicitly state whether the initial communication is over HTTPS or just TCP. However, the outline does mention that the Korplug file is encrypted and decrypted at runtime, and the configuration data is encrypted with XOR. This suggests that the communication might be encrypted, which HTTPS is, but it's a custom protocol, so it's not standard HTTPS.

Wait, but the initial part of the question is about the handshake. The outline says the protocol uses TCP messages with a header and an encrypted body. So the initial communication is over TCP, and the body is encrypted. That means the handshake is over TCP, not HTTPS. HTTPS is a higher layer on top of TCP, but the question is specifically about the protocol used, which is TCP-based.

So, the initial handshake is over TCP, not HTTPS. Therefore, the answer should be No, it doesn't use HTTPS for the initial handshake.
</think>

The Korplug variant communicates with its C&C servers using a custom TCP-based protocol. The initial handshake occurs over TCP, not HTTPS, as the communication involves TCP messages with an encrypted body.

Final Answer: B: No