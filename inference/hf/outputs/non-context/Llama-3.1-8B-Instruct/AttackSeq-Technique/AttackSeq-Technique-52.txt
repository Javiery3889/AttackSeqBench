Analysis of the Question:
- The question describes a sequence of TTPs involving a PowerShell script communicating with hardcoded C2 servers to download resources and payloads.
- The sequence ends with the GandCrab ransomware encrypting files on the compromised system.

Comparison and Evaluation:
- T1078.002-Domain Accounts: This technique involves the use of compromised domain accounts to gain elevated privileges. It does not directly relate to the sequence of events described in the question.
- T1486-Data Encrypted for Impact: This technique involves encrypting data to cause impact or disruption. Given that the GandCrab ransomware encrypts files, this technique is likely to occur after the ransomware has been deployed.
- T1496.004-Cloud Service Hijacking: This technique involves hijacking cloud services to gain unauthorized access or control. It does not directly relate to the sequence of events described in the question.
- T1566-Phishing: This technique involves using phishing to trick users into performing certain actions. It does not directly relate to the sequence of events described in the question.

However, the question asks for the technique that occurred before the GandCrab ransomware encrypted files. Given the context, the most plausible sequence would involve the PowerShell script downloading the ransomware payload before the encryption occurs.

Step-by-Step Reasoning:
1. The PowerShell script communicates with hardcoded C2 servers to download resources and payloads.
2. The downloaded payload is likely the GandCrab ransomware.
3. The ransomware encrypts files on the compromised system.

Considering the sequence, the technique that occurred before the GandCrab ransomware encrypted files is the download of the ransomware payload.

Final Answer: T1566-Phishing