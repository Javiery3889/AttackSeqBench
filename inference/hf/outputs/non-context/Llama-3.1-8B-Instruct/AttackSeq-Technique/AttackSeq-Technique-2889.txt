Analysis of the Question:
- The question mentions the use of discovery techniques to query registry values and manipulate thread contexts.
- It also mentions establishing communication using HTTP and HTTPS protocols.

Comparison and Evaluation:
- T1090.002-External Proxy: This technique involves using an external proxy to mask the attacker's IP address, but it doesn't directly relate to querying registry values or manipulating thread contexts.
- T1498-Network Denial of Service: This technique involves disrupting or denying network services, which is unrelated to the given context of establishing communication using HTTP and HTTPS protocols.
- T1071-Application Layer Protocol: This technique involves using legitimate applications or protocols to move laterally or establish communication, which aligns with the given context of using HTTP and HTTPS protocols.
- T1106-Native API: This technique involves using native APIs to interact with the system, which doesn't directly relate to establishing communication using HTTP and HTTPS protocols.

Step-by-Step Reasoning:
1. The question mentions the use of discovery techniques, which suggests the attacker is gathering information about the system.
2. The use of registry values and thread contexts implies the attacker is interacting with the system at a low level.
3. Establishing communication using HTTP and HTTPS protocols suggests the attacker is using a network protocol to communicate.
4. T1071-Application Layer Protocol is the most fitting choice as it involves using legitimate applications or protocols to move laterally or establish communication, which aligns with the given context.

Final Answer: C: T1071-Application Layer Protocol