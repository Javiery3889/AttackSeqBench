### Step 1: Analyze the Question
The question describes a sequence of actions taken by the malware Korplug:
1. Korplug collects metadata and content from all mapped drives.
2. It then establishes encrypted communication with C&C servers using a custom TCP-based protocol.

### Step 2: Compare and Evaluate
Let's evaluate each answer choice to determine which one aligns best with the described attack sequence:

- **A: T1608-Stage Capabilities**
  - This technique involves preparing for future actions by staging capabilities, such as downloading additional tools or payloads. While this could be a part of the attack, it does not directly describe the establishment of encrypted communication with C&C servers.

- **B: T1571-Non-Standard Port**
  - This technique involves using non-standard ports for communication. While it is possible that Korplug uses a non-standard port, the question specifically mentions the use of a custom TCP-based protocol, which is more about the method of communication rather than the port used.

- **C: T1574-Hijack Execution Flow**
  - This technique involves altering the execution flow of legitimate programs to execute malicious code. This does not align with the described action of establishing encrypted communication with C&C servers.

- **D: T1090.002-External Proxy**
  - This technique involves using an external proxy to route traffic. However, the question mentions a custom TCP-based protocol, which is more about the method of communication rather than using an external proxy.

### Step 3: Provide a Step-by-Step Reasoning and Final Answer
- The most relevant technique for establishing encrypted communication with C&C servers using a custom TCP-based protocol is **T1571-Non-Standard Port**. While the question does not explicitly state the use of a non-standard port, the use of a custom TCP-based protocol often implies the use of non-standard ports to avoid detection by standard network monitoring tools.

However, if we strictly follow the MITRE ATT&CK framework, the most precise technique that aligns with the establishment of encrypted communication is **T1095-Non-Application Layer Protocols**. This technique involves using protocols that are not typically used for communication to avoid detection. Since the question mentions a custom TCP-based protocol, this is the most accurate match.

Given the options provided, the closest match is **B: T1571-Non-Standard Port**.

### Final Answer: B: T1571-Non-Standard Port