### Step 1: Analyze the Question
- **Question Context**: The question describes a sequence of actions where an attacker uses PowerShell commands with multilayered base64 encoded code to install Poison Ivy, a type of malware. After installation, the malware establishes communication with a C2 (Command and Control) server at 'web.outlooksysm.net'.
- **Key TTPs**: 
  - Execution of PowerShell commands with multilayered base64 encoded code.
  - Installation of Poison Ivy.
  - Communication with a C2 server.

### Step 2: Compare and Evaluate
- **Answer Choice A: T1592.002-Software**
  - This technique involves collecting information about software installed on the system. It is not directly related to the execution of PowerShell commands or the installation of malware.
- **Answer Choice B: T1055.008-Ptrace System Calls**
  - This technique involves using ptrace system calls to manipulate processes. It is not typically used in the context of executing PowerShell commands or installing malware.
- **Answer Choice C: T1564-Hide Artifacts**
  - This technique involves hiding artifacts to avoid detection. While it could be used after the installation of malware, it is not a necessary step before establishing communication with a C2 server.
- **Answer Choice D: T1566-Phishing**
  - This technique involves using phishing to gain initial access to a system. Phishing is a common method for delivering malware, including Poison Ivy, and is often the initial step before executing PowerShell commands and installing the malware.

### Step 3: Provide a Step-by-Step Reasoning and Final Answer
1. **Initial Access**: The attacker likely gains initial access to the system through phishing (T1566). This could involve sending a malicious email with a link or attachment that, when opened, triggers the execution of PowerShell commands.
2. **Execution of PowerShell Commands**: Once the attacker has initial access, they use PowerShell commands with multilayered base64 encoded code to install Poison Ivy.
3. **Installation of Poison Ivy**: The PowerShell commands execute the installation of the Poison Ivy malware.
4. **Communication with C2 Server**: After installation, the malware establishes communication with the C2 server at 'web.outlooksysm.net'.

Given this sequence, the most plausible technique that occurred before the malware established communication with the C2 server is **T1566-Phishing**.

**Final Answer: D: T1566-Phishing**