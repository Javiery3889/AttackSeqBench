### Step-by-Step Analysis

1. **Analyze the Question:**
   - The question describes a sequence of events in a cyber attack:
     - A malspam campaign leveraged an HTA file containing encoded commands to exploit CVE-2017-8579.
     - After the exploitation, ComboJack malware ensured persistence by setting a registry key.
   - We need to determine which ATT&CK technique most likely occurred between these two events.

2. **Identify the Sequence of TTPs:**
   - **Initial Event:** Malspam campaign with an HTA file exploiting CVE-2017-8579.
   - **Final Event:** ComboJack malware setting a registry key for persistence.

3. **Evaluate Each Answer Choice:**
   - **A: T1129-Shared Modules**
     - This technique involves loading shared libraries or modules to execute malicious code. While it could be part of the attack, it is not the most likely step between exploitation and persistence.
   - **B: T1059-Command and Scripting Interpreter**
     - This technique involves using command-line interfaces and scripts to execute commands. Given that the HTA file contains encoded commands, it is highly likely that these commands are executed to set up the environment for the malware.
   - **C: T1564-Hide Artifacts**
     - This technique involves hiding files, processes, or other artifacts to avoid detection. While it could be used, it is not the most immediate step after exploitation and before persistence.
   - **D: T1048.001-Exfiltration Over Symmetric Encrypted Non-C2 Protocol**
     - This technique involves exfiltrating data using symmetric encryption. This is typically a later stage in the attack, not immediately after exploitation and before persistence.

4. **Step-by-Step Reasoning:**
   - The HTA file contains encoded commands, which are likely executed to set up the environment for the malware.
   - The most logical step between the exploitation and the persistence mechanism (setting a registry key) is the execution of these commands.
   - Therefore, the technique that best fits this sequence is **T1059-Command and Scripting Interpreter**.

### Final Answer
Final Answer: B: T1059-Command and Scripting Interpreter