### Step-by-Step Reasoning:

1. **Analyze the Question:**
   - The question describes a sequence of actions taken by APT10 after gaining access to Visma's network.
   - The sequence includes gaining access, moving laterally using Citrix servers, and then compressing proprietary data using WinRAR for extraction.

2. **Identify the Sequence of TTPs:**
   - **Initial Access:** APT10 gained access to Visma's network.
   - **Lateral Movement:** APT10 moved laterally using Citrix servers.
   - **Data Compression:** APT10 used WinRAR to compress proprietary data for extraction.

3. **Compare and Evaluate:**
   - **A: Lateral Movement:** This is already mentioned in the sequence as a step APT10 took after gaining access. It is not the step that occurred before compressing data.
   - **B: Reconnaissance:** This is typically an early stage in the attack lifecycle, often occurring before initial access. It is not likely to be the step immediately before compressing data.
   - **C: Command and Control:** This is necessary for maintaining control over the compromised network and can occur throughout the attack. However, it is not the step that directly precedes data compression.
   - **D: Collection:** This is the process of gathering data from the compromised network, which would logically occur before compressing the data for extraction.

4. **Final Reasoning:**
   - The most logical step before compressing data for extraction is the collection of that data. APT10 would need to gather the proprietary data before compressing it.

### Final Answer: D: Collection