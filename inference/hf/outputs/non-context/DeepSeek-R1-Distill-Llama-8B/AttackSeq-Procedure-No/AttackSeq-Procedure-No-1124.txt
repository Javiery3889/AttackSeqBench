Okay, so I'm trying to figure out whether a Flash exploit that's used in a spear-phishing attack would cause the system to downgrade NTLM and capture hashes before the payload is installed. Let me break this down step by step.

First, I know that the attack mentioned is a spear-phishing using a malicious Adobe Flash exploit, specifically CVE-2015-5119. I remember that CVE-2015-5119 is a vulnerability in Adobe Flash Player that allows an attacker to exploit a use-after-free vulnerability. This can lead to arbitrary code execution, which is a big deal because it allows attackers to execute malicious code on the victim's machine.

So, the initial access is through a spear-phishing email that tricks the user into opening a malicious Flash file, which is 'show.swf' in this case. Spear-phishing is all about tricking someone into interacting with a malicious file, so that makes sense.

Now, the question is whether this Flash exploit would cause the system to downgrade NTLM and capture NTLM hashes before the shellcode installs the payload embedded in a GIF image. Hmm, I'm a bit fuzzy on how NTLM works here. NTLM is a protocol used for authentication, and capturing NTLM hashes can be a way for attackers to later crack passwords because the hash can be brute-forced more easily.

I think that some exploits might try to capture NTLM hashes during the initial attack to enable pass-the-hash attacks, which allow the attacker to impersonate a user. But does the Adobe Flash exploit specifically do that?

I recall that some exploits, especially those that gain initial access, might attempt to harvest credentials or NTLM hashes. The CVE-2015-5119 exploit, as I remember, is more about exploiting the Flash Player to execute malicious code. Once the exploit is executed, the attacker might have a payload that does various things, including credential dumping or NTLM hash capture.

Wait, but the question mentions that the payload is embedded in a GIF image. That's interesting because GIFs can sometimes be used as a vector for attacks, but I'm not sure if that's relevant here. Maybe the payload is delivered in two stages: first, the Flash exploit, and then another payload via a GIF.

So, the sequence would be: the user opens the Flash file, which triggers the exploit, leading to code execution. During this process, the attacker might be able to capture NTLM hashes because the system might be in a state where it's using NTLM for authentication. Once the hashes are captured, the attacker can use pass-the-hash techniques to move laterally within the network, which could involve installing more malicious payloads, perhaps embedded in a GIF.

Alternatively, maybe the Flash exploit itself doesn't directly capture NTLM hashes but the payload does. But I think some advanced exploit kits do both: they first gain access and then harvest credentials. So, it's plausible that after the initial exploit, the system's credentials or NTLM hashes are captured, which would allow the attacker to install further payloads, maybe via a GIF as a second-stage delivery method.

I'm trying to think if there's any reason why the Flash exploit wouldn't do this. I don't recall any specific details about CVE-2015-5119 capturing NTLM hashes, but I know that many modern exploits do this as part of their post-exploitation phase. So, it's likely that after the initial exploit, the attacker would look to capture any available credentials, including NTLM hashes, to facilitate further attacks.

Therefore, the sequence would be: exploit the Flash vulnerability to gain initial access, then capture NTLM hashes, and then install the payload from the GIF. So, the answer should be yes, it's likely that the Flash exploit would cause the system to downgrade NTLM and capture the hashes before installing the payload.
</think>

The attack begins with a spear-phishing email distributing a malicious Flash file, 'show.swf', exploiting CVE-2015-5119 to execute malicious code. This exploit likely leads to the capture of NTLM hashes during the initial access phase, enabling pass-the-hash attacks. Subsequently, the payload embedded in a GIF is installed, leveraging the captured credentials for further actions. Thus, the sequence includes capturing NTLM hashes before the payload is delivered.

Final Answer: A: Yes