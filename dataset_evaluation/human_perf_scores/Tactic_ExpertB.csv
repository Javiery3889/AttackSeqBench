Question ID,AttackSeq ID,Question,A,B,C,D,CTI Outline,Answer
594,205,"After gaining initial access through zero-day exploits like CVE-2015-3043 and CVE-2015-1701 delivered via spear phishing emails, which ATT&CK tactic most likely occurred before Sofacy used old malware variants alongside new exploits to avoid detection?",Impact,Initial Access,Lateral Movement,Defense Evasion,"Initial Access: The CTI report from PwC indicates that the threat actor known as Sofacy has been deploying malware through malicious websites linked in spear phishing emails. These emails also attempt to phish for web-mail credentials. The report also mentions the use of zero-day exploits, specifically CVE-2015-3043 and CVE-2015-1701, for delivering the malware.
Command and Control: The report lists a number of domains that are likely related to Sofacy's activities, which are typically used for phishing and/or malware command and control. These domains are suggested for review in network logs to detect potential malicious activity.
Others: The CTI report from PwC, dated 2015-04-20 and authored by threatintelligence@uk.pwc.com, provides tactical intelligence on the activities of the threat actor Sofacy. The report includes references to recent reports by Trend Micro and FireEye, which relate to similar activities by Sofacy. PwC also offers to provide a TLP-GREEN version of the report with additional indicators for further distribution according to US-CERT's definition for TLP. The report includes an appendix with a redacted list of domains associated with Sofacy, which are used for phishing and malware command and control. The report emphasizes the importance of reviewing network logs for these domains to aid in detecting Sofacy's activities.",C
549,198,"After UNC1151 gained initial access through spear phishing campaigns using malicious attachments sent to entities in Poland, Lithuania, Latvia, and other countries, which ATT&CK tactic most likely occurred during their efforts to steal victim credentials via spoofed websites?",Exfiltration,Credential Access,Discovery,Initial Access,"Reconnaissance: Mandiant Threat Intelligence has identified that UNC1151, a group assessed with high confidence to be linked to the Belarusian government, has been actively involved in reconnaissance activities. Since at least 2016, UNC1151 has registered credential theft domains that spoof legitimate websites to steal victim credentials. The group has targeted a wide range of entities, focusing on Ukraine, Lithuania, Latvia, Poland, and Germany, as well as Belarusian dissidents, media entities, and journalists. The specific scope of targeting aligns with Belarusian interests, as the group has sought confidential information without any observed monetization efforts. UNC1151's reconnaissance has included regional webmail providers, national and local governments, and private businesses, with malware-based intrusions also focusing on Eastern Europe. Notably, UNC1151 has not targeted Russian or Belarusian state entities.
Initial Access: UNC1151 has demonstrated initial access capabilities through spear phishing campaigns. The group has not only targeted entities in countries neighboring Belarus but also those with no obvious connection to Belarusian interests, indicating a possible support for additional priorities. These operations mainly occurred between 2016 and 2019. UNC1151's phishing efforts have included sending malicious attachments to recipients in Poland, Lithuania, Latvia, Ukraine, and even governments such as Colombia, Ireland, and Switzerland. Additionally, credential theft emails have been sent to the Colombian Ministry of Foreign Affairs.
Others: Mandiant Threat Intelligence has high confidence that UNC1151 is linked to the Belarusian government and provides technical support to the Ghostwriter information operations campaign. The geopolitical indicators and observed narratives consistent with Belarusian government interests suggest moderate confidence that Belarus is at least partially responsible for Ghostwriter. While Russian contributions to UNC1151 or Ghostwriter cannot be ruled out, no direct evidence has been uncovered. UNC1151's operations have shown a consistent evolution of tactics, techniques, and procedures (TTPs) since 2017, indicating the maturation of a single organization. Ghostwriter operations have shifted focus since mid-2020 to align more distinctly with Belarusian interests, particularly following the disputed 2020 Belarusian elections. The narratives promoted by Ghostwriter have been featured on Belarusian state television and are relevant to the internal political conversation in Belarus. The sources of content for Ghostwriter operations and the malware used by UNC1151 remain uncertain, suggesting the possibility of involvement from additional organizations or countries. Mandiant assesses with high confidence that Ghostwriter information operations are conducted in support of the Belarusian government and with moderate confidence that they are conducted with Belarusian sponsorship. The lack of direct evidence prevents confirmation of Russian government involvement in UNC1151 and Ghostwriter operations, despite some TTP overlaps and consistency with Russian goals.",B
1231,314,"Which ATT&CK tactic most likely occurred before the Bvp47 backdoor was activated to maintain processes in Linux user and kernel modes, performed environmental tests, and decrypted payload blocks?",Execution,Command and Control,Privilege Escalation,Persistence,"Initial Access: In 2015, an advanced threat detection system alerted to suspicious communication activities between important servers. Two servers, V1 and V2, were compromised with backdoors, and a third server, host A, was identified as the source of external attacks. The V1 server received a SYN packet with a payload from host A, then initiated a connection to host A and exchanged a large amount of encrypted data. V1 also connected to V2's SMB service, performed sensitive operations, and downloaded suspicious files from a Python-implemented HTTP server on V1. These files included a Base64-encoded PowerShell script and encrypted data.
Persistence: Bvp47 uses a loader to decrypt and load its payload, which is compressed and assembled at the end of the file. The payload includes various slices that provide backdoor functionality. The backdoor is designed to remain persistent on the system by hiding its processes, files, and network connections.
Privilege Escalation: Bvp47 hooks the devmem_is_allowed function, allowing user mode processes to read and write kernel space. It also hooks the avc_has_perm function to bypass SeLinux restrictions.
Defense Evasion: Bvp47 employs various techniques to evade detection, including hooking nearly 70 system functions, modifying the first four bytes of kernel module elf files, and using BPF as a covert channel to filter packets. It also uses XOR encryption for strings and blocks, obfuscates function names, and employs the Bvp engine for dynamic calculations of Linux kernel data and function addresses.
Discovery: Bvp47 conducts runtime environment tests to prevent security researchers from performing dynamic analysis. It verifies the operating environment by checking the checksum against the number of blocks and files.
Lateral Movement: The V1 server connected to V2's SMB service to perform sensitive operations, indicating lateral movement within the compromised network.
Command and Control: Bvp47 establishes a covert communication channel using BPF to filter packets and employs RSA and RC-X algorithms for secure communication. It receives commands via SYN packets that meet specific BPF rules and then decrypts and executes them.
Others: The Bvp47 backdoor is attributed to the Equation Group, linked to the US NSA. It was discovered during an investigation of a key domestic department in 2013 and later connected to 'The Shadow Brokers Leaks' incident. The backdoor has been active for over 10 years, targeting 287 victims in 45 countries. It uses advanced covert channel behavior based on TCP SYN packets, code obfuscation, system hiding, and self-destruction design. The Bvp47 incidents are part of 'Operation Telescreen,' and the backdoor is considered a top-tier APT tool with capabilities spanning the *nix platform and possibly involving Cisco, Solaris, AIX, SUN, and Windows platforms.",A
907,258,"Before the malicious Macro executed by the downloaded Office document used a disk serial number check to avoid virtual machine detection, which ATT&CK tactic most likely occurred?",Execution,Initial Access,Impact,Exfiltration,"Execution: The malicious Office document's Macro executes only if a disk serial number is detected, which is a technique to avoid virtual machine detection. The Macro then downloads an image from Google Drive, which contains a base64-encoded binary appended at the end, separated by the string '****'. The binary is an AutoIT script that downloads a new file from Google Drive.
Persistence: The final payload, JhoneRAT, written in Python, creates persistence by adding an entry named 'ChromeUpdater' to the 'Software\Microsoft\Windows\CurrentVersion\Run' registry key.
Defense Evasion: JhoneRAT includes techniques to avoid execution on virtual machines by checking for disk serial numbers. Additionally, the Python bytecode header is removed to hinder analysis by tools such as uncompyle6.
Discovery: JhoneRAT checks the system's keyboard layout to target specific Arabic-speaking countries, including Saudi Arabia, Iraq, Egypt, Libya, Algeria, Morocco, Tunisia, Oman, Yemen, Syria, UAE, Kuwait, Bahrain, and Lebanon.
Command and Control: JhoneRAT uses cloud services for command and control activities. It checks for new commands in tweets from the handle @jhone87438316 every 10 seconds using BeautifulSoup. Commands can be issued to specific victims based on a UID generated on each target or to all victims.
Exfiltration: JhoneRAT exfiltrates screenshots via ImgBB and sends command execution feedback to Google Forms. It can also download files encoded in base64 from Google Drive.
Others: The JhoneRAT campaign is focused on specific Middle Eastern and Arabic-speaking countries and leverages cloud providers for operations. The campaign started in November 2019 and is ongoing. The attackers have implemented anti-VM and anti-analysis tricks. The campaign demonstrates the importance of network-based detection complemented by system behavior analysis. The threat actors' infrastructure includes URLs hosted on Google Drive and a Twitter account. Cisco Talos Intelligence Group provides various ways to detect and block this threat, including Advanced Malware Protection (AMP), Cisco Cloud Web Security (CWS), Email Security, Network Security appliances, AMP Threat Grid, Umbrella, and the Open Source Snort Subscriber Rule Set.",B
876,252,Which ATT&CK tactic most likely occurred after PyFlash backdoor executed OS-related commands for gathering information about the machine but before the data surveillance outputs were sent using the C&C protocol?,Command and Control,Exfiltration,Execution,Defense Evasion,"Initial Access: ESET researchers discovered a watering hole operation targeting Armenian websites, using a fake Adobe Flash update lure to deliver malware dubbed NetFlash and PyFlash. The operation is attributed to Turla, an espionage group targeting governmental and military organizations. Compromised websites include armconsul[.]ru, mnp.nkr[.]am, aiisa[.]am, and adgf[.]am, with some belonging to the Armenian government. The campaign involved inserting malicious JavaScript into these websites, such as appending obfuscated code to jquery-migrate.min.js on mnp.nkr[.]am. The malicious code would load external JavaScript from skategirlchina[.]com/wp-includes/data_from_db_top.php, which fingerprints the visitor's browser and potentially delivers a second-stage malicious JavaScript. The campaign ceased delivering malicious scripts by the end of November 2019.
Execution: The watering hole operation by Turla involved a social engineering trick with a fake Adobe Flash update warning to induce users to download and install malware. The fake installer, once executed, would install both a Turla malware variant and a legitimate Adobe Flash program, leading users to believe the update was legitimate.
Persistence: The NetFlash and PyFlash malware variants used by Turla establish persistence using Windows scheduled tasks. NetFlash downloads its second stage malware from a hardcoded URL and sets up a scheduled task for the new backdoor, while PyFlash persists by modifying the Windows task that regularly launches the malware.
Discovery: The PyFlash backdoor executes various OS-related commands such as systeminfo, tasklist, ipconfig, getmac, and arp to gather information about the machine and sends it to the C&C server.
Command and Control: PyFlash communicates with its hardcoded C&C server via HTTP, using AES-128 in CBC mode to encrypt all network communications. NetFlash uses port 80 for communication, while PyFlash uses port 8,000, and another NetFlash sample uses port 15,363.
Others: The Turla group has been active for over ten years, with previous campaigns including Mosquito and LightNeuron. The recent operation shares similarities with past Turla campaigns, particularly one uncovered in 2017. The JavaScript used in the current campaign is almost identical to that of the 2017 campaign, but with different targets and payloads. The operation relies on a well-known social engineering trick and has shifted payloads, likely to evade detection. The new payload, NetFlash, installs a backdoor called PyFlash, developed in Python. ESET will continue monitoring Turla activities and publish relevant information on their blog. Indicators of Compromise (IoCs) include compromised websites and C&C servers such as skategirlchina[.]com and various IP addresses. Samples of the malware with SHA-1 hashes and timestamps are also provided.",A
1320,327,"Which ATT&CK tactic most likely occurred before Earth Wendigo executed malicious scripts, such as cookie stealers and webmail session key manipulators, leading to the injection of persistent JavaScript through XSS vulnerabilities?",Collection,Execution,Initial Access,Command and Control,"Execution: The malicious scripts executed by Earth Wendigo included cookie stealers and scripts that manipulated webmail session keys and browser cookies. Additionally, they exploited a webmail system's XSS vulnerability to inject malicious JavaScript permanently and registered a malicious JavaScript code to the Service Worker feature in web browsers.
Persistence: To maintain their foothold, Earth Wendigo used two methods: exploiting an XSS vulnerability in the webmail system's shortcut feature to inject malicious code, and registering a malicious JavaScript to the Service Worker script in the browser.
Defense Evasion: Earth Wendigo evaded detection by hiding malicious code inside CSS elements and leveraging the webmail system's search suggestion function to execute their script indirectly. They also manipulated email signatures and used Service Worker scripts to intercept and manipulate HTTPS requests.
Credential Access: The Service Worker script used by Earth Wendigo intercepted HTTPS POST requests to the webmail login API to steal username and password pairs, which were then sent to a remote server.
Command and Control: Earth Wendigo established a WebSocket connection between the victims' browsers and their WebSocket server to control the JavaScript backdoor and instruct it to read and exfiltrate emails from the webmail server.
Exfiltration: The JavaScript backdoor created by Earth Wendigo facilitated the exfiltration of mailbox content and attachments via a WebSocket connection to their server. The backdoor executed commands to collect and send email data back to the WebSocket server.
Others: Additional findings include the discovery of multiple malware variants used by Earth Wendigo, written in Python and compiled as Windows executables. These variants communicated with the same malicious domain used in the webmail server attacks and included shellcode loaders and backdoors. However, the specific code delivered by the command and control server could not be verified as the server was down during investigation.",C
1141,301,"After ChChes gains initial access via malicious emails with disguised executable files, which ATT&CK tactic most likely occurs before the malware communicates with its C&C servers using encrypted HTTP requests?",Lateral Movement,Defense Evasion,Initial Access,Collection,"Initial Access: Since around October 2016, JPCERT/CC has been observing targeted emails sent to Japanese organizations. These emails contain a ZIP file attachment with executable files, which are disguised as Word documents using icons. The emails impersonate existing individuals and originate from free email services in Japan. Upon execution, the malware known as ChChes infects the system.
Command and Control: ChChes communicates with C&C servers to receive commands and modules, which are then loaded into memory. The malware has limited functions on its own and relies on modules from C&C servers to expand its capabilities. The communication is initially encrypted using a custom method and later with AES encryption. The malware's communication flow includes an initial request containing encrypted data with the computer name, followed by a response from the C&C server with an ID for the infected machine. Subsequent requests are made for modules and commands, which are also encrypted. The malware can execute shell commands, upload and download files, run DLLs, and view tasks of bot commands.
Others: ChChes has been active since around October 2016 and is considered a new type of malware. JPCERT/CC is monitoring ChChes for continued use in targeted attacks. The report includes hash values of the malware samples in Appendix C and a list of destination hosts confirmed by JPCERT/CC in Appendix D. It is recommended to check for communication with these hosts to identify potential infections.",A
1898,54,"Which ATT&CK tactic most likely occurred after attackers modified the Polish Financial Supervision Authority's website to host malicious JavaScript files, leading to malware downloads on visitor devices?",Lateral Movement,Initial Access,Collection,Execution,"Execution: The malware, identified by the MD5 hash 85d316590edfb4212049c4490db08c4b and named gpsvc.exe, is a Win32 executable first seen on 2017-01-26. It is packed with 'Enigma Protector' and drops a known Lazarus group malware variant. The executable accepts command line arguments to list service names, open or set events, and drop/install DLLs under specified service names using an RC4 password derived from the provided password's MD5 hash.
Defense Evasion: The malware uses a commercial packer known as 'Enigma Protector' for defense evasion. Additionally, the malware executes a series of basic system information gathering commands and returns the results via the C&C, eye-watch[.]in, which may also serve as a defense evasion technique by mimicking normal system queries.
Discovery: The malware executes a series of commands to gather system information, including hostname, user information, system version, network configuration, active TCP connections, and more. The results are sent back to the C&C, eye-watch[.]in.
Command and Control: The C&C servers for the malware are identified by the IP addresses 125.214.195.17 and 196.29.166.218. The malware communicates with the C&C using a beacon with the User-Agent resembling a Firefox browser on Windows.
Others: Additional watering-hole attacks were observed on the Comisi\u00f3n Nacional Bancaria y de Valores (Mexico) and a state-owned bank in Uruguay. The eye-watch[.]in domain was used in these attacks and has been associated with other malicious activities, including the delivery of malware variants and a Silverlight exploit based on CVE-2016-0034. A list of 255 IP address strings was found in the exploit kit website code, likely used to filter traffic and deliver exploits only to specific subnets, primarily targeting financial institutions in Poland and Mexico.",D
1982,68,Which ATT&CK tactic most likely occurred after the Aurora malware evaded detection by modifying file timestamps and loading its DLL into a svchost.exe process?,Defense Evasion,Persistence,Command and Control,Initial Access,"Initial Access: The Aurora operation utilized a JavaScript-based exploit vector targeting Internet Explorer 6, as detailed in Microsoft Security Bulletin MS10-002. The exploit involved a heap spray attack and shellcode injection, which then downloaded a secondary payload from a server. The dropper, once executed, would delete itself.
Execution: The malware's execution process involved a two-stage installation. Initially, the dropper installed the payload as a service, which then deleted the first service and registered a second service pointing to the same backdoor DLL. The payload accessed an encrypted embedded resource to obtain the C&C server DNS name.
Persistence: The Aurora malware achieved persistence by installing itself as a service under random names and modifying registry keys. The dropper decompressed an embedded DLL into the Windows system32 directory and loaded it as a service, with registry keys created and then deleted as part of the process.
Defense Evasion: To evade detection, the dropper modified the file-time of the dropped DLL to match that of an existing system DLL and loaded the DLL into its own svchost.exe process. The dropper also deleted itself using a dissolving batch file.
Others: The report provides insights into the origins, developers, and operators of the Aurora malware operation, attributing it to Chinese origins based on forensic tool-marks and domain registration information. It also details detection methods, including JavaScript and shellcode artifacts, network detection signatures, and actionable intelligence for identifying and remediating the malware. Additionally, it discusses the global activity of the exploit and provides information on remediation and prevention strategies using various enterprise products and services.",C
1388,34,"After achieving persistence through scheduled tasks or Windows services and before using stolen credentials to perform internal reconnaissance and lateral movement across networks, which ATT&CK tactic most likely occurred?",Exfiltration,Discovery,Persistence,Privilege Escalation,"Initial Access: APT10, a China-based threat actor, has been observed using spear phishing emails with malicious attachments or links to compromise targets. These emails often contain decoy documents relevant to the recipient's interests, indicating significant target research. For example, an official document from the Japan Society for the Promotion of Science was weaponized and used in a campaign against the Japanese education sector.
Execution: APT10 deploys malware to establish a foothold on a target network, using tools like PlugX, RedLeaves, or Quasar RAT for long-term remote access. The actor performs internal reconnaissance using common Windows tools and open-source pentesting tools. APT10 ensures access to legitimate credentials, often using the MSPs credentials, and deploys credential theft tools such as mimikatz or PwDump. The actor installs updates and new malware on compromised systems, using methods like reverse shell or RDP connections to propagate across the network.
Persistence: APT10 achieves persistence on victim networks primarily through scheduled tasks or Windows services, ensuring malware remains active despite system reboots. The actor targets both high-value systems for access and low-profile systems less likely to draw attention for long-term access.
Defense Evasion: APT10 has evolved from using malware associated with China-based threat actors to developing bespoke in-house malware like ChChes and RedLeaves. The actor also uses open-source malware like Quasar and extends its capabilities. APT10 uses DLL search order hijacking and sideloading to execute modified versions of open-source tools.
Credential Access: APT10 deploys tools like mimikatz or PwDump to steal credentials, often using DLL load order hijacking to execute against a domain controller.
Discovery: APT10 conducts internal reconnaissance to map out the network using common Windows tools and later stages using open-source pentesting tools.
Lateral Movement: APT10 leverages shared MSP infrastructure to move laterally between MSPs and other victims. The actor uses systems that share access and credentials to gain access to new areas of the network.
Collection: APT10 identifies systems of interest and stages data for exfiltration in multi-part archives, often placed in the Recycle Bin, using compression tools launched via remote command execution scripts.
Command and Control: APT10 uses dynamic-DNS domains for command and control infrastructure, which are highly interconnected and link back to the actor's previous operations. The actor uses legitimate Robocopy tool and Putty Secure Copy Client (PSCP) to transfer data for command and control.
Exfiltration: APT10 'pushes' data from victim networks to other networks they have access to, such as other MSP or victim networks, then 'pulls' the data to locations from which they can directly obtain it, such as the threat actor's C2 servers.
Others: APT10, a China-based threat actor, has been active since at least 2009, evolving its targeting from the US defense industrial base and technology sectors to a global compromise of multiple industries. The actor has increased its scale and capability since early 2016, adding new custom tools and significantly increasing the number of dynamic-DNS domains used for operations. APT10's activities align with China Standard Time and its targeting corresponds with strategic Chinese interests. The actor's campaigns, including Operation Cloud Hopper, have targeted managed IT service providers (MSPs) and Japanese organizations, focusing on espionage and sensitive data collection. APT10's methodology includes spear phishing, use of bespoke and open-source malware, and leveraging MSP infrastructure for lateral movement and data exfiltration.",B
1966,66,Which ATT&CK tactic most likely occurred before Elfin attempted to exploit a known vulnerability (CVE-2018-20250) in WinRAR against a target in the chemical sector via spear-phishing delivery?,Impact,Initial Access,Reconnaissance,Collection,"Initial Access: Elfin attempted to exploit a known vulnerability (CVE-2018-20250) in WinRAR during February 2019 against a target in the chemical sector in Saudi Arabia. The exploit, delivered likely via spear-phishing, could permit code execution on unpatched computers. Symantec's proactive protection (Exp.CVE-2018-20250) prevented the targeted organization from being compromised.
Execution: Elfin has deployed a wide range of tools in its attacks, including custom malware such as Notestuk (Backdoor.Notestuk), Stonedrill (Trojan.Stonedrill), and an AutoIt backdoor, as well as commodity malware like Remcos (Backdoor.Remvio), DarkComet (Backdoor.Breut), Quasar RAT (Trojan.Quasar), Pupy RAT (Backdoor.Patpoopy), NanoCore (Trojan.Nancrat), and NetWeird (Trojan.Netweird.B).
Persistence: In a detailed case study of an attack on a U.S. organization, Elfin created a scheduled task to execute a malicious VBE file multiple times a day, ensuring persistence on the compromised system.
Defense Evasion: Elfin used PowerShell commands to bypass logging on the infected machine, as part of their defense evasion tactics. They also deployed various versions of DarkComet, POSHC2 implants, and an AutoIt backdoor, along with further credential dumping activities.
Credential Access: Elfin deployed DarkComet, which included a credential dumping tool, to extract credentials from the compromised system.
Command and Control: Elfin used POSHC2, a proxy-aware C&C framework, to communicate with the compromised systems. They also used Quasar RAT and other tools to maintain control over the infected computers.
Exfiltration: Elfin exfiltrated data using a custom .NET FTP tool and a custom AutoIt FTP exfiltration tool known as FastUploader, designed to exfiltrate data at a faster rate than traditional FTP clients.
Others: Symantec has provided file-based protection against Elfin's tools and techniques, as well as threat intelligence through the DeepSight Intelligence Managed Adversary and Threat Intelligence (MATI) service. The Attack Investigation Team within Symantec Security Response is dedicated to investigating targeted attacks and enhancing protection in Symantec products.",C
1729,391,"After multilayered base64 encoding was used to avoid detection and the operations were made fileless to improve chances of success, which ATT&CK tactic most likely occurred when malware communicated with a domain registered in China and a South Korean IP address?",Command and Control,Defense Evasion,Lateral Movement,Credential Access,"Initial Access: The FHAPPI campaign involved an APT phishing email containing a link to malware hosted on a Geocities website. The email's contents are undisclosed due to the sensitive nature of an APT attack. The malware, hosted under the account 'vbiayay1', was a VBScript encoded script. This script, when executed, would download a .doc file and open it, leading to the execution of a PowerShell attack to infect the victim's system with Poison Ivy.
Execution: The VBScript created an object in the shell and executed a PowerShell command to run base64 encoded code. This code led to the download and execution of a .ps1 file from another URL. The .ps1 file contained more base64 encoded code, which, when decoded, revealed the infection code for both 32-bit and 64-bit systems. The malware masqueraded as a 'Security Update' process and used PowerShell to execute the base64 code.
Defense Evasion: The FHAPPI campaign utilized multiple encodings and wraps to avoid detection, including multilayered base64 encoding. The attack was fileless, avoiding known signatures, and did not originate from the attacker's territory, improving the chances of a successful APT campaign.
Others: The FHAPPI campaign was first recognized in Japan and named 'Free Hosting (pivoted) APT PowerSploit Poison Ivy' (FHAPPI). The campaign utilized Geocities Japan for hosting malware and targeted victims with a modified PowerSploit PoC code. The main payload was Poison Ivy, injected into the 'userinit.exe' process. The campaign also targeted Mongolian users with documents in Mongolian. The malware actions included extracting victim information, calling back to a C2 server, and other nefarious activities. The campaign was linked to a larger APT campaign and utilized email addresses 'wisers.data@gmail.com' and 'health.pro.demo30@gmail.com' for phishing. The CNC IP address and the email sender addresses are recommended to be blocked and traced. The malware files associated with the campaign have been deleted with the help of Yahoo Incident Response Division (YIRD), JP-CERT/CC, and other security professionals in Japan.",A
1539,361,"After moving laterally across the infrastructure in search of critical information and targeting internal hosts and servers, which ATT&CK tactic most likely occurred before the attackers prepared documents pertaining to internal applications and procedures for exfiltration?",Lateral Movement,Collection,Command and Control,Privilege Escalation,"Reconnaissance: The Carbanak group conducted reconnaissance by collecting data related to banking applications and internal procedures after business hours or on weekends to avoid detection. This information was prepared for exfiltration to be used in the final stage of the attack.
Initial Access: The initial compromise involved spear-phishing emails with malicious URLs and documents designed to download a Cobalt Strike beacon component. Victims were tricked into opening these attachments, which used exploits for Remote Code Execution in Microsoft Word (CVE-2017-8570, CVE-2017-11882, and CVE-2018-0802).
Execution: After the initial compromise, the adversary had the ability to download and execute new payloads, run shell commands to move laterally in the infrastructure, and delete files from the system to leave fewer forensic traces.
Persistence: The attackers established persistence in the infrastructure using a backdoor from the Command and Control Server.
Privilege Escalation: The attackers aimed to find admin-level credentials to move across the entire infrastructure, compromising a Domain Administrator account and using it throughout the duration of the attack.
Defense Evasion: The Carbanak group minimized detection opportunities by performing operations outside business hours, limiting interaction to a handful of systems, and using single workstations as a hub for centralizing collected information and communication with their C&C server.
Credential Access: The attackers compromised credentials for a Domain Administrator and used them to compromise at least two more endpoints by the end of the first day.
Discovery: The attackers used the Cobalt Strike beacon to discover and map the organization's internal network, collecting administrative level credentials and compromising additional network endpoints.
Lateral Movement: The attackers moved laterally across the infrastructure, compromising numerous workstations in search of critical information and targeting internal hosts and servers that would be used during the actual heist.
Command and Control: The Cobalt Strike beacon was used for command and control, allowing the attackers to communicate with compromised systems and check for new commands to be executed.
Exfiltration: The attackers prepared documents related to internal applications and procedures for exfiltration, which were relevant to the internal applications.
Others: The Carbanak group impersonated high-profile organizations in their spear-phishing campaigns, such as IBM, European Central Bank, and cybersecurity companies. The group's leader was apprehended in Spain on March 26th, 2018, but the group remained active with subsequent campaigns reported until May 2018. The group's use of Cobalt Strike – a pentesting tool – allowed them to infiltrate organizations, move laterally, exfiltrate data, and deploy anti-forensic and evasion tools.",C
1658,382,"Which ATT&CK tactic most likely occurred after the malware established persistence by creating shortcuts in the startup folder and manipulating scheduled tasks, and before it accessed Microsoft Outlook MAPI to gather and send email accounts?",Impact,Defense Evasion,Credential Access,Resource Development,"Reconnaissance: SCILabs identified a new Cosmic Banker attack that matches with previous attacks observed since March 2019. The campaign targets user credentials of Mexican banking institutions and is linked to another campaign targeting users from Brazil's banking institutions. The final phase executable contains specific Portuguese comments also spotted in other reported events, suggesting a link with the Banload malware, which affected banks in Brazil. The reuse of this malware left behind common traces that facilitate the attribution of this campaign to the Brazilian attackers.
Initial Access: The attack begins with an email impersonating Mexico's tax department, Servicio de Administraci\u00f3n Tributaria (SAT), warning of a pending tax return. The email includes a link to download a malicious attachment, COMPROBANTE FISCAL.zip, containing the malicious file COMPROBANTE FISCAL.bat and a folder with the legitimate file GoogleUpdate.exe and another .bat file with the same content as COMPROBANTE FISCAL.bat. Clicking either .bat file triggers the attack.
Execution: The COMPROBANTE FISCAL.bat file includes a batch programming script that executes a PowerShell script from the Internet to run at memory level. The script downloads the file md.zip, which includes the main malware library DLL, the executable loader part of the Autolt toolkit, and other services. The script also creates a random variable and a folder in %Public%, extracts files from md.zip, renames them, and creates a file with specific contents.
Persistence: The PowerShell script includes base64 coded text strings associated with startup persistence features, such as creating shortcuts in the startup folder and manipulating scheduled tasks.
Defense Evasion: The main malicious file 12.dll, renamed to a random name with the .LNS extension and saved in the %Public% folder, is protected with the VMProtect packer, which makes static analysis difficult. The malware also includes the use of the VMProtect packer to make analysis harder in recent months.
Collection: The malware accesses Microsoft Outlook MAPI to try to access contacts' email accounts and sends them to the cyber actors through a POST web request.
Command and Control: The PowerShell script communicates with the following domains to download the malware and send collected data: h1m2en.ddns.net and dgi1b2n3m4.ddns.net.
Exfiltration: The collected email accounts are exfiltrated to the cyber actors through a POST web request to the resource hxxp://dgi1b2n3m4.ddns.net/lists/kk/index.php?list.
Others: SCILabs created a YARA rule to identify files that might belong to the same Cosmic Banker campaign. Additional malware was found in a private source with the YARA rule, including 14 additional compressed files named md.zip and a file named Java_qeyghf8_V.zip containing the pp.png file. The malware detection rate fluctuates from 9 to 27 antivirus search engines, making the detection rate a little low.",B
1766,398,"Which ATT&CK tactic most likely occurred after employing phishing emails and social engineering techniques to establish backdoors within the bank's network, but before installing a legitimate monitoring tool like 'Mipko' to capture screen and keystroke information on the card management application network?",Initial Access,Impact,Resource Development,Execution,"Execution: The attackers executed several malicious payloads on the processor's network, including the installation of a legitimate monitoring tool, 'Mipko' (advertised as 'Employee Monitor'), on the processor's Terminal Server. This tool captured full information, including screen captures and keystrokes, for all users who logged into the system and accessed the card management application.
Privilege Escalation: After gaining initial access to the bank's network, the attackers leveraged control weaknesses in the Windows network to launch lateral movement attacks, obtain 'Keys to the Kingdom', and compromise the bank network. They also compromised the Enterprise Admin account on the processor's network, which gave them full access to the infrastructure.
Defense Evasion: Attackers adopted the tactic of 'living off the land', using legitimate Windows and PowerShell commands combined with tools such as PSExec for lateral movement, and plink.exe to access RDP over an established SSH tunnel. They also used commercial monitoring applications and 'Cobalt Strike Beacon' to maintain backdoor connections.
Credential Access: The attackers identified bank employee accounts on the card management application with authorization to request and approve changes to customer debit cards. They used these credentials to manipulate the cards associated with the rogue accounts created earlier.
Lateral Movement: The attackers compromised the third-party processor's network after numerous attempts, leveraging the bank's established connectivity with the processor. They used captured credentials to connect to the processor's network and executed reconnaissance of the card processing service.
Command and Control: The attackers coordinated ATM withdrawals across multiple cities and countries, using command and control with physical mules for coordinated cash outs. They carefully planned the choice of ATM locations based on criteria such as location, degree of physical security, and the ability to dispense substantial amounts of cash.
Impact: The attackers manipulated the bank's internal systems to enable high overdraft levels and removed anti-fraud controls for specific accounts. They then used the manipulated debit cards to perform cash withdrawals from various ATMs, removing up to USD$10 million from each bank. The final stage of the operation took almost five hours to complete, with simultaneous debit card withdrawals across the geographic region.",A
1631,378,"After Rocket Kitten gained initial access through spear phishing emails containing malicious links or attachments, which ATT&CK tactic most likely occurred before they achieved persistence through repeated password-reset attempts and targeting private email addresses?",Execution,Exfiltration,Persistence,Collection,"Initial Access: The Rocket Kitten Group employs spear phishing and social engineering as their primary point of entry. They establish contact with victims by faking accounts and identities, using fake Google Drive or Gmail accounts, stolen documents, and social media accounts like Facebook. The spear-phishing email contains a link or a file that, when clicked or opened, unleashes a payload that takes over the target machine.
Persistence: Rocket Kitten demonstrates persistence by repeatedly attempting to attack the same targets, using new cover stories and techniques to entice users. They execute numerous password-reset attempts to overwhelm targets, making them believe they are losing control over their accounts. The group prefers to target victims' private email addresses and accounts rather than organizational ones, taking advantage of the lack of peripheral protection at home.
Defense Evasion: Rocket Kitten employs various defense evasion techniques, including using fake identities, making phone calls, and sending messages to gain trust. They breach websites to set up phishing pages or register new domains solely for phishing. The group also uses anti-debugging techniques and obfuscates their strings and API calls to avoid detection.
Credential Access: Rocket Kitten uses social engineering and spear phishing to steal credentials. They take over accounts immediately after obtaining passwords through emails, Facebook messages, or phone calls. They employ a keylogger to capture keystrokes and gain access to additional accounts like Facebook, other email accounts, and cloud accounts.
Command and Control: The infected computers communicate with a C&C server, which can download whatever malware is available or intended for the purpose of the attack. The group uses C&C communication to monitor communications and extract information from the victims.",A
485,186,"Which ATT&CK tactic most likely occurred after attackers used email attachments disguised as politically related documents, such as 'Reports on major developments__347678363764', to lure victims?",Initial Access,Execution,Command and Control,Credential Access,"Execution: Upon opening the malicious documents, victims were presented with decoy content to lower their suspicions while the Pierogi backdoor was installed. The decoy documents included politically charged content, such as fake government documents, news about Hamas, and criticism of Hamas. Weaponized Microsoft Word documents contained an embedded downloader macro that, when enabled, downloaded and executed the Pierogi backdoor.
Persistence: The Pierogi backdoor achieved persistence by adding a shortcut to the startup folder, ensuring it ran upon user login. The shortcut pointed to the backdoor's binary location in the 'C:\ProgramData\' folder.
Defense Evasion: The Pierogi backdoor implemented checks for antivirus and security products, querying Windows for installed antivirus software using WMI and looking for specific products like Kaspersky and Bitdefender. It also used techniques such as file deletion and software packing to evade detection.
Discovery: The backdoor was capable of collecting information about the infected machine, including computer name, username, GUID, antivirus name, and operating system version.
Collection: Pierogi's capabilities included taking screenshots and executing arbitrary commands via the CMD shell, which could be used for data collection.
Command and Control: The backdoor communicated with C2 servers using predefined URLs for sending machine information, receiving commands, and uploading data such as screenshots. It also had the ability to remove information based on commands from the C2 server.
Exfiltration: Data exfiltration was performed through web services, with the backdoor uploading screenshots to the C2 server.
Others: The campaign, suspected to be conducted by MoleRATs, an Arabic-speaking APT group, used the Pierogi backdoor for cyber espionage. The backdoor, written in Delphi, had basic capabilities and checks for a safe running environment. The infrastructure for the campaign was created in November 2019, with domains registered and operationalized shortly after. Cybereason raises the possibility that the backdoor was obtained from underground communities rather than developed in-house.",B
1422,343,"After the PlugX RAT featured UAC bypass injection techniques targeting system processes and before domains like pressmil[.]com and notebookhk[.]net were actively leveraged to maintain communications, which ATT&CK tactic most likely occurred?",Command and Control,Execution,Privilege Escalation,Defense Evasion,"Initial Access: Proofpoint researchers observed a campaign targeting telecom and military in Russia, which began in July 2015 and continued into August, with ongoing activity. The campaign involved spear-phishing emails with exploit-laden Microsoft Word document attachments exploiting CVE-2012-0158 to implant the PlugX RAT. An example attachment named LTE-2600.doc was sent to financial analysts covering the telecom industry. Additionally, URLs leading to RAR archives hosted on fake domains registered for the campaign were used to distribute PlugX. These domains mimicked legitimate Russian military and news websites, with payload file names fitting specific lures related to military events.
Execution: The PlugX RAT was implanted using DLL side-loading techniques, with all payloads using a clean signed executable 'fsguidll.exe' to sideload 'fslapi.dll', which unpacks code from 'fslapi.dll.gui'. The variant of PlugX used is the P2P version described by JPCert.
Persistence: The PlugX configuration included persistence mechanisms such as a Service + Run Key, with installation in the %AUTO%\ucP directory, and a service named 'sWtDmsuBTyMK'.
Privilege Escalation: The PlugX RAT featured UAC bypass injection techniques targeting system processes such as 'msiexec.exe', 'rundll32.exe', 'explorer.exe', and 'dllhost.exe'.
Defense Evasion: One RAR SFX dropper displayed a decoy Microsoft Word document referencing the 'Tsar Bomba' nuclear test before launching the executable, a technique seen as a sandbox evasion method. The payload was not executed until the decoy document was closed. The SFX script was created with a Chinese language pack version of WinRAR.
Others: The campaign targeted Russian-speaking financial analysts working at global financial firms and covering telecom corporations in Russia, likely due to collateral damage. The attackers, believed to operate out of China and tracked as TA459, have targeted various military installations in Central Asia in the past. The campaign employed other backdoors such as Saker, Netbot, and DarkStRat. The attackers demonstrated a keen interest in Russian telecom and military sectors, indicative of geopolitical motives, and adapted their tactics over time. The operation spanned at least two years, with the attackers investing time to research targets and leveraging current events in their tactics. Advanced threat defense solutions are recommended to combat such targeted attacks.",D
360,162,"After the Milum Trojan executes by running as a compiled standalone PE file with zlib compression functions for command and control communication, which ATT&CK tactic most likely occurred to ensure the Trojan survives system restarts and maintains a foothold on the system?",Execution,Privilege Escalation,Persistence,Command and Control,"Execution: On March 27, 2020, Denis Legezo from Kaspersky reported on a malicious campaign named WildPressure, which distributes a C++ Trojan called Milum. The Trojan, originally named Milum46_Win32.exe, is compiled as a standalone PE file and contains zlib compression functions for C2 communication. It uses base64-encoded JSON data for configuration, which includes C2 URLs, timeouts, and RC4 keys. The Trojan transmits compressed JSON data in HTTP POST requests, encrypted with RC4. Persistence is achieved through HKCU autorun system registry keys Run and RunOnce. The malware was first observed targeting organizations in the Middle East, particularly those related to the industrial sector, with no infections registered before May 31, 2019. The compilation timestamps for the samples are consistent, dated March 2019. The campaign infrastructure utilized rented OVH and Netzbetrieb VPS and a domain registered with Domains by Proxy. Kaspersky products detect this malware as Backdoor.Win32.Agent.
Command and Control: The Milum Trojan uses JSON configuration data for command and control (C2) communications, which are transmitted via HTTP POST requests. The data is compressed with gzip, base64-encoded, and encrypted with RC4. The C2 infrastructure includes rented virtual private servers and a domain registered with an anonymization service. The Trojan's configuration data contains various parameters, including client IDs and encryption keys, which are unique to each target and facilitate communication with the C2 servers.
Others: The WildPressure campaign, attributed to the Milum Trojan, targets industrial-related entities in the Middle East. The campaign does not show code similarities with known campaigns, and the attacks are considered targeted. The malware version, indicated as 1.0.1, suggests an early stage of development. The RC4 encryption algorithm is used with different 64-byte keys for different victims. The malware exports zlib compression functions, which are unnecessary for a standalone application, indicating potential plans for non-C++ versions. The campaign operators use target IDs found in the samples, such as HatLandM30 and HatLandid3. The Trojan can execute commands, handle files, and gather system information. The C2 domain sinkholing revealed active infections primarily from the Middle East. The attackers' identity remains unknown, with no strong code- or victim-based similarities to any known actor. The spreading mechanism of Milum is not yet known, and the campaign's targeting may be limited by visibility. The malware could potentially be reused in other operations. Indicators of compromise include specific file MD5 hashes and URLs associated with the campaign.",C
545,197,Which ATT&CK tactic most likely occurred after SunSeed malware achieved persistence via an LNK file installed for autorun at Windows Startup and before issuing GET requests to the C2 server over HTTP every three seconds?,Privilege Escalation,Lateral Movement,Defense Evasion,Persistence,"Initial Access: On February 24, 2022, Proofpoint detected an email from a ukr[.]net address sent to a European government entity. The email's subject was 'IN ACCORDANCE WITH THE DECISION OF THE EMERGENCY MEETING OF THE SECURITY COUNCIL OF UKRAINE DATED 24.02.2022' and included a macro-enabled XLS file titled 'list of persons.xlsx,' which was designed to deliver SunSeed malware.
Execution: The malicious XLS attachment contained a VB macro named 'Module1' that created a Windows Installer object to call out to an actor-controlled staging IP and download a malicious MSI package. The macro set the UILevel to '2' for a silent installation, hiding actions and network connections from the user.
Persistence: The MSI package installed legitimate Lua dependencies, a modified Windows Lua interpreter, a malicious Lua script named SunSeed, and established persistence via an LNK file installed for autorun at Windows Startup.
Command and Control: The SunSeed malware issued GET requests over HTTP via port 80 using a Lua Socket to the C2 server every three seconds, appending the infected target's C Drive partition serial number to the URI request.
Others: Proofpoint identified a phishing campaign likely sponsored by a nation-state, using a possibly compromised Ukrainian armed service member's email account to target European government personnel involved in refugee logistics. The campaign is similar to activity observed in July 2021, suggesting the same threat actor, tracked as part of TA445, is behind both. The campaign's focus on European government personnel managing refugee movement aligns with TA445's tactics, including disinformation operations to manipulate European sentiment around refugees. The campaign may be part of a hybrid warfare model employed by the Russian military and Belarus, aiming to gather intelligence and potentially exploit refugee movements for disinformation purposes.",C
1836,43,Which ATT&CK tactic most likely occurred after the Sin Digoo attackers registered domains under fake identities and before CTU analysts sinkholed 'Tawnya Grilth' domains to gather statistics on infected machines?,Initial Access,Reconnaissance,Persistence,Discovery,"Discovery: CTU analysts sinkholed several 'Tawnya Grilth' domains in 2011 and 2012, redirecting traffic from infected computers to servers that log connections and gather statistics. The initial findings revealed infections in Vietnam, Brunei, Myanmar, Europe, and the Middle East, primarily affecting government ministries, regional petroleum companies, a newspaper, an embassy, a nuclear safety agency, and other business-related groups.
Command and Control: The Sin Digoo domains were found to be connected to the Enfal and RegSubsDat malware families. The Enfal malware, also known as 'EtenFalcon', was first detailed in 2010 and has been involved in espionage campaigns worldwide. RegSubsDat, also referred to as 'Kirpich', was analyzed in various reports, including one detailing a variant used in the Sin Digoo activity. The malware's command-and-control (C2) infrastructure was linked to the China Beijing Province Network (AS4808), known for espionage activities. Connections were also drawn between the RegSubsDat malware and the RSA breach revealed in 2011.
Others: The investigation into the Sin Digoo affair uncovered connections between domain registrations, malware activities, and individuals potentially involved in cyber espionage. The email address jeno_1980@hotmail.com was linked to various domains and social media profiles promoting blackhat SEO services. The investigation also revealed connections to the rootkit.com forum, where users discussed rootkit technologies. The analysis of leaked databases and social media profiles provided insights into the identities and activities of the individuals behind the Sin Digoo domains.",B
697,222,"After employing defense evasion techniques, including deleting files and disabling security tools, which ATT&CK tactic most likely occurred before Sednit gathered information about credentials using dumpers to target browser databases and email clients?",Credential Access,Collection,Resource Development,Discovery,"Initial Access: The Sednit group, also known as APT28, Fancy Bear, Sofacy, or STRONTIUM, launched a spearphishing email campaign at the end of August 2018, distributing shortened URLs that delivered the first stage of Zebrocy components. The campaign relied on social engineering to lure victims into running the first part of the chain. The URL led to an IP-address-based URL where the archived payload was located, containing an executable file and a decoy PDF document. The executable, when run, would prompt for a password and then open the decoy PDF, while the downloader written in Delphi continued to run in the background.
Execution: The Sednit group's operators took control of the backdoor and began sending commands immediately after the victim executed the downloader. The commands included taking screenshots, gathering system information, network scanning, and executing various system commands to collect data from the victim's computer. The operators used a Stage-1 downloader to download and execute a new downloader, written in C++, which then downloaded a Delphi backdoor. The backdoor's configuration was stored in the resource section, split into four different hex-encoded, encrypted blobs.
Persistence: The operators used COM object hijacking for persistence, adding registry keys for a custom backdoor that was executed using the CMD_EXECUTE command. This backdoor was installed only for a few hours and was removed quickly after its operators completed their tasks.
Defense Evasion: The Sednit group's malware deleted files (binaries and files created) after usage and killed processes to disable security tools.
Discovery: The operators gathered information about the victim's computer and environment, including registry keys enumeration, listing running processes, and using system commands to gather information about the victim.
Collection: The malware scanned for files matching specific extensions on the local system, network shared drives, and removable media. It staged data by creating a file containing paths of all files to exfiltrate and had features for input capture and screen capture.
Command and Control: The downloaders and backdoors communicated with the C&C server using commonly used ports 80 or 443. Data sent were hex-encoded and encrypted with AES or a custom algorithm. A fallback C&C server was embedded in the configuration.
Exfiltration: Data were automatically prepared with all file paths to retrieve and sent to the C&C server. The data were hex-encoded and encrypted with a known algorithm or a custom one.",D
2071,82,Which ATT&CK tactic most likely occurred after Hacking Team's spyware avoided detection by using techniques like VMProtect and forged Manifest metadata to appear as legitimate applications?,Initial Access,Privilege Escalation,Command and Control,Defense Evasion,"Initial Access: In the early stages of the investigation, ESET researchers, with input from Citizen Lab, discovered a version of Hacking Team's Remote Control System (RCS) spyware being used in the wild, signed with a previously unseen valid digital certificate. At least in two cases, the spyware was detected in an executable file disguised as a PDF document, attached to a spearphishing email targeting diplomats.
Defense Evasion: The post-leak samples of Hacking Team's spyware were found to have forged Manifest metadata to masquerade as legitimate applications, appearing as 'Advanced SystemCare 9 (9.3.0.1121)', 'Toolwiz Care 3.1.0.0', and 'SlimDrivers (2.3.1.10)'. The authors used VMProtect to make the samples less prone to detection, a technique also common among pre-leak Hacking Team spyware. A difference in Startup file size was noted as a primitive detection evasion technique, changing from 4MB pre-leak to 6MB post-leak.
Others: ESET's analysis of Hacking Team's post-leak spyware samples, compiled between September 2015 and October 2017, suggests active development by Hacking Team's developers. The samples were signed with six different certificates issued to Valeriano Bedeschi, Raffaele Carnacina, Megabit, OOO, ADD Audit, Media Lid, and Ziber Ltd. The versioning observed in the analyzed samples continues where Hacking Team left off before the breach, and follows the same patterns. The functionality of the spyware largely overlaps with that in the leaked source code, with no significant updates confirmed. ESET has detected these new Hacking Team spyware samples in fourteen countries.",C
492,186,"After Pierogi communicated with the C2 servers to send machine information and receive commands, which ATT&CK tactic most likely occurred next in the attack sequence?",Defense Evasion,Impact,Exfiltration,Command and Control,"Initial Access: The campaign targeting Palestinian individuals and entities began with social engineering tactics. Attackers lured victims into opening email attachments or downloading reports on political affairs related to Palestine. The malicious files were disguised as Microsoft Word documents or executables, with names such as 'Reports on major developments__347678363764' and 'Employee-entitlements-2020.doc'.
Execution: Upon opening the malicious documents, victims were presented with decoy content to lower their suspicions while the Pierogi backdoor was installed. The decoy documents included politically charged content, such as fake government documents, news about Hamas, and criticism of Hamas. Weaponized Microsoft Word documents contained an embedded downloader macro that, when enabled, downloaded and executed the Pierogi backdoor.
Persistence: The Pierogi backdoor achieved persistence by adding a shortcut to the startup folder, ensuring it ran upon user login. The shortcut pointed to the backdoor's binary location in the 'C:\ProgramData\' folder.
Defense Evasion: The Pierogi backdoor implemented checks for antivirus and security products, querying Windows for installed antivirus software using WMI and looking for specific products like Kaspersky and Bitdefender. It also used techniques such as file deletion and software packing to evade detection.
Discovery: The backdoor was capable of collecting information about the infected machine, including computer name, username, GUID, antivirus name, and operating system version.
Collection: Pierogi's capabilities included taking screenshots and executing arbitrary commands via the CMD shell, which could be used for data collection.
Command and Control: The backdoor communicated with C2 servers using predefined URLs for sending machine information, receiving commands, and uploading data such as screenshots. It also had the ability to remove information based on commands from the C2 server.
Others: The campaign, suspected to be conducted by MoleRATs, an Arabic-speaking APT group, used the Pierogi backdoor for cyber espionage. The backdoor, written in Delphi, had basic capabilities and checks for a safe running environment. The infrastructure for the campaign was created in November 2019, with domains registered and operationalized shortly after. Cybereason raises the possibility that the backdoor was obtained from underground communities rather than developed in-house.",C
619,21,Which ATT&CK tactic most likely occurred after executing malicious code to enable ongoing access to the compromised network but before threat actors escalated privileges to install further malware or persistence mechanisms?,Lateral Movement,Persistence,Privilege Escalation,Collection,"Initial Access: The initial access phase is the starting point for all subsequent phases of an attack. It includes the initial contact with the attack target and compromising the so-called 'patient zero.'
Execution: The execution of malicious code on a local or remote system primarily takes place in the initial access and lateral movement phases. The next phase cannot be reached without execution of code controlled by the attacker. Execution is thus one of the most important prerequisites for the further development of the attack and for spreading across the target network.
Privilege Escalation: The escalation of privileges is often needed to install malware or persistence points. Increased privileges are sometimes also required to be able to spread to other systems or gain access to the strategic goals (e.g. data).
Defense Evasion: Bypassing defense and detection mechanisms, e.g. by turning off the firewall at the endpoint or deleting log data, is one of the tactical goals that threat actors use in every other phase of their mission to either conceal their presence or bypass detection mechanisms.
Credential Access: Valid credentials play a key role for attackers. Firstly, it enables access to systems with legitimate credentials and lateral movement within the target network. Secondly, it grants access to the data that the attackers want. Furthermore, reusing credentials enables attackers to conduct an attack using few resources because no exploits have to be written, acquired or employed in any other way.
Discovery: Exploration within the target network is required to locate systems, users and data relevant to the mission.
Lateral Movement: This refers to moving across a network to the relevant data for the mission. This is often accompanied by the execution phase and the installation of further persistence points.
Collection: The relevant data is collected.
Command and Control: The command & control channel is the attacker's means of communication to keep the compromised target infrastructure under his control. If the attacker loses this channel, the attack is literally stopped. As such attackers often establish multiple command & control channels to ensure access.
Exfiltration: This is the final phase required to successfully complete the mission and involves exfiltrating the relevant data.",B
300,152,Which ATT&CK tactic most likely occurred before the malicious macro embedded in the Excel file executed the ISMAgent Trojan on the compromised system?,Privilege Escalation,Execution,Exfiltration,Persistence,"Initial Access: On July 16, 2017, actors associated with the OilRig campaign sent emails to five different individuals within the targeted Middle Eastern technology organization. All emails had the same subject, attachment filename, and attached Excel file (SHA256: 3eb14b6705179590f0476d3d3cbd71665e7c1935ecac3df7b876edc9bd7641b6).
Persistence: A scheduled task named 'OfficeServicesStatus' was created to run every three minutes, ensuring the persistence of the ISMAgent payload on the compromised system.
Defense Evasion: The attack utilized a fake compatibility warning message and a decoy invoice document to trick the user and minimize suspicions of malicious activity. The malicious macro was designed to silently install the ISMAgent payload while displaying the decoy document.
Command and Control: The ISMAgent Trojan used HTTP requests and DNS tunneling to communicate with its C2 server. The Trojan parsed received data from the C2 server for a GUID field and commands to run on the compromised system. The C2 server issued commands such as system information gathering and network configuration discovery. The Trojan executed the commands using cmd.exe and sent the output back to the C2 server via HTTP POST requests. The C2 domain used for the attack was ntpupdateserver[.]com, with additional infrastructure including microsoft-publisher[.]com and adobeproduct[.]com.
Others: The OilRig campaign, potentially linked to the Greenbug threat group, has shown iterative behavior in their toolset, maintaining some similarities over time. The inclusion of ISMAgent within the OilRig toolset suggests stronger relationships between various groups operating in the Middle East. Palo Alto Networks customers are protected from these threats with classified samples by WildFire, IPS signatures, and AutoFocus tags. Indicators of Compromise (IoCs) include various SHA256 hashes of Clayslide documents delivering ISMAgent, ISMAgent payloads, and related infrastructure domains.",C
554,199,"After employing a device driver to hook into the Windows firewall and redirect specific communication sessions to evade detection, which ATT&CK tactic most likely occurred next when the Derusbi server variant began listening on a random port for encrypted communication with the client?",Command and Control,Impact,Defense Evasion,Discovery,"Execution: The Derusbi server variant, a type of Remote Access Trojan (RAT), is executed as a service dependent on svchost. It begins its startup sequence by determining the host binary name and its own DLL name, then spawns a new thread containing the main server code. This allows the DllEntryPoint routine to return to the calling function. The server variant checks for sufficient access rights, requiring NT Authority to operate. If the check fails, the server variant terminates. After a 5-second sleep, it verifies the fShutdown flag is not set, which could be triggered by the process loading the server variant calling the DllRegisterServer export. The mainLoop function is then called, which handles the loading of the unique infection ID from the registry or configuration from an encoded buffer, and then saves the newly generated infection ID to the registry.
Persistence: The Derusbi server variant ensures its persistence by installing itself as a service on the victim's machine. This is achieved through the DllRegisterServer function, which is given time to activate and perform necessary operations during the server variant's startup sequence.
Privilege Escalation: The Derusbi server variant attempts to obtain privileges for SeDebugPrivilege, SeLoadDriverPrivilege, SeShutdownPrivilege, and SeTcbPrivilege, which are necessary for loading the driver component of the malware. If the 360 antivirus product is detected on the victim's machine, the driver is not installed, but the mainLoop continues regardless. If the antivirus is not found, the mainLoop extracts, decodes, and installs the driver binary from an encoded buffer within itself.
Defense Evasion: The Derusbi server variant employs a device driver to hook into the Windows firewall, using undocumented techniques for Windows XP and older or the Windows Filtering Platform for Vista and later. The driver inspects incoming network packets and redirects communication sessions to the server variant if a specific handshake is detected. This allows the attacker to hide their communication within legitimate network sessions, evading detection.
Others: The Derusbi server variant's communication and command dispatch involve selecting a random port for listening, establishing a valid handshake for communication, and sending victim information to the client. The handshake is well-defined, consisting of a 64-byte random buffer with specific DWORD patterns. If the handshake fails, a secondary authentication method using a POST request is available. The server variant has a modular design, supporting up to 8 different modules per sample, including remote command shell, network tunneling, and file management. The malware waits for input from the network and routes packets to the appropriate handler. Detection of the Derusbi server variant can be challenging due to the encrypted nature of its network traffic, but heuristic approaches and YARA signatures can be used for detection.",A
865,250,"After the execution of ""vba_macro.exe"" via the Shell command, which ATT&CK tactic most likely ensured that the BlackEnergy dropper would be executed on every system startup?",Reconnaissance,Lateral Movement,Command and Control,Persistence,"Initial Access: Late last year, a wave of cyber-attacks hit several critical sectors in Ukraine. The BlackEnergy APT group, known for targeting Ukraine, utilized Excel documents with macros to drop the BlackEnergy Trojan if the user enabled the script. A new attack vector was identified involving a Microsoft Word document named ""$RR143TB.doc"" (md5: e15b36c2e394d599a8ab352159089dd2), which was uploaded from Ukraine on January 20, 2016. The document, created on 2015-07-27, enticed users to enable macros to view content related to the ""Right Sector"" party in Ukraine. The payload, ""vba_macro.exe"" (md5: ac2d7f21c826ce0c449481f79138aebd), executed upon enabling macros, dropped a DLL file as ""%LOCALAPPDATA%\FONTCACHE.DAT"" and ensured persistence through a LNK file in the startup folder. The final payload connected to a C&C server at 5.149.254[.]114, which is currently offline.
Execution: Upon enabling macros in the malicious Word document, the macro built a string in memory containing a file named ""vba_macro.exe"". This file was then executed using the Shell command, leading to the execution of the BlackEnergy dropper.
Command and Control: The final payload of the BlackEnergy Trojan, identified as FONTCACHE.DAT (md5: 3fa9130c9ec44e36e52142f3688313ff), was designed to connect to a hardcoded C&C server at 5.149.254[.]114 on port 80. The server, previously mentioned by ESET, is currently offline or limiting connections by IP address. If online, the malware would issue an HTTP POST request, sending basic victim info and requesting commands. The request is BASE64 encoded and contains fields such as b_id and b_gen, which include a build id and a unique machine identifier.
Impact: The BlackEnergy APT group's attacks in Ukraine indicate a focus on destructive actions, compromising industrial control installations, and espionage activities. The earliest signs of destructive payloads with BlackEnergy date back to June 2014, with recent attacks showing more sophisticated high-level wiping capabilities targeting file extensions.
Others: Kaspersky Lab's products detect the various trojans mentioned as Backdoor.Win32.Fonten.* and HEUR:Trojan-Downloader.Script.Generic. More information about BlackEnergy APT and extended IOCs are available to customers of Kaspersky Intelligence Services. For countering BlackEnergy and similar threats, Kaspersky Business Blog provides additional insights.",D
1073,29,Which ATT&CK tactic most likely occurred after the malware exited upon detecting antivirus software processes but before SLUB achieved persistence by creating a Run registry key with a typo in the ValueName?,Defense Evasion,Credential Access,Discovery,Initial Access,"Initial Access: The Trend Micro Cyber Safety Solutions Team, consisting of Cedric Pernet, Daniel Lunghi, Jaromir Horejsi, and Joseph C. Chen, reported on March 7, 2019, about a new malware spread via watering hole attacks. The attackers compromised a website and added code to redirect visitors to the infecting code, exploiting CVE-2018-8174, a VBScript engine vulnerability patched by Microsoft in May 2018.
Execution: The malware executes a multi-stage infection process. Initially, it exploits the VBScript engine vulnerability to download a DLL, which is then run in PowerShell. This downloader checks for antivirus software processes and exits if any are found. It also exploits CVE-2015-1701 for Local Privilege Escalation. The second stage involves downloading and executing a backdoor, named SLUB (for SLack and githUB; detected as Backdoor.Win32.SLUB.A).
Persistence: The SLUB backdoor achieves persistence by copying itself to ProgramData\update\ and creating a Run registry key with a typo in the ValueName, 'Microsoft Setup Initializazion', to call the export function UpdateMPUnits with rundll32.exe.
Privilege Escalation: The downloader exploits the CVE-2015-1701 vulnerability to acquire Local Privilege Escalation, likely by modifying code from a GitHub repository.
Discovery: The SLUB backdoor performs discovery by downloading a 'gist' snippet from GitHub and parsing it for commands to execute. It looks for lines starting with '^' and ending with '$', ignoring other lines. The backdoor also retrieves the username and computer name as part of its discovery process.
Collection: The backdoor supports various commands for data collection, including taking screenshots, listing files, copying files, and uploading files to the file.io website. It also collects information from registry keys and creates archives of user's Desktop folders for exfiltration.
Command and Control: The backdoor communicates with the attackers via Slack, using two hardcoded authentication tokens to post messages and command results to a private Slack channel. It also uses the Slack API to post messages.
Exfiltration: The attackers exfiltrate data by uploading files to the file.io website and posting download links to the Slack channel. They also create archive files of user's Desktop folders and build CAB files containing the file tree for exfiltration.
Others: The attackers' tools, techniques, and procedures indicate a stealthy targeted attack by capable actors. The GitHub account and Slack workspace were created specifically for the campaign, and the malware was compiled shortly after. The attackers tested the malware and began observing victims within days. They showed a strong interest in person-related information, focusing on communication software to learn more about the people behind the infected computers. The attackers used public third-party services to leave a clean footprint and targeted groups and individuals interested in political activities. Trend Micro informed the Canadian Centre for Cyber Security, which helped mitigate the attack. Slack and GitHub's security teams removed the related files, cutting off communication between the attackers and their malware.",D
224,139,"After gaining initial access through socially engineered emails exploiting vulnerabilities such as CVE-2010-3333, which ATT&CK tactic most likely occurred before Luckycat malware leveraged Windows Management Instrumentation (WMI) to register a backdoor script?",Initial Access,Privilege Escalation,Persistence,Impact,"Initial Access: The Luckycat campaign, active since at least June 2011, targeted a variety of entities in Japan, India, and Tibetan activists. The attackers employed social engineering tactics, sending contextually relevant emails with malicious attachments that exploited vulnerabilities in popular software such as Adobe Reader and Microsoft Office. Notably, CVE-2010-3333, known as the 'Rich Text Format Stack Buffer Overflow Vulnerability', was frequently exploited. The malware used, identified as TROJ_WIMMIE or VBS_WIMMIE, leveraged Windows Management Instrumentation (WMI) for persistence and communicated with command-and-control (C&C) servers via HTTP over port 80. The attackers utilized free web-hosting services for diverse domain names but also employed Virtual Private Servers (VPSs) for more stable operations.
Defense Evasion: The Luckycat malware, TROJ_WIMMIE and VBS_WIMMIE, evaded detection by leveraging Windows Management Instrumentation (WMI) to avoid simple file scanning by antivirus software. The attackers also used proxy and anonymity tools to shield their identities and a variety of mailing programs to instigate targeted attacks.
Command and Control: The Luckycat campaign extensively used free hosting services for command-and-control (C&C) operations, with domains registered using diverse email addresses. The attackers also maintained servers on dedicated VPS services, providing a resilient infrastructure. The malware communicated with the C&C servers using HTTP over port 80, posting data to a PHP script, usually count.php, and executing commands received from the attackers.
Others: The Luckycat campaign was linked to other campaigns, including ShadowNet, Duojeen, Sparksrv, and Comfoo, indicating possible collaboration or shared infrastructure. The attackers tested their malware in a virtual environment using a Chinese-language version of Windows XP. They also used anonymity tools like Tor and Tunnelier to obscure their locations and mailing software such as FoxMail and Supermailer for sending socially engineered emails. The campaign was connected to a hacker in the Chinese underground community, known by the nicknames 'dang0102' and 'scuhkr', who had ties to the Information Security Institute of Sichuan University.",B
524,193,Which ATT&CK tactic most likely preceded the use of phishing emails with fake security alerts and compromised public figure accounts to gain access to targets' credentials in the Charming Kitten campaign?,Resource Development,Persistence,Command and Control,Initial Access,"Reconnaissance: Certfa's review of 'The Return of The Charming Kitten' campaign reveals that Iranian state-backed hackers have targeted individuals involved in sanctions against Iran, as well as politicians, activists, and journalists worldwide. The attackers collected information on their targets prior to phishing attacks, tailoring their approach based on the target's cyber knowledge, contacts, activities, working time, and geographic location.
Persistence: In some cases, the hackers did not change the passwords of the victim's accounts, allowing them to remain undetected and monitor communications in real-time.
Defense Evasion: The attackers used images instead of text in phishing emails to bypass Google's security systems. They also used third-party services like Firefox Screenshot to host these images. Additionally, a hidden tracking image was used in emails to alert the attackers when a target opened the email.
Credential Access: The phishing pages were designed for both desktop and mobile versions of Google and Yahoo! mail services. The attackers verified the victims' credentials in real-time and, if correct, prompted for the 2-step verification code, allowing them to bypass even two-factor authentication methods.
Others: The campaign's phishing infrastructure included over 20 domain names set up between September and November 2018. Technical reviews indicated that the attackers used VPNs and proxies with Dutch and French IP addresses but were traced back to real Iranian IP addresses during the preparation phase. The campaign's timing, methods, and targets suggest it is linked to the Charming Kitten group, known for its connections to the Iranian government. The campaign coincides with the U.S. imposing new sanctions on Iran on November 4, 2018, and aims to infiltrate accounts of individuals working on sanctions against Iran.",A
1015,278,Which ATT&CK tactic most likely occurred after phishing pages created with the Mephistophilus phishing kit and mailings with macro-laden attachments successfully introduced Raccoon stealer into the victim environment?,Execution,Initial Access,Collection,Credential Access,"Execution: The Raccoon stealer, once executed, collects system information, account data, bank card data, and autofill form details from browsers. It also scans for valid crypto wallets and gains access to configuration files. The Vidar stealer, another malware used in the campaign, collects data from browsers, bank card data, crypto wallet files, messages, and more.
Defense Evasion: The attackers used obfuscation techniques such as aaencode algorithm to hide the JS-sniffer's code. They also used loaders like Buer and Smoke to download payloads. The Raccoon stealer made network requests to a Telegram channel to receive the encrypted address of a new C&C server, bypassing blocking.
Command and Control: The Raccoon stealer communicated with C&C servers using legitimate features of Telegram to avoid detection. The C&C servers were encrypted and distributed through the Telegram channel 'blintick'.
Others: The campaign was divided into four stages based on the tools used: First wave (February 19 to March 5, 2020), Second wave (March 13 to May 22, 2020), Third wave (June 29 to July 2, 2020), and Fourth wave (August 24 to September 12, 2020). Most domains related to the campaign were registered with two registrars: Cloud2m and Host Africa. The attackers also distributed samples of another stealer called Vidar using malicious macros and phishing pages. The domains used to store the code and collect stolen bank card data were registered during the second wave with the same registrars as the domains discovered while investigating the malicious campaign. The attackers experimented with various loaders, including Buer and Smoke loaders. The campaign's purpose was to steal payment and user data.",D
1488,355,Which ATT&CK tactic most likely occurred after Iranian threat actors established fake personas and a fictitious news organization to support their reconnaissance activities on social media?,Collection,Resource Development,Reconnaissance,Defense Evasion,"Reconnaissance: Iranian threat actors conducted a cyber espionage operation named NEWSCASTER since 2011, using fake personas on social media to connect with US officials and gather information. They created over a dozen fake personas, including falsified identities from news organizations and attractive women profiles, supported by a fictitious news organization called NewsOnAir.org. The attackers connected with over 2,000 individuals to access information on their location, activities, and relationships.
Initial Access: The Iranian hackers used social media platforms such as Facebook, Twitter, LinkedIn, Google+, YouTube, and Blogger to initiate their attack. They sent spear-phishing messages with links to fake pages to capture credentials, gaining initial access to their targets' networks.
Defense Evasion: The NEWSCASTER campaign, while not technically sophisticated, was effective and under the radar. The attackers used low-tech approaches to avoid traditional security defenses, exploiting social media and the human element, which is often the weakest link in security.
Credential Access: The campaign focused on credential harvesting and reconnaissance. The attackers used social media connections to harvest corporate and personal email credentials, which could be used for further lateral movements within the targeted networks.
Lateral Movement: After establishing connections on social media, the attackers used the harvested credentials to potentially move laterally within the networks of their targets, which included senior U.S. military and diplomatic personnel, congressional personnel, journalists, think tanks, and defense contractors in the U.S. and Israel, among others.
Command and Control: The campaign leveraged malware with the capability to exfiltrate data, although the malware used was not particularly sophisticated.
Others: The NEWSCASTER operation targeted victims in the U.K., Saudi Arabia, Iraq, and vocal supporters of Israel, suggesting an interest in political, military, diplomatic, and technical intelligence. The attackers maintained a regular work schedule consistent with Tehran's timezone, and their targets and technical indicators led iSIGHT Partners to believe the campaign originated from Iran. iSIGHT Partners coordinated with the FBI and notified social networks, leading to the removal of malicious personas from Facebook and LinkedIn. The report comes after FireEye suggested that Iranian attackers' methodologies have become more consistent with other advanced persistent threat actors in Iran following cyber attacks against Iran in the late 2000s.",C
1060,287,Which ATT&CK tactic most likely occurred after GADOLINIUM delivered malicious Access database files and PowerPoint attachments through spear-phishing emails to execute payloads on the victim's systems?,Privilege Escalation,Impact,Initial Access,Reconnaissance,"Privilege Escalation: GADOLINIUM used tools like LazyCat, which includes privilege escalation and credential dumping capabilities, to enable lateral movement across victim networks. Microsoft Defender for Endpoint detects the privilege escalation technique used by LazyCat.
Defense Evasion: GADOLINIUM has been using cloud services and open-source tools to obfuscate their activity and make it difficult for analysts to track. They have used cloud-based technology to create a malicious infrastructure that can be quickly established and taken down before detection or given up at little cost.
Command and Control: GADOLINIUM used Outlook Tasks as a mechanism for command and control (C2), utilizing a controlled OAuth access token to call the Outlook Task API. They also installed web shells on legitimate websites for C2 or traffic redirection. Microsoft Defender for Endpoint detects web shells by analyzing web server telemetry. In 2020, GADOLINIUM's PowerShell Empire toolkit allowed attackers to load additional modules to victim computers via Microsoft Graph API calls, using the attacker's Microsoft OneDrive account to execute commands and retrieve results between attacker and victim systems.
Others: Microsoft Security tracks advanced threat actors like GADOLINIUM and shares findings to harden products and platforms. Microsoft suspended 18 Azure Active Directory applications part of GADOLINIUM's malicious C2 infrastructure, protecting customers transparently. GADOLINIUM, a nation-state activity group, has been compromising targets for nearly a decade, focusing on the maritime and health industries, and has expanded targeting to the Asia Pacific region, higher education, and regional government organizations. Microsoft's proactive defense measures include detecting individual attack components and preventing attackers from using cloud infrastructure to execute attacks.",A
1945,62,Which ATT&CK tactic most likely occurred after the attackers used the compromised ESTsoft server to distribute a trojaned update file containing 'Backdoor.Agent.Hza' to SK Communications computers during their routine software update checks?,Discovery,Initial Access,Execution,Persistence,"Execution: The malware 'Backdoor.Agent.Hza', dropped by the trojaned update file, executed on the infected SK Communications computers, establishing a backdoor for the attackers. The malware communicated with a command and control server located at the South Korean IP address 116.127.121.41 on TCP port 8080. The attackers also installed additional malware named 'nateon.exe' on at least one of the infected computers, which was used to access the user databases.
Defense Evasion: The attackers used a legitimate software update process as a means of delivering the trojaned update, effectively turning a security practice into a vulnerability. The security of software updates is usually trusted implicitly, and the exploitation of this trust relationship went undetected by SK Communications for some time.
Command and Control: The infected computers communicated with a command and control server using the domain 'update.alyac.org', which resolved to the South Korean IP address 116.127.121.41. The attackers used this infrastructure to monitor and control the infected computers, and to facilitate the theft of personal information from the user databases.
Exfiltration: The attackers exfiltrated the personal details of up to 35 million SK Communications customers from the user databases to a waypoint, purportedly belonging to a company based in Seoul's Nonhyeon neighborhood. The personal information included names, phone numbers, home and email addresses, birth dates, gender details, user identifiers, passwords, and resident registration numbers due to South Korea's Real Name System in place at the time.",C