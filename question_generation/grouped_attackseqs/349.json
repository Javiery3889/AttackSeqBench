{
    "file_name": "HALFRIG_",
    "tactic_label": true,
    "rewrite": {
        "Resource Development": "Resource Development T1583.003 T1584\n\nVirtual Private Server Compromise Infrastructure The adversary used compromised webservers to host ENVYSCOUT delivery scripts\n\nThe adversary used VPSs to host malware C2s",
        "Initial Access": "Initial Access T1566 T1566.001\n\nThe adversary sent emails that used diplomatic themes Phishing Spearphishing Attachment The adversary sent emails with a PDF attachment.\n\nThe PDF contained a link to ENVYSCOUT",
        "Execution": "Execution T1204\n\nUser Execution\n\nT1204.002\n\nMalicious File\n\nThe adversary relies on tricking users into executing malware The adversary used malicious DLL DLL Hijacking to execute malware loaded via",
        "Persistence": "Persistence T1547.001\n\nT1574.001\n\nRegistry Run Keys Startup Folder DLL Search Order Hijacking\n\nT1574.002\n\nDLL Side-Loading\n\nThe adversary used the Run registry key to maintain persistence The adversary used malicious DLL loaded via DLL Hijacking into a process created from a legitimate binary to execute malware The adversary maintains persistence by planting a copy of a legitimate binary that loads malicious DLL",
        "Defense Evasion": "Defense Evasion T1027.006\n\nHTML Smuggling\n\nT1140\n\nT1553.005\n\nDeobfuscate/Decode Files or Information Mark-of-the-Web Bypass\n\nT1574.001\n\nDLL Search Order Hijacking\n\nT1574.002\n\nDLL Side-Loading\n\nENVYSCOUT delivery script uses HTML Smuggling to bypass security controls The adversary uses obfuscation to protect sensitive information (i.e. strings). The adversary abuses container files such as ISO to deliver malicious payloads that are not tagged with MOTW The adversary used malicious DLL loaded via DLL Hijacking into a process created from a legitimate binary to execute malware The adversary maintains persistence by planting a copy of a legitimate binary that loads malicious DLL"
    },
    "technique_label": true,
    "triplet_groups": {
        "Resource Development": {
            "T1583-Acquire Infrastructure": [
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "compromised webservers",
                    "ObjectType": "infrastructure",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 1
                },
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "host",
                    "Object": "ENVYSCOUT delivery scripts",
                    "ObjectType": "artifacts",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 2
                },
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "VPSs",
                    "ObjectType": "infrastructure",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 3
                }
            ],
            "T1584-Compromise Infrastructure": [
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "compromised webservers",
                    "ObjectType": "infrastructure",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 1
                },
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "host",
                    "Object": "ENVYSCOUT delivery scripts",
                    "ObjectType": "artifacts",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 2
                },
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "VPSs",
                    "ObjectType": "infrastructure",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1583-Acquire Infrastructure",
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 3
                },
                {
                    "Subject": "The adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "host",
                    "Object": "malware C2s",
                    "ObjectType": "infrastructure",
                    "tactic": "Resource Development",
                    "technique": [
                        "T1584-Compromise Infrastructure"
                    ],
                    "id": 4
                }
            ]
        },
        "Initial Access": {
            "T1566-Phishing": [
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "send",
                    "Object": "emails",
                    "ObjectType": "Email Message",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 5
                },
                {
                    "Subject": "PDF attachment",
                    "SubjectType": "file",
                    "Relation": "contain",
                    "Object": "ENVYSCOUT",
                    "ObjectType": "Malware",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 6
                }
            ]
        },
        "Execution": {
            "T1204-User Execution": [
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "rely on",
                    "Object": "tricking users into executing malware",
                    "ObjectType": "Technique",
                    "tactic": "Execution",
                    "technique": [
                        "T1204-User Execution"
                    ],
                    "id": 7
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "malicious DLL",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1204-User Execution",
                        "T1129-Shared Modules"
                    ],
                    "id": 8
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "execute",
                    "Object": "malware",
                    "ObjectType": "Malware",
                    "tactic": "Execution",
                    "technique": [
                        "T1204-User Execution",
                        "T1129-Shared Modules"
                    ],
                    "id": 9
                }
            ],
            "T1129-Shared Modules": [
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "malicious DLL",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1204-User Execution",
                        "T1129-Shared Modules"
                    ],
                    "id": 8
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "execute",
                    "Object": "malware",
                    "ObjectType": "Malware",
                    "tactic": "Execution",
                    "technique": [
                        "T1204-User Execution",
                        "T1129-Shared Modules"
                    ],
                    "id": 9
                }
            ]
        },
        "Persistence": {
            "T1547-Boot or Logon Autostart Execution": [
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "Run registry key",
                    "ObjectType": "registry",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 10
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "DLL Hijacking",
                    "ObjectType": "technique",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 11
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "maintain persistence by planting",
                    "Object": "legitimate binary",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 12
                }
            ],
            "T1574-Hijack Execution Flow": [
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "Run registry key",
                    "ObjectType": "registry",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 10
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "DLL Hijacking",
                    "ObjectType": "technique",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 11
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "maintain persistence by planting",
                    "Object": "legitimate binary",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1547-Boot or Logon Autostart Execution",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 12
                }
            ]
        },
        "Defense Evasion": {
            "T1027-Obfuscated Files or Information": [
                {
                    "Subject": "ENVYSCOUT delivery script",
                    "SubjectType": "tool",
                    "Relation": "use",
                    "Object": "HTML Smuggling",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 13
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "obfuscation",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 14
                }
            ],
            "T1140-Deobfuscate/Decode Files or Information": [
                {
                    "Subject": "ENVYSCOUT delivery script",
                    "SubjectType": "tool",
                    "Relation": "use",
                    "Object": "HTML Smuggling",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 13
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "obfuscation",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 14
                }
            ],
            "T1553-Subvert Trust Controls": [
                {
                    "Subject": "ENVYSCOUT delivery script",
                    "SubjectType": "tool",
                    "Relation": "use",
                    "Object": "HTML Smuggling",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 13
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "obfuscation",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 14
                }
            ],
            "T1574-Hijack Execution Flow": [
                {
                    "Subject": "ENVYSCOUT delivery script",
                    "SubjectType": "tool",
                    "Relation": "use",
                    "Object": "HTML Smuggling",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 13
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "obfuscation",
                    "ObjectType": "technique",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1027-Obfuscated Files or Information",
                        "T1140-Deobfuscate/Decode Files or Information",
                        "T1553-Subvert Trust Controls",
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 14
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "malicious DLL",
                    "ObjectType": "file",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 16
                },
                {
                    "Subject": "adversary",
                    "SubjectType": "threat-actor",
                    "Relation": "maintain",
                    "Object": "persistence",
                    "ObjectType": "Tactic",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 17
                }
            ]
        }
    }
}