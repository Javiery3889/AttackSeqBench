{
    "triplets": [
        {
            "Subject": "phishing email",
            "SubjectType": "Email Message",
            "Relation": "disguise-as",
            "Object": "communication from UPS",
            "ObjectType": "Email Message",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 1
        },
        {
            "Subject": "phishing email",
            "SubjectType": "Email Message",
            "Relation": "contain",
            "Object": "link",
            "ObjectType": "url",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 2
        },
        {
            "Subject": "link",
            "SubjectType": "url",
            "Relation": "redirect",
            "Object": "victim",
            "ObjectType": "identity",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 3
        },
        {
            "Subject": "SharePoint URL",
            "SubjectType": "url",
            "Relation": "download",
            "Object": "Data.zip",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 4
        },
        {
            "Subject": "Data.zip",
            "SubjectType": "file",
            "Relation": "include",
            "Object": "VBS script",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 5
        },
        {
            "Subject": "VBS script",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "JavaScript backdoor",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 6
        },
        {
            "Subject": "JavaScript backdoor",
            "SubjectType": "Malware",
            "Relation": "connect to",
            "Object": "sephardimension[.]com",
            "ObjectType": "domain-name",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 7
        },
        {
            "Subject": "JavaScript backdoor",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "CARBANAK RAT",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter",
                "T1129-Shared Modules",
                "T1106-Native API"
            ],
            "id": 8
        },
        {
            "Subject": "CARBANAK RAT",
            "SubjectType": "Malware",
            "Relation": "establish connection with",
            "Object": "170.130.55[.]85:443",
            "ObjectType": "ipv4-addr",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 9
        },
        {
            "Subject": "CARBANAK RAT",
            "SubjectType": "Malware",
            "Relation": "download",
            "Object": "anunak_config",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 10
        },
        {
            "Subject": "The attacker",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "Cobalt Strike",
            "ObjectType": "software",
            "tactic": "Discovery",
            "technique": [
                "T1018-Remote System Discovery"
            ],
            "id": 11
        },
        {
            "Subject": "The attacker",
            "SubjectType": "threat-actor",
            "Relation": "begin",
            "Object": "reconnaissance and data discovery",
            "ObjectType": "attack-pattern",
            "tactic": "Discovery",
            "technique": [
                "T1018-Remote System Discovery"
            ],
            "id": 12
        },
        {
            "Subject": "This stage of the attack",
            "SubjectType": "campaign",
            "Relation": "last",
            "Object": "about a week",
            "ObjectType": "date",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 13
        },
        {
            "Subject": "This stage of the attack",
            "SubjectType": "campaign",
            "Relation": "conduct",
            "Object": "from a completely different infrastructure",
            "ObjectType": "infrastructure",
            "tactic": "Discovery",
            "technique": [
                "T1018-Remote System Discovery"
            ],
            "id": 14
        },
        {
            "Subject": "The CARBANAK RAT",
            "SubjectType": "Malware",
            "Relation": "beacon to",
            "Object": "the Command-and-Control server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 15
        },
        {
            "Subject": "The PowerShell RAT",
            "SubjectType": "Malware",
            "Relation": "communicate with",
            "Object": "the domain hxxps://besaintegration[.]com/gate",
            "ObjectType": "domain-name",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1571-Non-Standard Port"
            ],
            "id": 16
        },
        {
            "Subject": "RYUK ransomware",
            "SubjectType": "Malware",
            "Relation": "deploy",
            "Object": "a week after the attacker began reconnaissance of the network and exfiltrated the desired data",
            "ObjectType": "date",
            "tactic": "Impact",
            "technique": [
                "T1486-Data Encrypted for Impact"
            ],
            "id": 17
        },
        {
            "Subject": "The ransomware",
            "SubjectType": "Malware",
            "Relation": "deploy",
            "Object": "using both manual and scripted methods",
            "ObjectType": "Tactic",
            "tactic": "Impact",
            "technique": [
                "T1486-Data Encrypted for Impact"
            ],
            "id": 18
        },
        {
            "Subject": "The ransomware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "a batch file",
            "ObjectType": "file",
            "tactic": "Impact",
            "technique": [
                "T1486-Data Encrypted for Impact"
            ],
            "id": 19
        },
        {
            "Subject": "a batch file",
            "SubjectType": "file",
            "Relation": "disable",
            "Object": "protections and security software",
            "ObjectType": "software",
            "tactic": "Impact",
            "technique": [
                "T1486-Data Encrypted for Impact"
            ],
            "id": 20
        },
        {
            "Subject": "remote code execution",
            "SubjectType": "attack-pattern",
            "Relation": "achieve",
            "Object": "using remote WMI command execution and PsExec",
            "ObjectType": "tool",
            "tactic": "Impact",
            "technique": [
                "T1486-Data Encrypted for Impact"
            ],
            "id": 21
        },
        {
            "Subject": "attacker",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "victim network",
            "ObjectType": "network traffic",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 22
        },
        {
            "Subject": "attacker",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "SmartFTP Client",
            "ObjectType": "software",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 23
        },
        {
            "Subject": "SmartFTP Client",
            "SubjectType": "software",
            "Relation": "communicate-with",
            "Object": "IP address",
            "ObjectType": "ipv4-addr",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 24
        },
        {
            "Subject": "files",
            "SubjectType": "artifacts",
            "Relation": "found-in",
            "Object": "Unlocker-List.txt",
            "ObjectType": "file",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 25
        },
        {
            "Subject": "attacker",
            "SubjectType": "threat-actor",
            "Relation": "install",
            "Object": "IObit Unlocker",
            "ObjectType": "software",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 26
        },
        {
            "Subject": "The exfiltration of data",
            "SubjectType": "network trafic",
            "Relation": "use",
            "Object": "SmartFTP Client",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1048-Exfiltration Over Alternative Protocol"
            ],
            "id": 27
        },
        {
            "Subject": "SmartFTP Client",
            "SubjectType": "tool",
            "Relation": "connect-to",
            "Object": "an IP address",
            "ObjectType": "ipv4-addr",
            "tactic": "Exfiltration",
            "technique": [
                "T1048-Exfiltration Over Alternative Protocol"
            ],
            "id": 28
        },
        {
            "Subject": "The data theft",
            "SubjectType": "network trafic",
            "Relation": "occur-during",
            "Object": "the third stage of the attack",
            "ObjectType": "campaign",
            "tactic": "Exfiltration",
            "technique": [
                "T1048-Exfiltration Over Alternative Protocol"
            ],
            "id": 29
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "perform",
            "Object": "escalation attempts",
            "ObjectType": "Tactic",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 30
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "RunPsExec",
            "ObjectType": "tool",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1078-Valid Accounts"
            ],
            "id": 31
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "install",
            "Object": "PowerShell RAT",
            "ObjectType": "Malware",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 32
        },
        {
            "Subject": "PowerShell RAT",
            "SubjectType": "Malware",
            "Relation": "connect to",
            "Object": "hxxps://besaintegration[.]com/gate",
            "ObjectType": "domain",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 33
        },
        {
            "Subject": "PowerShell RAT",
            "SubjectType": "Malware",
            "Relation": "include",
            "Object": "functions",
            "ObjectType": "Tactic",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 34
        }
    ],
    "file_name": "blog.truesec.com-Collaboration between FIN7 and the RYUK group a Truesec Investigation",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The initial access to the victim's network was achieved through a phishing email disguised as a communication from UPS. The email contained a link that redirected the victim to a SharePoint URL, which subsequently downloaded a ZIP file named \"Data.zip\". This file included a VBS script that dropped another script, launching a JavaScript backdoor on the victim's machine. This method of using a VBS script to drop JavaScript is a known technique employed by FIN7 and similar groups.",
        "Execution": "The execution phase involved the deployment of a JavaScript backdoor, which connected to the domain sephardimension[.]com. The backdoor was used to install the CARBANAK RAT on the domain controllers of the victim network. An obfuscated script was downloaded and executed, loading a DLL file in memory and executing it through reflection methods. The CARBANAK RAT then established a connection with a Command-and-Control server at 170.130.55[.]85:443 to download the malware configuration file anunak_config.",
        "Privilege Escalation": "The threat actor performed typical escalation attempts in the Active Directory from the compromised client. After ensuring admin privileges, the attacker used RunPsExec against several clients and servers to install a second malicious code, a PowerShell RAT. This RAT connected to the domain hxxps://besaintegration[.]com/gate and included functions to retrieve basic system information and manage arbitrary commands as background jobs.",
        "Discovery": "The attacker deployed Cobalt Strike on the network and began reconnaissance and data discovery. This stage of the attack lasted about a week and was conducted from a completely different infrastructure than the first two stages.",
        "Collection": "During the discovery stage, the attacker exfiltrated data from the victim network using the SmartFTP Client, which connected to an IP address controlled by the attacker. The names of some of the files exfiltrated were found in the file \"Unlocker-List.txt\", part of the IObit Unlocker software installed by the attacker.",
        "Command and Control": "The CARBANAK RAT, once installed, would beacon to the Command-and-Control server at 170.130.55[.]85:443. Additionally, the PowerShell RAT communicated with the domain hxxps://besaintegration[.]com/gate.",
        "Exfiltration": "The exfiltration of data was performed using the SmartFTP Client, which connected to an IP address under the attacker's control. The data theft occurred during the third stage of the attack.",
        "Impact": "The RYUK ransomware was deployed a week after the attacker began reconnaissance of the network and exfiltrated the desired data. The ransomware was deployed using both manual and scripted methods, including a batch file to disable protections and security software, and remote code execution was achieved using remote WMI command execution and PsExec."
    },
    "technique_label": true
}