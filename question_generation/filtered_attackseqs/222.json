{
    "triplets": [
        {
            "Subject": "Sednit group",
            "SubjectType": "threat-actor",
            "Relation": "launch",
            "Object": "spearphishing email campaign",
            "ObjectType": "campaign",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 1
        },
        {
            "Subject": "URL",
            "SubjectType": "url",
            "Relation": "deliver",
            "Object": "Zebrocy components",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 2
        },
        {
            "Subject": "executable",
            "SubjectType": "file",
            "Relation": "prompt",
            "Object": "password",
            "ObjectType": "artifact",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 3
        },
        {
            "Subject": "downloader",
            "SubjectType": "tool",
            "Relation": "run",
            "Object": "background",
            "ObjectType": "Location",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 4
        },
        {
            "Subject": "Sednit group's operators",
            "SubjectType": "threat-actor",
            "Relation": "take control",
            "Object": "backdoor",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 5
        },
        {
            "Subject": "Sednit group's operators",
            "SubjectType": "threat-actor",
            "Relation": "send",
            "Object": "commands",
            "ObjectType": "artifact",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 6
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Stage-1 downloader",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 7
        },
        {
            "Subject": "Stage-1 downloader",
            "SubjectType": "tool",
            "Relation": "download and execute",
            "Object": "new downloader",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 8
        },
        {
            "Subject": "new downloader",
            "SubjectType": "tool",
            "Relation": "download",
            "Object": "Delphi backdoor",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 9
        },
        {
            "Subject": "operators",
            "Relation": "use",
            "Object": "COM object hijacking",
            "ObjectType": "Technique",
            "tactic": "Persistence",
            "SubjectType": "Others",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 10
        },
        {
            "Subject": "operators",
            "Relation": "add",
            "Object": "registry keys",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "SubjectType": "Others",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 11
        },
        {
            "Subject": "operators",
            "Relation": "execute",
            "Object": "custom backdoor",
            "ObjectType": "Malware",
            "tactic": "Persistence",
            "SubjectType": "Others",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 12
        },
        {
            "Subject": "operators",
            "Relation": "remove",
            "Object": "custom backdoor",
            "ObjectType": "Malware",
            "tactic": "Persistence",
            "SubjectType": "Others",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 13
        },
        {
            "Subject": "The Sednit group's malware",
            "SubjectType": "Malware",
            "Relation": "delete",
            "Object": "files",
            "ObjectType": "artifacts",
            "tactic": "Defense Evasion",
            "technique": [
                "T1070-Indicator Removal"
            ],
            "id": 14
        },
        {
            "Subject": "The Sednit group's malware",
            "SubjectType": "Malware",
            "Relation": "kill",
            "Object": "processes",
            "ObjectType": "process",
            "tactic": "Defense Evasion",
            "technique": [
                "T1562-Impair Defenses"
            ],
            "id": 15
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "scan for",
            "Object": "files",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ],
            "id": 16
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "stage",
            "Object": "data",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ],
            "id": 17
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "file",
            "ObjectType": "file",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ],
            "id": 18
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "have features for",
            "Object": "input capture",
            "ObjectType": "technique",
            "tactic": "Collection",
            "technique": [
                "T1056-Input Capture"
            ],
            "id": 19
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "have features for",
            "Object": "screen capture",
            "ObjectType": "technique",
            "tactic": "Collection",
            "technique": [
                "T1113-Screen Capture"
            ],
            "id": 20
        },
        {
            "Subject": "downloaders and backdoors",
            "SubjectType": "malware",
            "Relation": "communicate with",
            "Object": "C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1205-Traffic Signaling"
            ],
            "id": 21
        },
        {
            "Subject": "Data",
            "SubjectType": "network traffic",
            "Relation": "encrypted with",
            "Object": "AES or a custom algorithm",
            "ObjectType": "encryption-algorithm",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 22
        },
        {
            "Subject": "A fallback C&C server",
            "SubjectType": "infrastructure",
            "Relation": "embedded in",
            "Object": "the configuration",
            "ObjectType": "artifacts",
            "tactic": "Command and Control",
            "technique": [
                "T1008-Fallback Channels"
            ],
            "id": 23
        },
        {
            "Subject": "Data",
            "SubjectType": "artifacts",
            "Relation": "prepare",
            "Object": "file paths",
            "ObjectType": "directory",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration",
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 24
        },
        {
            "Subject": "Data",
            "SubjectType": "artifacts",
            "Relation": "send",
            "Object": "C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration",
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 25
        },
        {
            "Subject": "Data",
            "SubjectType": "artifacts",
            "Relation": "encode",
            "Object": "hex",
            "ObjectType": "encoding",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration",
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 26
        },
        {
            "Subject": "Data",
            "SubjectType": "artifacts",
            "Relation": "encrypt",
            "Object": "known algorithm",
            "ObjectType": "encryption-algorithm",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration",
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 27
        },
        {
            "Subject": "Data",
            "SubjectType": "artifacts",
            "Relation": "encrypt",
            "Object": "custom algorithm",
            "ObjectType": "encryption-algorithm",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration",
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 28
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "dumpers",
            "ObjectType": "tool",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 29
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "dumpers",
            "ObjectType": "tool",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 30
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "browsers",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 31
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "Microsoft Outlook",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 32
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "retrieve",
            "Object": "databases",
            "ObjectType": "artifacts",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 33
        },
        {
            "Subject": "databases",
            "SubjectType": "artifacts",
            "Relation": "related-to",
            "Object": "credentials",
            "ObjectType": "artifacts",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 34
        },
        {
            "Subject": "credentials",
            "SubjectType": "artifacts",
            "Relation": "from",
            "Object": "Firefox",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 35
        },
        {
            "Subject": "credentials",
            "SubjectType": "artifacts",
            "Relation": "from",
            "Object": "The Bat! email client",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 36
        },
        {
            "Subject": "credentials",
            "SubjectType": "artifacts",
            "Relation": "from",
            "Object": "Opera",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 37
        },
        {
            "Subject": "operators",
            "SubjectType": "threat-actor",
            "Relation": "gather",
            "Object": "information",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ],
            "id": 38
        }
    ],
    "file_name": "A journey to Zebrocy land",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The Sednit group, also known as APT28, Fancy Bear, Sofacy, or STRONTIUM, launched a spearphishing email campaign at the end of August 2018, distributing shortened URLs that delivered the first stage of Zebrocy components. The campaign relied on social engineering to lure victims into running the first part of the chain. The URL led to an IP-address-based URL where the archived payload was located, containing an executable file and a decoy PDF document. The executable, when run, would prompt for a password and then open the decoy PDF, while the downloader written in Delphi continued to run in the background.",
        "Execution": "The Sednit group's operators took control of the backdoor and began sending commands immediately after the victim executed the downloader. The commands included taking screenshots, gathering system information, network scanning, and executing various system commands to collect data from the victim's computer. The operators used a Stage-1 downloader to download and execute a new downloader, written in C++, which then downloaded a Delphi backdoor. The backdoor's configuration was stored in the resource section, split into four different hex-encoded, encrypted blobs.",
        "Persistence": "The operators used COM object hijacking for persistence, adding registry keys for a custom backdoor that was executed using the CMD_EXECUTE command. This backdoor was installed only for a few hours and was removed quickly after its operators completed their tasks.",
        "Defense Evasion": "The Sednit group's malware deleted files (binaries and files created) after usage and killed processes to disable security tools.",
        "Credential Access": "The operators uploaded and used dumpers on victims' machines to target browsers and versions of Microsoft Outlook from 1997 through 2016. They retrieved databases related to credentials from software such as Firefox, The Bat! email client, and Opera.",
        "Discovery": "The operators gathered information about the victim's computer and environment, including registry keys enumeration, listing running processes, and using system commands to gather information about the victim.",
        "Collection": "The malware scanned for files matching specific extensions on the local system, network shared drives, and removable media. It staged data by creating a file containing paths of all files to exfiltrate and had features for input capture and screen capture.",
        "Command and Control": "The downloaders and backdoors communicated with the C&C server using commonly used ports 80 or 443. Data sent were hex-encoded and encrypted with AES or a custom algorithm. A fallback C&C server was embedded in the configuration.",
        "Exfiltration": "Data were automatically prepared with all file paths to retrieve and sent to the C&C server. The data were hex-encoded and encrypted with a known algorithm or a custom one."
    },
    "technique_label": true
}