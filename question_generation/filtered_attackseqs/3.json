{
    "triplets": [
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "spear phishing",
            "ObjectType": "Email Message",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 1
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "deliver",
            "Object": "Android malware",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 2
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "establish",
            "Object": "Microsoft Authenticator application",
            "ObjectType": "software",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 3
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "lightweight malware",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 4
        },
        {
            "Subject": "lightweight malware",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "PowerShell or C# content",
            "ObjectType": "software",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 5
        },
        {
            "Subject": "lightweight malware",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C2 nodes",
            "ObjectType": "infrastructure",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 6
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "custom malware",
            "ObjectType": "Malware",
            "tactic": "Persistence",
            "technique": [
                "T1053-Scheduled Task/Job"
            ],
            "id": 7
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "scheduled tasks",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution",
                "T1053-Scheduled Task/Job"
            ],
            "id": 8
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Windows registry modifications",
            "ObjectType": "Technique",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 9
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "maintain access to",
            "Object": "victim's personal or corporate email account",
            "ObjectType": "Email Message",
            "tactic": "Persistence",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 10
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "register",
            "Object": "Microsoft Authenticator application",
            "ObjectType": "tool",
            "tactic": "Persistence",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 11
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "receive",
            "Object": "MFA codes",
            "ObjectType": "artifacts",
            "tactic": "Persistence",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 12
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "delete",
            "Object": "login notification emails",
            "ObjectType": "Email Message",
            "tactic": "Persistence",
            "technique": [
                "T1098-Account Manipulation"
            ],
            "id": 13
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "obfuscating files or information",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information"
            ],
            "id": 14
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "process injection",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1055-Process Injection"
            ],
            "id": 15
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "virtualization/sandbox evasion",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1497-Virtualization/Sandbox Evasion"
            ],
            "id": 16
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "template injection",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1221-Template Injection"
            ],
            "id": 17
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "hide",
            "Object": "artifacts like hidden windows",
            "ObjectType": "artifacts",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts"
            ],
            "id": 18
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "conduct",
            "Object": "internal reconnaissance",
            "ObjectType": "attack-pattern",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 19
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "malware",
            "ObjectType": "Malware",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 20
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "capable of",
            "Object": "taking screenshots",
            "ObjectType": "attack-pattern",
            "tactic": "Discovery",
            "technique": [
                "T1057-Process Discovery"
            ],
            "id": 21
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "system and network information",
            "ObjectType": "attack-pattern",
            "tactic": "Discovery",
            "technique": [
                "T1049-System Network Connections Discovery"
            ],
            "id": 22
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "steal",
            "Object": "credentials",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 23
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "credentials",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 24
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "conduct",
            "Object": "follow-on operations",
            "ObjectType": "campaign",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 25
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "steal",
            "Object": "personal or business documents",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 26
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "seek to track",
            "Object": "locations",
            "ObjectType": "Location",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 27
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "monitor",
            "Object": "communications",
            "ObjectType": "network traffic",
            "tactic": "Collection",
            "technique": [
                "Others"
            ],
            "id": 28
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "surveil",
            "Object": "activities",
            "ObjectType": "campaign",
            "tactic": "Collection",
            "technique": [
                "T1557-Adversary-in-the-Middle"
            ],
            "id": 29
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "individuals of interest",
            "ObjectType": "identity",
            "tactic": "Collection",
            "technique": [
                "T1557-Adversary-in-the-Middle"
            ],
            "id": 30
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "application layer protocols",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 31
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "web services",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1102-Web Service"
            ],
            "id": 32
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "encrypted channels",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel",
                "T1102-Web Service"
            ],
            "id": 33
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "C2 channels",
            "ObjectType": "network traffic",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 34
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "recorded phone calls",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 35
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "room audio recordings",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 36
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "images",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 37
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "entire SMS inboxes",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 38
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "custom malware",
            "ObjectType": "Malware",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 39
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "capable-of",
            "Object": "logging keystrokes",
            "ObjectType": "attack-pattern",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 40
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "steal",
            "Object": "logins",
            "ObjectType": "artifact",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 41
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "steal",
            "Object": "cookie data",
            "ObjectType": "artifact",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 42
        },
        {
            "Subject": "custom malware",
            "SubjectType": "Malware",
            "Relation": "perform",
            "Object": "privilege escalation",
            "ObjectType": "attack-pattern",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 43
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "OS credential dumping",
            "ObjectType": "technique",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 44
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "two-factor authentication interception",
            "ObjectType": "technique",
            "tactic": "Credential Access",
            "technique": [
                "T1111-Multi-Factor Authentication Interception"
            ],
            "id": 45
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "keylogging",
            "ObjectType": "technique",
            "tactic": "Credential Access",
            "technique": [
                "T1056-Input Capture"
            ],
            "id": 46
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "compromised personal email accounts",
            "ObjectType": "email-address",
            "tactic": "Lateral Movement",
            "technique": [
                "T1534-Internal Spearphishing"
            ],
            "id": 47
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "access",
            "Object": "corporate accounts",
            "ObjectType": "email-address",
            "tactic": "Lateral Movement",
            "technique": [
                "T1534-Internal Spearphishing"
            ],
            "id": 48
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "send",
            "Object": "spear-phishing emails",
            "ObjectType": "Email Message",
            "tactic": "Lateral Movement",
            "technique": [
                "T1534-Internal Spearphishing"
            ],
            "id": 49
        },
        {
            "Subject": "compromised accounts",
            "SubjectType": "email-address",
            "Relation": "leverage",
            "Object": "victim's trusted relationships",
            "ObjectType": "identity",
            "tactic": "Lateral Movement",
            "technique": [
                "T1534-Internal Spearphishing"
            ],
            "id": 50
        },
        {
            "Subject": "Mandiant",
            "SubjectType": "CTI vender",
            "Relation": "attribute-to",
            "Object": "APT42",
            "ObjectType": "threat-actor",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 51
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "spear phishing",
            "ObjectType": "attack-pattern",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 52
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "mobile malware",
            "ObjectType": "Malware",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 53
        },
        {
            "Subject": "mobile malware",
            "SubjectType": "Malware",
            "Relation": "track",
            "Object": "victim locations",
            "ObjectType": "Location",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 54
        },
        {
            "Subject": "mobile malware",
            "SubjectType": "Malware",
            "Relation": "record",
            "Object": "phone conversations",
            "ObjectType": "artifact",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 55
        },
        {
            "Subject": "mobile malware",
            "SubjectType": "Malware",
            "Relation": "extract",
            "Object": "SMS inboxes",
            "ObjectType": "artifact",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 56
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "carry out",
            "Object": "espionage and surveillance activity",
            "ObjectType": "campaign",
            "tactic": "Resource Development",
            "technique": [
                "Others"
            ],
            "id": 57
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "social engineering",
            "ObjectType": "technique",
            "tactic": "Resource Development",
            "technique": [
                "T1586-Compromise Accounts"
            ],
            "id": 58
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "collect",
            "Object": "Multi-Factor Authentication codes",
            "ObjectType": "artifacts",
            "tactic": "Resource Development",
            "technique": [
                "T1586-Compromise Accounts"
            ],
            "id": 59
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "develop",
            "Object": "custom backdoors",
            "ObjectType": "tool",
            "tactic": "Resource Development",
            "technique": [
                "T1587-Develop Capabilities"
            ],
            "id": 60
        },
        {
            "Subject": "APT42",
            "SubjectType": "threat-actor",
            "Relation": "develop",
            "Object": "lightweight tools",
            "ObjectType": "tool",
            "tactic": "Resource Development",
            "technique": [
                "T1587-Develop Capabilities"
            ],
            "id": 61
        }
    ],
    "file_name": "APT42_Crooked_Charms_Cons_and_Compromises",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "Mandiant has high confidence that APT42, an Iranian state-sponsored cyber espionage group, has been active since at least 2015, engaging in highly targeted spear phishing and surveillance operations. APT42's operations are designed to build trust and rapport with victims, including government officials, former Iranian policymakers, members of the Iranian diaspora and opposition groups, journalists, and academics. The group deploys mobile malware to track victim locations, record phone conversations, and extract SMS inboxes.",
        "Resource Development": "APT42, assessed to be a prolific and well-resourced threat actor, carries out espionage and surveillance activity in support of Iran's strategic priorities. The group uses highly targeted social engineering efforts for credential harvesting, including collecting Multi-Factor Authentication (MFA) codes to bypass authentication methods. APT42 has also developed custom backdoors and lightweight tools to complement its arsenal, indicating the group's capability to incorporate these tools into their operations beyond credential harvesting.",
        "Initial Access": "APT42 primarily relies on spear phishing to perform initial compromises, engaging targets for days or weeks to build trust before providing a link to a credential harvesting page or attaching a malicious attachment. The group is capable of bypassing MFA and intercepting SMS-based one-time passwords using credential harvesting forms and likely delivers Android malware via SMS messages.",
        "Execution": "APT42 establishes a foothold in victim environments by registering their own Microsoft Authenticator application as a new MFA method. The group uses a variety of primarily lightweight malware, some of which are based on publicly available scripts, to execute arbitrary PowerShell or C# content and communicate with C2 nodes via HTTP.",
        "Persistence": "To maintain their presence in a victim's environment, APT42 relies on custom malware using scheduled tasks or Windows registry modifications for persistence. They also maintain access to a victim's personal or corporate email account by registering their Microsoft Authenticator application to receive MFA codes to their own devices and deleting login notification emails to cover their tracks.",
        "Privilege Escalation": "APT42 uses custom malware capable of logging keystrokes and stealing logins and cookie data for common browsers to perform privilege escalation in a victim environment.",
        "Defense Evasion": "APT42 employs various techniques to avoid detection, such as obfuscating files or information, process injection, and virtualization/sandbox evasion. They also use template injection and hide artifacts like hidden windows to evade defenses.",
        "Credential Access": "APT42's operations include stealing credentials to personal and corporate email accounts using methods such as OS credential dumping, two-factor authentication interception, and keylogging.",
        "Discovery": "APT42 conducts internal reconnaissance by browsing the compromised user's contacts and accessing the targeted organization's collaborative spaces, such as Sharepoint. They also use malware capable of taking screenshots and collecting system and network information.",
        "Lateral Movement": "APT42 moves laterally by using compromised personal email accounts to access corporate accounts and vice versa. They send spear-phishing emails from compromised accounts to additional targets, leveraging the victim's trusted relationships.",
        "Collection": "APT42's objective includes stealing credentials and using them to conduct follow-on operations and steal personal or business documents. They also seek to track locations, monitor communications, and surveil activities of individuals of interest to the Iranian government.",
        "Command and Control": "APT42 uses application layer protocols, web services, and encrypted channels for command and control communications with compromised systems.",
        "Exfiltration": "APT42 exfiltrates data over C2 channels, including recorded phone calls, room audio recordings, images, and entire SMS inboxes from compromised devices."
    },
    "technique_label": true
}