{
    "triplets": [
        {
            "Subject": "The campaign",
            "SubjectType": "campaign",
            "Relation": "utilize",
            "Object": "watering hole tactics",
            "ObjectType": "Tactic",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 1
        },
        {
            "Subject": "The attackers",
            "SubjectType": "threat-actor",
            "Relation": "inject",
            "Object": "exploits for CVE-2020-0674 and CVE-2019-5782",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 2
        },
        {
            "Subject": "The attackers",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "international associations",
            "ObjectType": "identity",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 3
        },
        {
            "Subject": "Chrome exploit",
            "SubjectType": "vulnerablity",
            "Relation": "exploit",
            "Object": "CVE-2019-5782",
            "ObjectType": "vulnerablity",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 4
        },
        {
            "Subject": "Chrome exploit",
            "SubjectType": "vulnerablity",
            "Relation": "exploit",
            "Object": "unnamed Chrome bug",
            "ObjectType": "vulnerablity",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 5
        },
        {
            "Subject": "shellcode",
            "SubjectType": "tool",
            "Relation": "download",
            "Object": "dropper.dll",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 6
        },
        {
            "Subject": "dropper.dll",
            "SubjectType": "file",
            "Relation": "download",
            "Object": "three additional malware samples",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 7
        },
        {
            "Subject": "Internet Explorer exploit",
            "SubjectType": "vulnerablity",
            "Relation": "exploit",
            "Object": "CVE-2020-0674",
            "ObjectType": "vulnerablity",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 8
        },
        {
            "Subject": "PowerShell loader",
            "SubjectType": "tool",
            "Relation": "infect",
            "Object": "victims",
            "ObjectType": "identity",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution",
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 9
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "implement",
            "Object": "checks for security software",
            "ObjectType": "course-of-action",
            "tactic": "Defense Evasion",
            "technique": [
                "T1497-Virtualization/Sandbox Evasion"
            ],
            "id": 10
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "abort",
            "Object": "execution",
            "ObjectType": "process",
            "tactic": "Defense Evasion",
            "technique": [
                "T1497-Virtualization/Sandbox Evasion"
            ],
            "id": 11
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "unprotected systems",
            "ObjectType": "infrastrcucture",
            "tactic": "Defense Evasion",
            "technique": [
                "T1497-Virtualization/Sandbox Evasion"
            ],
            "id": 12
        },
        {
            "Subject": "The SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "a Mattermost server",
            "ObjectType": "infrastrcucture",
            "tactic": "Command and Control",
            "technique": [
                "T1102-Web Service"
            ],
            "id": 13
        },
        {
            "Subject": "The SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "individual channels for each infected machine",
            "ObjectType": "infrastrcucture",
            "tactic": "Command and Control",
            "technique": [
                "T1102-Web Service"
            ],
            "id": 14
        },
        {
            "Subject": "The SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "a notification channel",
            "ObjectType": "infrastrcucture",
            "tactic": "Command and Control",
            "technique": [
                "T1102-Web Service"
            ],
            "id": 15
        },
        {
            "Subject": "SLUB variant",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Mattermost server",
            "ObjectType": "infrastrcucture",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 16
        },
        {
            "Subject": "SLUB variant",
            "SubjectType": "Malware",
            "Relation": "interact with",
            "Object": "Mattermost server",
            "ObjectType": "infrastrcucture",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 17
        },
        {
            "Subject": "SLUB variant",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "commands",
            "ObjectType": "artifact",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 18
        },
        {
            "Subject": "commands",
            "SubjectType": "artifact",
            "Relation": "exfiltrate",
            "Object": "system information",
            "ObjectType": "artifact",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ],
            "id": 19
        },
        {
            "Subject": "commands",
            "SubjectType": "artifact",
            "Relation": "capture",
            "Object": "screenshots",
            "ObjectType": "artifact",
            "tactic": "Discovery",
            "technique": [
                "T1113-Screen Capture"
            ],
            "id": 20
        },
        {
            "Subject": "screenshots",
            "SubjectType": "artifact",
            "Relation": "send back to",
            "Object": "attacker-controlled Mattermost server",
            "ObjectType": "infrastrcucture",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 21
        },
        {
            "Subject": "SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "exfiltrate",
            "Object": "system information",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 22
        },
        {
            "Subject": "SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "commands",
            "ObjectType": "attack-pattern",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 23
        },
        {
            "Subject": "SLUB malware variant",
            "SubjectType": "Malware",
            "Relation": "capture",
            "Object": "screenshots",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 24
        },
        {
            "Subject": "PowerShell loader",
            "SubjectType": "tool",
            "Relation": "use",
            "Object": "Internet Explorer",
            "ObjectType": "software",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 25
        },
        {
            "Subject": "PowerShell loader",
            "SubjectType": "tool",
            "Relation": "instruct",
            "Object": "download and execution",
            "ObjectType": "action",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 26
        },
        {
            "Subject": "LPE binary",
            "SubjectType": "tool",
            "Relation": "exploit",
            "Object": "CVE-2019-1458",
            "ObjectType": "vulnerability",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 27
        },
        {
            "Subject": "backdoors",
            "SubjectType": "tool",
            "Relation": "execute with",
            "Object": "system privileges",
            "ObjectType": "privilege",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1548-Abuse Elevation Control Mechanism"
            ],
            "id": 28
        }
    ],
    "file_name": "2020.10.19_-_Operation_Earth_Kitsune_-_Tracking_SLUBs_current_operations",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The campaign, dubbed Operation Earth Kitsune, utilized watering hole tactics to compromise websites related to North Korea, targeting international associations. The attackers injected exploits for CVE-2020-0674 and CVE-2019-5782 into these websites to facilitate the delivery of malware. The campaign specifically avoided South Korean IP addresses, indicating a focus on the global Korean diaspora.",
        "Execution": "The Chrome exploit vector involved chaining two patched vulnerabilities, CVE-2019-5782 and an unnamed Chrome bug, to execute custom shellcode. This shellcode de-obfuscated strings, initialized a network connection, and downloaded a payload named 'dropper.dll' from a C&C server. The dropper.dll then checked for security software presence and, if none were detected, downloaded and executed three additional malware samples. An Internet Explorer exploit vector using CVE-2020-0674 was also employed, which ran a PowerShell loader to infect victims with the same three malware variants.",
        "Privilege Escalation": "The PowerShell loader used in the Internet Explorer exploit vector could instruct the download and execution of an LPE binary exploiting CVE-2019-1458, potentially allowing the backdoors to execute with system privileges.",
        "Defense Evasion": "The attackers implemented checks for security software during malware deployment to avoid detection. If any security software from a predefined list was detected, the malware would abort execution. This indicates an effort to target unprotected systems and remain stealthy.",
        "Discovery": "The SLUB variant used in the campaign interacted with a Mattermost server to collect information about the infected machines. It executed a series of commands to exfiltrate system information and captured screenshots, which were then sent back to the attacker-controlled Mattermost server.",
        "Command and Control": "The SLUB malware variant communicated with a Mattermost server using HTTP on port 443. It created individual channels for each infected machine and used a notification channel for real-time updates on new infections. The Mattermost server hosted multiple channels and users, indicating an organized campaign with different attack vectors.",
        "Exfiltration": "The SLUB malware variant exfiltrated a significant amount of system information from infected machines to the Mattermost server. This included executing commands to gather system details and capturing screenshots.",
        "Others": "The campaign used GNUBOARD CMS on compromised websites, which had known RCE vulnerabilities. The attackers set up their own Mattermost server, which provided them control over the infrastructure and avoided the risk of having their operations disrupted by third-party services. The Mattermost server installation date of March 10, 2020, suggests the start of the 'mm' (SLUB) samples' activity. The campaign used multiple C&C servers, seven samples, and exploits for four N-day bugs, indicating a well-resourced and capable group behind the operation."
    },
    "technique_label": true
}