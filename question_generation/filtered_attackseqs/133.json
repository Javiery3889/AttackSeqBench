{
    "triplets": [
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "RATs",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 1
        },
        {
            "Subject": "Users",
            "SubjectType": "identity",
            "Relation": "trick into",
            "Object": "opening email attachments",
            "ObjectType": "Email Message",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 2
        },
        {
            "Subject": "Users",
            "SubjectType": "identity",
            "Relation": "trick into",
            "Object": "downloading files",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing"
            ],
            "id": 3
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "develop",
            "Object": "sophisticated technique",
            "ObjectType": "Tactic",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 4
        },
        {
            "Subject": "RATs",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "entirely in memory",
            "ObjectType": "Technique",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 5
        },
        {
            "Subject": "SentinelOne EPP",
            "SubjectType": "CTI vender",
            "Relation": "confirm",
            "Object": "behavior-based detection mechanisms",
            "ObjectType": "course-of-action",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 6
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "create",
            "Object": "registry key",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 7
        },
        {
            "Subject": "PerfWatson.exe",
            "SubjectType": "file",
            "Relation": "execute",
            "Object": "nvSCPAPISrv.exe",
            "ObjectType": "file",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 8
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "RAT payload",
            "ObjectType": "Malware",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts",
                "T1497-Virtualization/Sandbox Evasion",
                "T1055-Process Injection"
            ],
            "id": 9
        },
        {
            "Subject": "RAT payload",
            "SubjectType": "Malware",
            "Relation": "remain in",
            "Object": "memory",
            "ObjectType": "infrastrcucture",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ],
            "id": 10
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "detect",
            "Object": "virtual machine",
            "ObjectType": "infrastrcucture",
            "tactic": "Defense Evasion",
            "technique": [
                "T1497-Virtualization/Sandbox Evasion"
            ],
            "id": 11
        },
        {
            "Subject": "NanoCore RAT",
            "SubjectType": "Malware",
            "Relation": "inject into",
            "Object": "new process",
            "ObjectType": "process",
            "tactic": "Defense Evasion",
            "technique": [
                "T1055-Process Injection"
            ],
            "id": 12
        },
        {
            "Subject": "The RAT",
            "SubjectType": "Malware",
            "Relation": "connect back to",
            "Object": "its control server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1568-Dynamic Resolution"
            ],
            "id": 13
        },
        {
            "Subject": "its control server",
            "SubjectType": "infrastructure",
            "Relation": "associated with",
            "Object": "chickenkiller.com",
            "ObjectType": "domain",
            "tactic": "Command and Control",
            "technique": [
                "T1568-Dynamic Resolution"
            ],
            "id": 14
        },
        {
            "Subject": "chickenkiller.com",
            "SubjectType": "domain",
            "Relation": "owned by",
            "Object": "a free dynamic DNS service",
            "ObjectType": "identity",
            "tactic": "Command and Control",
            "technique": [
                "T1568-Dynamic Resolution"
            ],
            "id": 15
        }
    ],
    "file_name": "teaching-an-old-rat-new-tricks",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "Attackers have traditionally deployed RATs (Remote Access Trojans) by tricking users into opening email attachments or downloading files from websites or peer-to-peer networks. These methods involve file-based vectors that are easier to detect.",
        "Execution": "The attackers have developed a sophisticated technique to execute RATs entirely in memory, avoiding disk interaction in a decrypted state, which helps them evade antivirus and 'next-generation' technologies focused on file-based threats. SentinelOne EPP has confirmed that this technique does not evade its behavior-based detection mechanisms, as it monitors all processes at the user-space/kernel-space interface.",
        "Persistence": "For persistence, the attackers create a registry key at HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\NT\\CurrentVersion\\Windows\\Load pointing to the PerfWatson.exe binary, which is executed along with a copied binary named nvSCPAPISrv.exe located at %APPDATA%\\Microsoft\\Blend\\14.0\\FeedCache\\.",
        "Defense Evasion": "The attackers use a technique that ensures the RAT payload remains in memory throughout its execution, never touching the disk in a decrypted state, to evade detection by antivirus technologies. They also have the capability to detect the presence of a virtual machine to avoid analysis in a network sandbox. The NanoCore RAT payload is injected into a new process without being written to disk.",
        "Command and Control": "The RAT attempts to connect back to its control server, which is associated with the domain chickenkiller.com, owned by a free dynamic DNS service. At the time of writing, the DNS records exist, but the address they resolve to appears to be down.",
        "Others": "The main sample analyzed is a 32-bit executable with various hashes provided. The unpacked samples include a packed 'Benchmark' DLL, a monitor named PerfWatson.exe, and the NanoCore RAT dumped from memory. The 'Benchmark' .NET DLL is XOR encrypted and contains logic to unpack and inject the RAT, as well as monitor the application. The settings and NanoCore executable are serialized, DES encrypted, and stored across multiple PNG files as pixel data. A C# decompilation method is used to extract information from the pixel data. SentinelOne provides resources on how to protect against such attacks."
    },
    "technique_label": true
}