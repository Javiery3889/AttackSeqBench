{
    "triplets": [
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "gain access to",
            "Object": "networks",
            "ObjectType": "infrastructure",
            "tactic": "Initial Access",
            "technique": [
                "T1078-Valid Accounts"
            ],
            "id": 1
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "stolen valid user credentials",
            "ObjectType": "artifacts",
            "tactic": "Initial Access",
            "technique": [
                "T1078-Valid Accounts"
            ],
            "id": 2
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "Trochilus malware",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 3
        },
        {
            "Subject": "Trochilus malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "RC4",
            "ObjectType": "encryption-algorithm",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 4
        },
        {
            "Subject": "Trochilus malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Salsa20",
            "ObjectType": "encryption-algorithm",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 5
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "UPPERCUT (ANEL) backdoor",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 6
        },
        {
            "Subject": "UPPERCUT (ANEL) backdoor",
            "SubjectType": "Malware",
            "Relation": "be attributed to",
            "Object": "APT10",
            "ObjectType": "threat-actor",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 7
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "DLL sideloading",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 8
        },
        {
            "Subject": "legitimate binary",
            "SubjectType": "file",
            "Relation": "load",
            "Object": "malicious DLL",
            "ObjectType": "file",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 9
        },
        {
            "Subject": "malicious DLL",
            "SubjectType": "file",
            "Relation": "inject",
            "Object": "Trochilus payload",
            "ObjectType": "Malware",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 10
        },
        {
            "Subject": "Trochilus malware",
            "SubjectType": "Malware",
            "Relation": "encrypt",
            "Object": "RC4",
            "ObjectType": "encryption-algorithm",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 11
        },
        {
            "Subject": "Trochilus malware",
            "SubjectType": "Malware",
            "Relation": "encrypt",
            "Object": "Salsa20",
            "ObjectType": "encryption-algorithm",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 12
        },
        {
            "Subject": "C2 communications",
            "SubjectType": "network trafic",
            "Relation": "use",
            "Object": "www.miphomanager[.]com",
            "ObjectType": "domain-name",
            "tactic": "Command and Control",
            "technique": [
                "Others"
            ],
            "id": 13
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "conduct",
            "Object": "privilege escalation",
            "ObjectType": "attack-pattern",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 14
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "DLL sideloading techniques",
            "ObjectType": "Technique",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 15
        },
        {
            "Subject": "DLL sideloading techniques",
            "SubjectType": "Technique",
            "Relation": "deliver",
            "Object": "malware",
            "ObjectType": "Malware",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ],
            "id": 16
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "compress",
            "Object": "proprietary data",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1560-Archive Collected Data",
                "T1530-Data from Cloud Storage"
            ],
            "id": 17
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate",
            "Object": "proprietary data",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1560-Archive Collected Data",
                "T1530-Data from Cloud Storage"
            ],
            "id": 18
        },
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "employ",
            "Object": "custom malware",
            "ObjectType": "Malware",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 19
        },
        {
            "Subject": "Custom malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Dropbox",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 20
        },
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "WinRAR",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 21
        },
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "cURL for Windows",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 22
        },
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "compress",
            "Object": "exfiltrated files",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 23
        },
        {
            "Subject": "Attackers",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "exfiltrated files",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 24
        },
        {
            "Subject": "Exfiltrated files",
            "SubjectType": "artifacts",
            "Relation": "originate-from",
            "Object": "Visma network",
            "ObjectType": "infrastrcucture",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 25
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Mimikatz",
            "ObjectType": "tool",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 26
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "enable",
            "Object": "credential theft",
            "ObjectType": "attack-pattern",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 27
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "access",
            "Object": "Visma's Microsoft Active Directory domain controller",
            "ObjectType": "infrastrcucture",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 28
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "Trochilus",
            "ObjectType": "Malware",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 29
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "copy",
            "Object": "NTDS.DIT database file",
            "ObjectType": "file",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 30
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "logged in to",
            "Object": "Visma network",
            "ObjectType": "infrastrcucture",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ],
            "id": 31
        },
        {
            "Subject": "APT10",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "valid user accounts",
            "ObjectType": "user-account",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ],
            "id": 32
        },
        {
            "Subject": "logins",
            "SubjectType": "network trafic",
            "Relation": "originate-from",
            "Object": "GMT+8 timezone",
            "ObjectType": "Location",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ],
            "id": 33
        },
        {
            "Subject": "GMT+8 timezone",
            "SubjectType": "Location",
            "Relation": "indicative of",
            "Object": "Tianjin, China working hours",
            "ObjectType": "Location",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ],
            "id": 34
        }
    ],
    "file_name": "APT10 Targeted Norwegian MSP and US Companies in Sustained Campaign",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The attackers gained access to networks through deployments of Citrix and LogMeIn remote-access software using stolen valid user credentials.",
        "Execution": "APT10 deployed Trochilus malware with command and control (C2) communications encrypted using both RC4 and Salsa20 streaming ciphers. They also deployed a unique version of the UPPERCUT (ANEL) backdoor, known to have only been used by APT10.",
        "Privilege Escalation": "The attackers conducted privilege escalation on the victim networks, utilizing DLL sideloading techniques to deliver malware.",
        "Defense Evasion": "APT10 utilized DLL sideloading by executing a legitimate binary to load a renamed malicious DLL that decrypts, decompresses, and injects a Trochilus payload into memory.",
        "Credential Access": "The attackers used Mimikatz to enable credential theft and accessed Visma's Microsoft Active Directory domain controller, deploying Trochilus and copying the NTDS.DIT database file containing password hashes for all users in the domain.",
        "Lateral Movement": "APT10 regularly logged in to the Visma network via accessible Citrix servers using two valid user accounts. The times of the logins were consistent with a GMT+8 timezone, indicative of typical Tianjin, China working hours.",
        "Collection": "APT10 compressed proprietary data from Visma using WinRAR and exfiltrated to a Dropbox account using the cURL for Windows command-line tool.",
        "Command and Control": "The Trochilus malware C2 communications were encrypted using a combination of RC4 and Salsa20 stream ciphers. The C2 domain www.miphomanager[.]com was used for communication.",
        "Exfiltration": "The attackers employed custom malware that used Dropbox as its C2 and used WinRAR and cURL for Windows to compress and upload the exfiltrated files from the Visma network to the Dropbox API."
    },
    "technique_label": true
}