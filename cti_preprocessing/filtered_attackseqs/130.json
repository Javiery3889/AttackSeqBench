{
    "triplets": [
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "DLL loader",
            "ObjectType": "tool",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 1
        },
        {
            "Subject": "BRONZE ATLAS",
            "SubjectType": "threat-actor",
            "Relation": "deploy",
            "Object": "ShadowPad",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 2
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "beacon-to",
            "Object": "legitimate executable",
            "ObjectType": "software",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 3
        },
        {
            "Subject": "BRONZE UNIVERSITY",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "ShadowPad execution chains",
            "ObjectType": "technique",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 4
        },
        {
            "Subject": "BRONZE UNIVERSITY",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "transportation",
            "ObjectType": "sector",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 5
        },
        {
            "Subject": "BRONZE UNIVERSITY",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "natural resource",
            "ObjectType": "sector",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 6
        },
        {
            "Subject": "BRONZE UNIVERSITY",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "energy",
            "ObjectType": "sector",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 7
        },
        {
            "Subject": "BRONZE UNIVERSITY",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "non-governmental organizations",
            "ObjectType": "sector",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ],
            "id": 8
        },
        {
            "Subject": "ShadowPad samples",
            "SubjectType": "Malware",
            "Relation": "share",
            "Object": "behavioral similarities",
            "ObjectType": "Tactic",
            "tactic": "Command and Control",
            "technique": [
                "Others"
            ],
            "id": 9
        },
        {
            "Subject": "ShadowPad payload",
            "SubjectType": "Malware",
            "Relation": "inject-into",
            "Object": "target process",
            "ObjectType": "process",
            "tactic": "Command and Control",
            "technique": [
                "T1659-Content Injection"
            ],
            "id": 10
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "establish",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Command and Control",
            "technique": [
                "Others"
            ],
            "id": 11
        },
        {
            "Subject": "ShadowPad sample",
            "SubjectType": "Malware",
            "Relation": "reveal",
            "Object": "C2 details",
            "ObjectType": "artifacts",
            "tactic": "Command and Control",
            "technique": [
                "T1105-Ingress Tool Transfer"
            ],
            "id": 12
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "decrypt",
            "Object": "in memory",
            "ObjectType": "technique",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ],
            "id": 13
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "extract",
            "Object": "host information",
            "ObjectType": "artifacts",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 14
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "deploy",
            "Object": "new modules",
            "ObjectType": "software",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ],
            "id": 15
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "copy",
            "Object": "legitimate binary and sideloaded DLL",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ],
            "id": 16
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "save",
            "Object": "encrypted payload",
            "ObjectType": "artifacts",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 17
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "launch",
            "Object": "legitimate executable",
            "ObjectType": "software",
            "tactic": "Execution",
            "technique": [
                "T1569-System Services"
            ],
            "id": 18
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "inject",
            "Object": "payload",
            "ObjectType": "artifacts",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ],
            "id": 19
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "establish",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 20
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "service",
            "ObjectType": "process",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 21
        },
        {
            "Subject": "ShadowPad",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "registry Run key",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 22
        },
        {
            "Subject": "ShadowPad samples",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "TSVIPSrv.DLL",
            "ObjectType": "filename",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 23
        },
        {
            "Subject": "TSVIPSrv.DLL",
            "SubjectType": "filename",
            "Relation": "located-at",
            "Object": "Windows System32 directory",
            "ObjectType": "directory",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 24
        },
        {
            "Subject": "Windows SessionEnv Service",
            "SubjectType": "software",
            "Relation": "vulnerable-to",
            "Object": "DLL hijacking",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 25
        },
        {
            "Subject": "BRONZE ATLAS",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "TSVIPSrv.DLL",
            "ObjectType": "filename",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 26
        },
        {
            "Subject": "BRONZE ATLAS",
            "SubjectType": "threat-actor",
            "Relation": "load",
            "Object": "Cobalt Strike",
            "ObjectType": "Malware",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow"
            ],
            "id": 27
        },
        {
            "Subject": "ShadowPad DLL loader",
            "SubjectType": "Malware",
            "Relation": "padded-to",
            "Object": "over 50MB",
            "ObjectType": "artifact",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts"
            ],
            "id": 28
        }
    ],
    "file_name": "ShadowPad Malware Analysis _ Secureworks",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The ShadowPad advanced modular remote access trojan (RAT) has been deployed by the Chinese government-sponsored BRONZE ATLAS threat group since at least 2017. Secureworks Counter Threat Unit (CTU) researchers discovered that ShadowPad payloads are deployed to a host either encrypted within a DLL loader or within a separate file alongside a DLL loader. These DLL loaders decrypt and execute ShadowPad in memory after being sideloaded by a legitimate executable vulnerable to DLL search order hijacking. The majority of ShadowPad samples analyzed were two-file execution chains: an encrypted ShadowPad payload embedded in a DLL loader. ShadowPad DLL loaders are sideloaded by a legitimate executable vulnerable to DLL search order hijacking. The DLL loader then decrypts and executes the embedded ShadowPad payload in memory using a custom decryption algorithm specific to the malware version. CTU researchers identified ShadowPad execution chains involving a third file that contains the encrypted ShadowPad payload. These chains execute the legitimate executable (usually renamed), sideload the ShadowPad DLL loader, and load and decrypt the third file. CTU researchers observed threat actors using BDReinit.exe or Oleview.exe as initial files in the three-file ShadowPad execution chain. The third file in the BDReinit.exe execution chain is log.dll.dat; in the Oleview.exe execution chain, it is iviewers.dll.dat. CTU researchers have attributed campaigns using these execution chains to the Chinese BRONZE UNIVERSITY threat group, which has targeted transportation, natural resource, energy, and non-governmental organizations. Third-party researchers have also identified three-file ShadowPad execution chains that begin with consent.exe (followed by secur32.dll and secur32.dll.dat) and AppLaunch.exe (followed by mscoree.dll and mscoree.dll.dat). Additionally, CTU analysis revealed a sample that used AppLaunch.exe followed by mscoree.dll and mscoree.dll.mui.",
        "Execution": "ShadowPad is decrypted in memory using a custom decryption algorithm. CTU researchers have identified multiple ShadowPad versions based on these distinct algorithms. ShadowPad extracts information about the host, executes commands, interacts with the file system and registry, and deploys new modules to extend functionality. As part of the execution chain, ShadowPad copies the legitimate binary and sideloaded DLL to a subdirectory specific to each sample. Most analyzed samples were copied to a subdirectory under C:\\ProgramData, C:\\Users\\<username>\\Roaming, or C:\\Program Files. In three-file execution chains, the third file (e.g., log.dll.dat, iviewers.dll.dat) is typically deleted and the ShadowPad DLL loader is padded to over 50MB, likely to evade antivirus software. As part of this process, an encrypted payload is usually saved to a registry key under HKLM\\SOFTWARE\\Classes\\CLSID\\{GUID}\\<eight-character hexadecimal string>. After the initial setup the legitimate executable is launched as a Windows service. This service initiates the ShadowPad execution chain. The ShadowPad payload is injected into a child process of the service process that is specified in the ShadowPad configuration information.",
        "Persistence": "ShadowPad establishes persistence on a compromised host specified in the configuration settings. Persistence is achieved via creation of a service and a registry Run key. The Windows service that launches the legitimate executable from the subdirectory initiates the ShadowPad execution chain, ensuring that the malware remains active even after system restarts or interruptions.",
        "Defense Evasion": "ShadowPad samples from 2018 deviated from the typical two-file execution chain. Those samples, which used the filename TSVIPSrv.DLL, are placed in the Windows System32 directory and are loaded by the Windows SessionEnv Service, which is vulnerable to DLL hijacking. CTU researchers observed BRONZE ATLAS using this technique in 2021 to load other payloads via this filename, including Cobalt Strike. In three-file execution chains, the third file is typically deleted and the ShadowPad DLL loader is padded to over 50MB, likely to evade antivirus software.",
        "Command and Control": "ShadowPad samples sharing behavioral similarities such as injecting the decrypted ShadowPad payload into a newly launched target process and establishing persistence on a compromised host specified in the configuration settings. Figure 1 lists configuration information for a ShadowPad sample that reveals command and control (C2) details, the process injection target, and persistence via creation of a service and a registry Run key.",
        "Others": "ShadowPad gained notoriety in 2017 after it was deployed in software supply chain attacks involving CCleaner, NetSarang, and ASUS Live Update utility. These campaigns were attributed to the BRONZE ATLAS threat group. A 2017 Microsoft complaint and U.S. Department of Justice (DOJ) indictments unsealed in 2020 provide additional information on ShadowPad's connection to BRONZE ATLAS. The Microsoft complaint alleges that BRONZE ATLAS (also known as Barium) deployed ShadowPad in 2017 to steal intellectual property and personally identifiable information (PII). At the time, the malware was used only by BRONZE ATLAS. The DOJ indictments allege that Chinese nationals working for the Chengdu 404 network security company deployed ShadowPad in a global campaign attributed to BRONZE ATLAS. A related DOJ indictment revealed that these Chinese nationals collaborated with another Chinese national known by the handle 'Rose' (sometimes known as Withered Rose and Wicked Rose), using similar tactics, techniques, and procedures (TTPs) and sharing malware. The indictment describes this individual as a sophisticated threat actor who committed computer intrusion offenses targeting high-technology organizations globally. Campaigns linked to Rose were tracked as Barium. A third-party report claimed that Rose likely co-developed malware with an associate named 'whg,' who has been linked to the development of the PlugX malware. PlugX is used by multiple Chinese threat groups. Third-party researchers also identified string and code overlap between PlugX and ShadowPad. This overlap suggests close links between the ShadowPad and PlugX developers. ShadowPad may have been developed by an individual or group affiliated with BRONZE ATLAS. One possibility is that Chengdu 404 originally developed ShadowPad, as the individuals named in the DOJ indictments were allegedly involved with developing malware used in their campaigns. It is likely that only BRONZE ATLAS used ShadowPad until approximately 2019. Most of the ShadowPad DLL loader samples can be clustered based on compile timestamps, C2 infrastructure, payload versions, DLL loader code overlap, and likely victimology. CTU researchers identified multiple ShadowPad clusters used in campaigns since 2019 and attributed these clusters to distinct threat groups. These groups include BRONZE ATLAS and BRONZE UNIVERSITY, whose targeting suggests affiliation with the MSS. A third-party report suggests that BRONZE UNIVERSITY (referred to in the report as EarthLusca) may be operating near to Chengdu in China after operational security mistakes revealed China-based infrastructure. Other ShadowPad clusters appear to reflect targeting aligned with PLA theater command areas of responsibility. In late 2015, PRC leader Xi Jinping announced widespread reforms to the PLA that included the establishment of the Strategic Support Force (PLASSF or SSF). This new branch focuses on modernizing the PLA's capabilities in strategic frontiers of space, cyberspace, and the electromagnetic domain. The impact on the PLA's cyber espionage mission has been extensive. Many organizations responsible for cyber espionage and signals intelligence (SIGINT) associated with the Third Department of the PLA's General Staff Department (commonly known as 3PLA) have been absorbed into the SSF Network Systems Department (NSD). The SSF NSD is also believed to be responsible for a broad range of information warfare capabilities beyond cyber espionage, coordinating electronic countermeasures as well as offensive and defensive cyber projects. As part of the modernization, the PLA replaced its seven military regions with five theater commands: Eastern, Southern, Western, Northern, and Central. These theater commands orchestrate ground, naval, air, and conventional missile forces for military operations in their geographic area of responsibility. While the exact area of responsibility for each theater command is ambiguous, they are broadly responsible for specific threats within their respective regions. Prior to the PLA reforms, each military region maintained at least one Technical Reconnaissance Bureau (TRB) to handle SIGINT and cyber espionage activities focused on the military region's area of responsibility. The TRBs were distinct from the former 3PLA units that were located across China, but they may have been tasked by the 3PLA. The relationship between the TRBs and the theater commands is unclear. The TRBs may have been consolidated under the SSF NSD alongside former 3PLA units. It is also possible that they continue to target countries in their area of responsibility but under the command and control of the SSF NSD. CTU researchers grouped distinct ShadowPad activity clusters by targeted geographic regions. Clusters align with the documented area of responsibility for three of the theater commands: Northern, Southern, and Western. CTU researchers attribute some of the ShadowPad activity to Chinese threat groups that have been publicly linked to specific PLA units located in the corresponding theater commands: Northern Theater Command: CTU researchers linked ShadowPad activity to BRONZE HUNTLEY and BRONZE BUTLER, which are reportedly located in the Northern Theater Command. These threat groups deployed ShadowPad against targets in South Korea, Russia, Japan, and Mongolia. These regions align with the Northern Theater Command's focus. In 2021, CTU researchers observed malware and infrastructure overlap between the two threat groups, suggesting close collaboration. Western Theater Command: Some ShadowPad activity primarily targeted countries neighboring China's western border, such as India and Afghanistan. CTU researchers clustered this activity based on attacker-controlled infrastructure, ShadowPad DLL loader variants such as ICEKILLER, and contextual information from third-party sources. Third-party researchers linked some of these campaigns to an individual working on behalf of the Western Theater Command. CTU analysis did not reveal sufficient evidence to corroborate these claims, but the locations and victimology are consistent with threat actors operating on behalf of the Western Theater Command. Southern Theater Command: CTU researchers identified activity that used a specific ShadowPad version to target organizations in the South China Sea region. BRONZE GENEVA is likely responsible for part of this activity based on overlap between the C2 infrastructure for the Nebulae malware family associated with BRONZE GENEVA and a ShadowPad sample analyzed by CTU researchers. This attribution of ShadowPad campaigns to theater commands is based on the submitter's location for ShadowPad malware samples uploaded to the VirusTotal analysis service (potentially indicating the victim's country), the C2 domain names that appear to reference specific regions (e.g., cloudvn. info suggests Vietnam targeting), contextual information regarding the activity and victimology, and the absence of evidence that ShadowPad samples with the same attributes were deployed in other regions. Evidence available as of this publication suggests that ShadowPad has been deployed by MSS-affiliated threat groups, as well as PLA-affiliated threat groups that operate on behalf of the regional theater commands. The malware was likely developed by threat actors affiliated with BRONZE ATLAS and then shared with MSS and PLA threat groups around 2019. Given the range of groups leveraging ShadowPad, all organizations that are likely targets for Chinese threat groups should monitor for TTPs associated with this malware. Organizations with operations in or connections to geographic regions covered by the regional theater commands should specifically monitor for known TTPs associated with threat groups likely affiliated with the relevant theater command."
    },
    "technique_label": true
}