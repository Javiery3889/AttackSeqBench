{
    "triplets": [
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "AntSword webshell",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 1
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "cURL",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 2
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "custom Mimikatz variant",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 3
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "compiled variants of Impacket's wmiexec and atexec tools",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 4
        },
        {
            "Subject": "The actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "custom Mimikatz variant",
            "ObjectType": "malware",
            "tactic": "Defense Evasion",
            "technique": [
                "T1055-Process Injection"
            ],
            "id": 5
        },
        {
            "Subject": "The actors",
            "SubjectType": "threat-actor",
            "Relation": "upload",
            "Object": "Dumpert tool",
            "ObjectType": "tool",
            "tactic": "Defense Evasion",
            "technique": [
                "T1055-Process Injection"
            ],
            "id": 6
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "AntSword webshell",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1219-Remote Access Software"
            ],
            "id": 7
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "AntSword Shell Manager",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1219-Remote Access Software"
            ],
            "id": 8
        },
        {
            "Subject": "unknown threat actors",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2019-0604",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 9
        },
        {
            "Subject": "unknown threat actors",
            "SubjectType": "threat-actor",
            "Relation": "install",
            "Object": "AntSword webshell",
            "ObjectType": "tool",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 10
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "commands",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 11
        },
        {
            "Subject": "commands",
            "SubjectType": "tool",
            "Relation": "discover",
            "Object": "user accounts",
            "ObjectType": "user-account",
            "tactic": "Discovery",
            "technique": [
                "T1087-Account Discovery"
            ],
            "id": 12
        },
        {
            "Subject": "commands",
            "SubjectType": "tool",
            "Relation": "discover",
            "Object": "files and folders",
            "ObjectType": "file",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ],
            "id": 13
        },
        {
            "Subject": "commands",
            "SubjectType": "tool",
            "Relation": "discover",
            "Object": "privileged groups",
            "ObjectType": "identity",
            "tactic": "Discovery",
            "technique": [
                "T1069-Permission Groups Discovery"
            ],
            "id": 14
        },
        {
            "Subject": "commands",
            "SubjectType": "tool",
            "Relation": "discover",
            "Object": "remote systems",
            "ObjectType": "infrastructure",
            "tactic": "Discovery",
            "technique": [
                "T1018-Remote System Discovery"
            ],
            "id": 15
        },
        {
            "Subject": "commands",
            "SubjectType": "tool",
            "Relation": "discover",
            "Object": "network configuration",
            "ObjectType": "network traffic",
            "tactic": "Discovery",
            "technique": [
                "T1016-System Network Configuration Discovery"
            ],
            "id": 16
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "webshells",
            "ObjectType": "tool",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services",
                "T1550-Use Alternate Authentication Material"
            ],
            "id": 17
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "move",
            "Object": "to other systems",
            "ObjectType": "infrastrcucture",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services",
                "T1550-Use Alternate Authentication Material"
            ],
            "id": 18
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "dump",
            "Object": "credentials",
            "ObjectType": "artifact",
            "tactic": "Lateral Movement",
            "technique": [
                "T1550-Use Alternate Authentication Material"
            ],
            "id": 19
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Mimikatz",
            "ObjectType": "tool",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services",
                "T1550-Use Alternate Authentication Material"
            ],
            "id": 20
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Impacket's atexec",
            "ObjectType": "tool",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services",
                "T1550-Use Alternate Authentication Material"
            ],
            "id": 21
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Mimikatz",
            "ObjectType": "tool",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 22
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "dump",
            "Object": "credentials",
            "ObjectType": "artifact",
            "tactic": "Credential Access",
            "technique": [
                "T1003-OS Credential Dumping"
            ],
            "id": 23
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "Impacket tools",
            "ObjectType": "tool",
            "tactic": "Credential Access",
            "technique": [
                "Others"
            ],
            "id": 24
        },
        {
            "Subject": "actors",
            "SubjectType": "threat-actor",
            "Relation": "run commands",
            "Object": "other systems",
            "ObjectType": "infrastructure",
            "tactic": "Credential Access",
            "technique": [
                "Others"
            ],
            "id": 25
        }
    ],
    "file_name": "Actors Still Exploiting SharePoint Vulnerability to Attack Middle East Government Organizations",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "On September 10, 2019, unknown threat actors exploited a vulnerability in SharePoint described in CVE-2019-0604 to install several webshells on the website of a Middle East government organization. One of these webshells is the open source AntSword webshell, similar to the China Chopper webshell.",
        "Execution": "The actors used the AntSword webshell to run a variety of commands on the compromised server for initial system and user discovery, as well as to ping systems of interest. They also uploaded tools to the server, including cURL, a custom Mimikatz variant, and compiled variants of Impacket's wmiexec and atexec tools.",
        "Defense Evasion": "The actors used a custom Mimikatz variant with a .NET loader to evade detection. Additionally, they uploaded the Dumpert tool, designed to evade antivirus and EDR solutions by using direct system calls and API unhooking.",
        "Credential Access": "The actors used Mimikatz to dump credentials from memory and Impacket tools to use the pass the hash technique to run commands on other systems.",
        "Discovery": "The actors ran various commands to do initial discovery on the system and network, including user accounts, files and folders, privileged groups, remote systems, and network configuration.",
        "Lateral Movement": "Using the collection of webshells, the actors moved laterally to other systems on the network by dumping credentials with a variant of the notorious Mimikatz tool and using Impacket's atexec tool to use dumped credentials to run commands on other systems.",
        "Command and Control": "The actors used the AntSword webshell to communicate with the compromised server and run commands. They also used the AntSword Shell Manager to interact with the webshell.",
        "Others": "Palo Alto Networks customers are protected from the threat described in this report through Threat Prevention signatures for the exploits and C2 traffic as well as through WildFire. The CVE-2019-0604 vulnerability is covered by IPS signature Microsoft SharePoint Remote Code Execution Vulnerability (55411). The Awen Webshell and AntSword ASPX Webshell are detected by IPS signatures. The Mimikatz, Impacket atexec, and Dumpert tools are all marked with malicious verdicts by WildFire."
    },
    "technique_label": true
}