{
    "triplets": [
        {
            "Subject": "CosmicDuke infections",
            "SubjectType": "campaign",
            "Relation": "begin-by",
            "Object": "deceiving victims",
            "ObjectType": "Tactic",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing",
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 1
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "utilize",
            "Object": "social engineering",
            "ObjectType": "Technique",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 2
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "utilize",
            "Object": "document-based exploits",
            "ObjectType": "Technique",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 3
        },
        {
            "Subject": "document-based exploit",
            "SubjectType": "Technique",
            "Relation": "involve",
            "Object": "CVE-2011-0611",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 4
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "remote servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 5
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "FTP and WebDav servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 6
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "exfiltrate-to",
            "Object": "FTP and WebDav servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 7
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "update",
            "Object": "the malware",
            "ObjectType": "Malware",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 8
        },
        {
            "Subject": "CosmicDuke samples",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "the same loader as MiniDuke's stage 3 samples",
            "ObjectType": "artifact",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ],
            "id": 9
        },
        {
            "Subject": "CosmicDuke samples",
            "SubjectType": "Malware",
            "Relation": "begin using",
            "Object": "updated loader",
            "ObjectType": "artifact",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ],
            "id": 10
        },
        {
            "Subject": "MiniDuke loader",
            "SubjectType": "artifact",
            "Relation": "updated",
            "Object": "CosmicDuke samples",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ],
            "id": 11
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "achieve",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1053-Scheduled Task/Job"
            ],
            "id": 12
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "Watchmon Service",
            "ObjectType": "process",
            "tactic": "Persistence",
            "technique": [
                "T1053-Scheduled Task/Job"
            ],
            "id": 13
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "install",
            "Object": "javamtsup",
            "ObjectType": "service",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 14
        },
        {
            "Subject": "javamtsup",
            "SubjectType": "service",
            "Relation": "have",
            "Object": "Java(TM) Virtual Machine Support Service",
            "ObjectType": "service",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 15
        },
        {
            "Subject": "service binary",
            "SubjectType": "file",
            "Relation": "open",
            "Object": "handle to the explorer.exe process",
            "ObjectType": "process",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 16
        },
        {
            "Subject": "service binary",
            "SubjectType": "file",
            "Relation": "read",
            "Object": "path of the actual malware binary from the registry",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 17
        },
        {
            "Subject": "service binary",
            "SubjectType": "file",
            "Relation": "start",
            "Object": "malware",
            "ObjectType": "Malware",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 18
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "copy",
            "Object": "%WINDIR%\\system32",
            "ObjectType": "directory",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ],
            "id": 19
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "target",
            "Object": "Skype, Google Talk, MSN Messenger, Google Chrome, Internet Explorer, Firefox, Thunderbird, Bat email client, Outlook Express, Outlook, Google Desktop",
            "ObjectType": "software",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 20
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "steal",
            "Object": "Windows credentials",
            "ObjectType": "artifacts",
            "tactic": "Credential Access",
            "technique": [
                "T1555-Credentials from Password Stores"
            ],
            "id": 21
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "export",
            "Object": "certificates and associated private keys",
            "ObjectType": "X.509 Certificate",
            "tactic": "Credential Access",
            "technique": [
                "T1649-Steal or Forge Authentication Certificates"
            ],
            "id": 22
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "search for",
            "Object": "files",
            "ObjectType": "file",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ],
            "id": 23
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "target",
            "Object": "non-English filenames",
            "ObjectType": "file",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ],
            "id": 24
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "keylogger",
            "ObjectType": "tool",
            "tactic": "Collection",
            "technique": [
                "T1056-Input Capture"
            ],
            "id": 25
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "screenshotter",
            "ObjectType": "tool",
            "tactic": "Collection",
            "technique": [
                "T1113-Screen Capture"
            ],
            "id": 26
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "clipboard stealer",
            "ObjectType": "tool",
            "tactic": "Collection",
            "technique": [
                "T1115-Clipboard Data"
            ],
            "id": 27
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "search",
            "Object": "removable drives",
            "ObjectType": "infrastrcucture",
            "tactic": "Collection",
            "technique": [
                "T1025-Data from Removable Media"
            ],
            "id": 28
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "upload",
            "Object": "information",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ],
            "id": 29
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "login credentials",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ],
            "id": 30
        },
        {
            "Subject": "CosmicDuke",
            "SubjectType": "Malware",
            "Relation": "contact",
            "Object": "remote sites",
            "ObjectType": "infrastructure",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ],
            "id": 31
        }
    ],
    "file_name": "cosmicduke_whitepaper",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "CosmicDuke infections begin by deceiving victims into opening a PDF file containing an exploit or a Windows executable disguised as a document or image file. The attackers utilize social engineering and document-based exploits to achieve this. The document-based exploit involves a malicious Flash object embedded in a PDF file that exploits the CVE-2011-0611 vulnerability in Adobe Flash, Reader, and Acrobat products. Social engineering tactics involve disguising the executable file as an image or document and displaying a decoy document or image to distract the user while the malware installs silently in the background.",
        "Execution": "The CosmicDuke samples analyzed use the same loader as MiniDuke's stage 3 samples. This loader was first seen with a compilation date of March 24, 2011, predating the oldest documented MiniDuke sample. The most common compilation date for loaders that load the Cosmu malware is November 13, 2012. The MiniDuke loader was updated, and CosmicDuke samples began using the updated loader in mid-April 2014, a few months after MiniDuke started using it in mid-December 2013.",
        "Persistence": "CosmicDuke achieves persistence on the system by creating a scheduled task named 'Watchmon Service' and installing a Windows service with the name 'javamtsup' and the display name 'Java(TM) Virtual Machine Support Service.' The service binary's size on disk varies, but typically the real size is 5120 bytes. The service opens a handle to the explorer.exe process, duplicates its process token, reads the path of the actual malware binary from the registry, and starts the malware using the duplicated token. The malware copies itself to %WINDIR%\\system32 with various filenames generated by combining two items from a predefined list.",
        "Credential Access": "CosmicDuke targets a variety of software to steal credentials, including Skype, Google Talk, MSN Messenger, Google Chrome, Internet Explorer, Firefox, Thunderbird, Bat email client, Outlook Express, Outlook, and Google Desktop. It also steals Windows credentials such as LM and NT hashes, cached domain passwords, LSA secrets, and plain text keys for WLANs. Additionally, it exports certificates and associated private keys from the system store using the password 'saribas' to encrypt the exported data.",
        "Discovery": "CosmicDuke searches for files on hard drives and network drives that match specific patterns, including various document, archive, and other file types. It also targets non-English filenames, particularly those that include the words 'sifr' and 'sifer,' which are related to encryption ciphers in many languages.",
        "Collection": "CosmicDuke collects information using a keylogger, screenshotter, and clipboard stealer. It also searches removable drives for files, skipping certain file types and drives with the volume name 'trandescend.'",
        "Command and Control": "CosmicDuke communicates with remote servers via HTTP GET requests and uses FTP and WebDav servers for exfiltrating collected data and updating the malware. The configuration, which includes server IPs, URLs, and credentials, is embedded in the info-stealer and compressed using an algorithm similar to LZNT-1.",
        "Exfiltration": "The information collected by CosmicDuke is automatically uploaded to remote servers via FTP. The report details the login credentials used and the FTP folder structure of the remote sites contacted by CosmicDuke. Most of these remote sites were live at the time of writing."
    },
    "technique_label": true
}