{
    "triplets": [
        {
            "Subject": "Stuxnet worm",
            "SubjectType": "Malware",
            "Relation": "exploit",
            "Object": "CVE-2010-2568 vulnerability",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing",
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 1
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "kernel-mode drivers",
            "ObjectType": "software",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process",
                "T1542-Pre-OS Boot"
            ],
            "id": 2
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "user-mode components",
            "ObjectType": "software",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process",
                "T1542-Pre-OS Boot"
            ],
            "id": 3
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "modify",
            "Object": "system files",
            "ObjectType": "file",
            "tactic": "Persistence",
            "technique": [
                "T1542-Pre-OS Boot"
            ],
            "id": 4
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "modify",
            "Object": "registry keys",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1542-Pre-OS Boot"
            ],
            "id": 5
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "rootkit functionality",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1014-Rootkit"
            ],
            "id": 6
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "stolen digital certificates",
            "ObjectType": "X.509 Certificate",
            "tactic": "Defense Evasion",
            "technique": [
                "T1553-Subvert Trust Controls"
            ],
            "id": 7
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "patch",
            "Object": "system libraries",
            "ObjectType": "software",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ],
            "id": 8
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "hook",
            "Object": "functions",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ],
            "id": 9
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "exploit",
            "Object": "MS08-067 RPC vulnerability",
            "ObjectType": "vulnerability",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ],
            "id": 10
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "exploit",
            "Object": "MS10-061 Print Spooler vulnerability",
            "ObjectType": "vulnerability",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ],
            "id": 11
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "install",
            "Object": "dropper",
            "ObjectType": "tool",
            "tactic": "Lateral Movement",
            "technique": [
                "T1080-Taint Shared Content"
            ],
            "id": 12
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "contain",
            "Object": "MrxCls.sys",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 13
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "contain",
            "Object": "MrxNet.sys",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 14
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "replace",
            "Object": "system files",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 15
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C&C servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ],
            "id": 16
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "implement",
            "Object": "RPC server",
            "ObjectType": "software",
            "tactic": "Command and Control",
            "technique": [
                "T1205-Traffic Signaling"
            ],
            "id": 17
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "utilize",
            "Object": "MS10-073",
            "ObjectType": "vulnerability",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 18
        },
        {
            "Subject": "Stuxnet",
            "SubjectType": "Malware",
            "Relation": "utilize",
            "Object": "MS10-092",
            "ObjectType": "vulnerability",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 19
        },
        {
            "Subject": "MS10-073",
            "SubjectType": "vulnerability",
            "Relation": "allow",
            "Object": "Stuxnet",
            "ObjectType": "Malware",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 20
        },
        {
            "Subject": "MS10-092",
            "SubjectType": "vulnerability",
            "Relation": "enable",
            "Object": "Stuxnet",
            "ObjectType": "Malware",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 21
        }
    ],
    "file_name": "Stuxnet_Under_the_Microscope",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The Stuxnet worm exploited the CVE-2010-2568 vulnerability to gain initial access to systems. This vulnerability was related to the way Windows displayed shortcut icons. Stuxnet used malicious .LNK files that, when viewed, would automatically execute the malware without user interaction. The worm specifically targeted SCADA systems, but its propagation method allowed it to spread widely. The initial infection vector was through removable drives, such as USB flash drives, which contained the malicious .LNK files and two TMP files (~WTR4141.TMP and ~WTR4132.TMP). The .LNK files were crafted to load the ~WTR4141.TMP file, which in turn would load and execute the ~WTR4132.TMP file, leading to the infection of the host machine.",
        "Execution": "Stuxnet's execution phase involved running malicious code on both local and remote systems. The worm's main module, a DLL packed with UPX, contained multiple resources including two kernel-mode drivers (MrxCls.sys and MrxNet.sys) and additional user-mode components. These drivers were responsible for injecting code into processes and hiding files used for propagation. Stuxnet also replaced legitimate system files with malicious versions to maintain persistence and control over infected systems. The malware executed exported functions from its main module to perform various tasks, such as building and running its dropper, spreading through the network, and communicating with command and control (C&C) servers.",
        "Persistence": "Stuxnet achieved persistence by installing kernel-mode drivers and user-mode components onto infected systems. It used a boot start service to ensure its kernel-mode driver (MrxCls.sys) was loaded early in the OS boot process. The driver injected code into specific processes and monitored system behavior to maintain control. Additionally, Stuxnet modified system files and registry keys to ensure it was executed upon system startup.",
        "Privilege Escalation": "Stuxnet utilized two zero-day vulnerabilities, MS10-073 and MS10-092, to escalate privileges on infected systems. The MS10-073 vulnerability in the win32k.sys system module allowed Stuxnet to execute arbitrary code with SYSTEM privileges by loading a specially crafted keyboard layout file. The MS10-092 vulnerability in the Windows Task Scheduler Service enabled Stuxnet to elevate its privileges up to SYSTEM level by manipulating the metadata of scheduled tasks. The worm used these elevated privileges to perform actions that would otherwise be restricted.",
        "Defense Evasion": "Stuxnet employed multiple techniques to evade detection and analysis. It used rootkit functionality to hide its presence on infected systems, including hiding files and injecting code into processes. The worm also utilized stolen digital certificates to sign its kernel-mode drivers, making them appear as legitimate software components. Additionally, Stuxnet patched system libraries and hooked functions to load non-existent libraries, reducing the likelihood of detection by heuristic methods.",
        "Lateral Movement": "Stuxnet propagated laterally through networks by exploiting vulnerabilities and shared resources. It used the MS08-067 RPC vulnerability and the MS10-061 Print Spooler vulnerability to spread itself across networked machines. The worm also scanned network shares and installed its dropper on accessible systems. Stuxnet's lateral movement capabilities allowed it to infect multiple systems within a targeted network, increasing its reach and impact.",
        "Command and Control": "Stuxnet communicated with C&C servers using HTTP. It encrypted its communications and sent data to predefined URLs, which included both decoy URLs (such as www.windowsupdate.com) and actual C&C server URLs (such as www.mypremierfutbol.com). The worm's C&C protocol involved sending system information and receiving commands or updates. Stuxnet also implemented an RPC server for peer-to-peer communication, allowing it to receive updates from other infected machines on the network."
    },
    "technique_label": true
}