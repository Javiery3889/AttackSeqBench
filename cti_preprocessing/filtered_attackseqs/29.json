{
    "triplets": [
        {
            "Subject": "Trend Micro Cyber Safety Solutions Team",
            "SubjectType": "CTI vender",
            "Relation": "reported",
            "Object": "new malware",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "T1189-Drive-by Compromise"
            ],
            "id": 1
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "compromised",
            "Object": "website",
            "ObjectType": "infrastructure",
            "tactic": "Initial Access",
            "technique": [
                "T1189-Drive-by Compromise"
            ],
            "id": 2
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "added code",
            "Object": "redirect visitors",
            "ObjectType": "network traffic",
            "tactic": "Initial Access",
            "technique": [
                "T1189-Drive-by Compromise"
            ],
            "id": 3
        },
        {
            "Subject": "CVE-2018-8174",
            "SubjectType": "vulnerablity",
            "Relation": "exploited by",
            "Object": "attackers",
            "ObjectType": "threat-actor",
            "tactic": "Initial Access",
            "technique": [
                "T1189-Drive-by Compromise"
            ],
            "id": 4
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "exploit",
            "Object": "CVE-2015-1701",
            "ObjectType": "vulnerability",
            "tactic": "Execution",
            "technique": [
                "T1203-Exploitation for Client Execution"
            ],
            "id": 5
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "download",
            "Object": "SLUB",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ],
            "id": 6
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "achieve persistence by copying itself to",
            "Object": "ProgramData\\update\\",
            "ObjectType": "directory",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 7
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "Run registry key",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 8
        },
        {
            "Subject": "first stage downloader",
            "SubjectType": "Malware",
            "Relation": "exit",
            "Object": "antivirus software processes",
            "ObjectType": "software",
            "tactic": "Defense Evasion",
            "technique": [
                "T1562-Impair Defenses"
            ],
            "id": 9
        },
        {
            "Subject": "The backdoor",
            "SubjectType": "Malware",
            "Relation": "support",
            "Object": "various commands",
            "ObjectType": "Tactic",
            "tactic": "Collection",
            "technique": [
                "T1113-Screen Capture"
            ],
            "id": 10
        },
        {
            "Subject": "various commands",
            "SubjectType": "Tactic",
            "Relation": "use",
            "Object": "data collection",
            "ObjectType": "Technique",
            "tactic": "Collection",
            "technique": [
                "T1113-Screen Capture"
            ],
            "id": 11
        },
        {
            "Subject": "The backdoor",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "information from registry keys",
            "ObjectType": "registry",
            "tactic": "Collection",
            "technique": [
                "T1602-Data from Configuration Repository"
            ],
            "id": 12
        },
        {
            "Subject": "The backdoor",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "archives of user's Desktop folders",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1560-Archive Collected Data"
            ],
            "id": 13
        },
        {
            "Subject": "archives of user's Desktop folders",
            "SubjectType": "artifacts",
            "Relation": "exfiltrate-to",
            "Object": "file.io website",
            "ObjectType": "domain",
            "tactic": "Collection",
            "technique": [
                "T1560-Archive Collected Data"
            ],
            "id": 14
        },
        {
            "Subject": "backdoor",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "attackers",
            "ObjectType": "threat-actor",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1102-Web Service"
            ],
            "id": 15
        },
        {
            "Subject": "backdoor",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Slack API",
            "ObjectType": "software",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1102-Web Service"
            ],
            "id": 16
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "exfiltrate-to",
            "Object": "file.io",
            "ObjectType": "domain-name",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 17
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "post",
            "Object": "download links",
            "ObjectType": "url",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 18
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "create",
            "Object": "archive files",
            "ObjectType": "file",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 19
        },
        {
            "Subject": "attackers",
            "SubjectType": "threat-actor",
            "Relation": "build",
            "Object": "CAB files",
            "ObjectType": "file",
            "tactic": "Exfiltration",
            "technique": [
                "T1567-Exfiltration Over Web Service"
            ],
            "id": 20
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "perform",
            "Object": "discovery",
            "ObjectType": "Tactic",
            "tactic": "Discovery",
            "technique": [
                "T1033-System Owner/User Discovery"
            ],
            "id": 21
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "download",
            "Object": "gist snippet",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 22
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "parse",
            "Object": "commands",
            "ObjectType": "attack-pattern",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ],
            "id": 23
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "retrieve",
            "Object": "username",
            "ObjectType": "identity",
            "tactic": "Discovery",
            "technique": [
                "T1033-System Owner/User Discovery"
            ],
            "id": 24
        },
        {
            "Subject": "SLUB backdoor",
            "SubjectType": "Malware",
            "Relation": "retrieve",
            "Object": "computer name",
            "ObjectType": "identity",
            "tactic": "Discovery",
            "technique": [
                "T1033-System Owner/User Discovery"
            ],
            "id": 25
        },
        {
            "Subject": "The downloader",
            "SubjectType": "tool",
            "Relation": "exploit",
            "Object": "CVE-2015-1701",
            "ObjectType": "vulnerability",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1068-Exploitation for Privilege Escalation"
            ],
            "id": 26
        }
    ],
    "file_name": "New SLUB Backdoor Uses GitHub Communicates via Slack",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The Trend Micro Cyber Safety Solutions Team, consisting of Cedric Pernet, Daniel Lunghi, Jaromir Horejsi, and Joseph C. Chen, reported on March 7, 2019, about a new malware spread via watering hole attacks. The attackers compromised a website and added code to redirect visitors to the infecting code, exploiting CVE-2018-8174, a VBScript engine vulnerability patched by Microsoft in May 2018.",
        "Execution": "The malware executes a multi-stage infection process. Initially, it exploits the VBScript engine vulnerability to download a DLL, which is then run in PowerShell. This downloader checks for antivirus software processes and exits if any are found. It also exploits CVE-2015-1701 for Local Privilege Escalation. The second stage involves downloading and executing a backdoor, named SLUB (for SLack and githUB; detected as Backdoor.Win32.SLUB.A).",
        "Persistence": "The SLUB backdoor achieves persistence by copying itself to ProgramData\\update\\ and creating a Run registry key with a typo in the ValueName, 'Microsoft Setup Initializazion', to call the export function UpdateMPUnits with rundll32.exe.",
        "Privilege Escalation": "The downloader exploits the CVE-2015-1701 vulnerability to acquire Local Privilege Escalation, likely by modifying code from a GitHub repository.",
        "Defense Evasion": "The first stage downloader exits if it detects any antivirus software processes, indicating an evasion tactic to avoid detection by security software.",
        "Discovery": "The SLUB backdoor performs discovery by downloading a 'gist' snippet from GitHub and parsing it for commands to execute. It looks for lines starting with '^' and ending with '$', ignoring other lines. The backdoor also retrieves the username and computer name as part of its discovery process.",
        "Collection": "The backdoor supports various commands for data collection, including taking screenshots, listing files, copying files, and uploading files to the file.io website. It also collects information from registry keys and creates archives of user's Desktop folders for exfiltration.",
        "Command and Control": "The backdoor communicates with the attackers via Slack, using two hardcoded authentication tokens to post messages and command results to a private Slack channel. It also uses the Slack API to post messages.",
        "Exfiltration": "The attackers exfiltrate data by uploading files to the file.io website and posting download links to the Slack channel. They also create archive files of user's Desktop folders and build CAB files containing the file tree for exfiltration.",
        "Others": "The attackers' tools, techniques, and procedures indicate a stealthy targeted attack by capable actors. The GitHub account and Slack workspace were created specifically for the campaign, and the malware was compiled shortly after. The attackers tested the malware and began observing victims within days. They showed a strong interest in person-related information, focusing on communication software to learn more about the people behind the infected computers. The attackers used public third-party services to leave a clean footprint and targeted groups and individuals interested in political activities. Trend Micro informed the Canadian Centre for Cyber Security, which helped mitigate the attack. Slack and GitHub's security teams removed the related files, cutting off communication between the attackers and their malware."
    },
    "technique_label": true
}