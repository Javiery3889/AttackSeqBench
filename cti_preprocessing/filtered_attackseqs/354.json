{
    "triplets": [
        {
            "Subject": "Udi Shamir",
            "SubjectType": "author",
            "Relation": "author",
            "Object": "CTI report",
            "ObjectType": "artifact",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 1
        },
        {
            "Subject": "CTI report",
            "SubjectType": "artifact",
            "Relation": "detail",
            "Object": "BlackEnergy 3",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 2
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "leverage",
            "Object": "CVE-2014-4114",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 3
        },
        {
            "Subject": "infected Excel documents",
            "SubjectType": "file",
            "Relation": "propagate",
            "Object": "BlackEnergy 3",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 4
        },
        {
            "Subject": "attack",
            "SubjectType": "campaign",
            "Relation": "suggest involvement of",
            "Object": "internal actor",
            "ObjectType": "identity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 5
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "execute-through",
            "Object": "Visual Basic macro",
            "ObjectType": "technique",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ],
            "id": 6
        },
        {
            "Subject": "vba_macro.exe",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "FONTCACHE.DAT",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 7
        },
        {
            "Subject": "vba_macro.exe",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "rundll32.exe",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 8
        },
        {
            "Subject": "FONTCACHE.DAT",
            "SubjectType": "file",
            "Relation": "operate-as",
            "Object": "network sniffer",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 9
        },
        {
            "Subject": "rundll32.exe",
            "SubjectType": "file",
            "Relation": "use",
            "Object": "FONTCACHE.DAT",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 10
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "achieve",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 11
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "register",
            "Object": "a binary to the startup shell",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 12
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "multiple anti-debugging techniques",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1622-Debugger Evasion"
            ],
            "id": 13
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C2 server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ],
            "id": 14
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "send",
            "Object": "localization data",
            "ObjectType": "artifact",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 15
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "send",
            "Object": "keyboard layout information",
            "ObjectType": "artifact",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 16
        },
        {
            "Subject": "C2 server",
            "SubjectType": "infrastructure",
            "Relation": "use",
            "Object": "HTTP protocol",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 17
        },
        {
            "Subject": "C2 server",
            "SubjectType": "infrastructure",
            "Relation": "have",
            "Object": "5.149.254.114",
            "ObjectType": "ipv4-addr",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 18
        },
        {
            "Subject": "5.149.254.114",
            "SubjectType": "ipv4-addr",
            "Relation": "belong-to",
            "Object": "FORTUNIX-NETWORS",
            "ObjectType": "identity",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ],
            "id": 19
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "function as",
            "Object": "network sniffer",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 20
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "send",
            "Object": "gathered information",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 21
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "GetAdaptersInfo() function API",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "T1016-System Network Configuration Discovery"
            ],
            "id": 22
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "designed for",
            "Object": "lateral movement",
            "ObjectType": "Tactic",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ],
            "id": 23
        },
        {
            "Subject": "BlackEnergy 3",
            "SubjectType": "Malware",
            "Relation": "sending data to",
            "Object": "servers",
            "ObjectType": "infrastructure",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ],
            "id": 24
        },
        {
            "Subject": "servers",
            "SubjectType": "infrastructure",
            "Relation": "deployed in",
            "Object": "major ISPs across Europe",
            "ObjectType": "Location",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ],
            "id": 25
        }
    ],
    "file_name": "BlackEnergy3_WP_012716_1c",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "The CTI report by Udi Shamir, dated 1/26/2016, details a new variant of BlackEnergy 3 malware targeting Ukrainian power facilities, leveraging a vulnerability CVE-2014-4114 in Microsoft Office 2013's OLE packager. The attack vector involves infected Excel documents that, when executed, propagate the malware within the network. This suggests the involvement of an internal actor, as Office 2013 has been patched against this vulnerability, indicating that the attack could only succeed through unpatched systems or deliberate internal execution.",
        "Execution": "The CTI report describes the execution of BlackEnergy 3 malware through a Visual Basic macro embedded in an Excel document. The macro reassembles and executes a portable executable (PE32) named vba_macro.exe stored in the Windows TMP directory. This executable, in turn, drops two additional executables, FONTCACHE.DAT and rundll32.exe, and then deletes itself. FONTCACHE.DAT operates as a network sniffer, and rundll32.exe is used to load this malicious DLL.",
        "Persistence": "The CTI report indicates that BlackEnergy 3 malware achieves persistence by registering a binary to the startup shell using the RegSetValueExw() function, ensuring that FONTCACHE.DAT is executed upon system startup.",
        "Defense Evasion": "The CTI report outlines multiple anti-debugging techniques used by BlackEnergy 3 malware, including CryptDecrypt() function calls on itself, SetUnhandledExceptionFilter API, kernel debugger checks, and IsDebuggerPresent API. Additionally, the malware attempts to detect runtime checksum changes to evade non-hardware breakpoints.",
        "Discovery": "The CTI report notes that BlackEnergy 3 malware gathers information for lateral movement by using the GetAdaptersInfo() function API to retrieve network information for the local computer.",
        "Lateral Movement": "The CTI report mentions that BlackEnergy 3 malware is designed for lateral movement, sending data to servers deployed in major ISPs across Europe.",
        "Command and Control": "The CTI report identifies that BlackEnergy 3 malware communicates with its command and control (C2) server using HTTP protocol, with the IP address 5.149.254.114 associated with FORTUNIX-NETWORS. The malware sends localization data and keyboard layout information to the C2 server.",
        "Exfiltration": "The CTI report describes BlackEnergy 3 malware's data exfiltration capabilities, where it functions as a network sniffer and sends gathered information to the C2 server.",
        "Others": "The CTI report by Udi Shamir suggests that BlackEnergy 3 malware is a product of a nation-sponsored campaign, likely involving multiple teams. It is associated with the Sandworm Team and has been used in various campaigns, including those targeting NATO countries and the conflict with Russia. The malware's toolkit is believed to be used for 'black ops' and has been linked to the shutdown of Estonian internet and government websites in 2007. The report also highlights the malware's high entropy and sophisticated evasion techniques, including encryption, encoding, and anti-debugging measures."
    },
    "technique_label": true
}