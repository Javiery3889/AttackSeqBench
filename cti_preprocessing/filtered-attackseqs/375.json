{
    "triplets": [
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2012-0158",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 1
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2009-4324",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1566-Phishing",
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 2
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2010-1297",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 3
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2010-2883",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 4
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2011-0611",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 5
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2011-1269",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 6
        },
        {
            "Subject": "Taidoor attackers",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "CVE-2009-3129",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ],
            "id": 7
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C&C servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 8
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "install",
            "Object": "RC4-encrypted executable file",
            "ObjectType": "file",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 9
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "autorun registry entry",
            "ObjectType": "registry",
            "tactic": "Command and Control",
            "technique": [
                "T1573-Encrypted Channel"
            ],
            "id": 10
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "files",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ],
            "id": 11
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "executable file",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 12
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "modify",
            "Object": "Windows Registry",
            "ObjectType": "registry",
            "tactic": "Execution",
            "technique": [
                "Others"
            ],
            "id": 13
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "maintain",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Execution",
            "technique": [
                "T1569-System Services"
            ],
            "id": 14
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "allow",
            "Object": "attackers",
            "ObjectType": "threat-actor",
            "tactic": "Execution",
            "technique": [
                "T1559-Inter-Process Communication"
            ],
            "id": 15
        },
        {
            "Subject": "The Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "uses",
            "Object": "~dfds3.reg",
            "ObjectType": "file",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 16
        },
        {
            "Subject": "The Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "modify",
            "Object": "the Windows Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 17
        },
        {
            "Subject": "The Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "maintain persistence on",
            "Object": "compromised systems",
            "ObjectType": "infrastrcucture",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ],
            "id": 18
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "produce",
            "Object": "identifiable network traffic",
            "ObjectType": "network traffic",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information"
            ],
            "id": 19
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "domain names",
            "ObjectType": "domain-name",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ],
            "id": 20
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "MAC address",
            "ObjectType": "mac-addr",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information"
            ],
            "id": 21
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "RC4 encryption key",
            "ObjectType": "artifact",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information"
            ],
            "id": 22
        },
        {
            "Subject": "The Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "has",
            "Object": "functionalities",
            "ObjectType": "attack-pattern",
            "tactic": "Impact",
            "technique": [
                "Others"
            ],
            "id": 23
        },
        {
            "Subject": "functionalities",
            "SubjectType": "attack-pattern",
            "Relation": "lead to",
            "Object": "data theft, data destruction",
            "ObjectType": "attack-pattern",
            "tactic": "Impact",
            "technique": [
                "T1485-Data Destruction"
            ],
            "id": 24
        },
        {
            "Subject": "functionalities",
            "SubjectType": "attack-pattern",
            "Relation": "lead to",
            "Object": "the ability to remotely terminate processes",
            "ObjectType": "attack-pattern",
            "tactic": "Impact",
            "technique": [
                "T1489-Service Stop"
            ],
            "id": 25
        },
        {
            "Subject": "the ability to remotely terminate processes",
            "SubjectType": "attack-pattern",
            "Relation": "potentially cause",
            "Object": "denial of service (DoS)",
            "ObjectType": "attack-pattern",
            "tactic": "Impact",
            "technique": [
                "T1489-Service Stop"
            ],
            "id": 26
        },
        {
            "Subject": "The Taidoor campaign",
            "SubjectType": "campaign",
            "Relation": "target",
            "Object": "Taiwanese government organizations",
            "ObjectType": "identity",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 27
        },
        {
            "Subject": "The Taidoor campaign",
            "SubjectType": "campaign",
            "Relation": "use",
            "Object": "social engineering tactics",
            "ObjectType": "Tactic",
            "tactic": "Reconnaissance",
            "technique": [
                "Others"
            ],
            "id": 28
        },
        {
            "Subject": "The attackers",
            "SubjectType": "threat-actor",
            "Relation": "spoof",
            "Object": "Taiwanese government email addresses",
            "ObjectType": "email-address",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ],
            "id": 29
        },
        {
            "Subject": "The attackers",
            "SubjectType": "threat-actor",
            "Relation": "send",
            "Object": "socially engineered emails",
            "ObjectType": "Email Message",
            "tactic": "Reconnaissance",
            "technique": [
                "Others"
            ],
            "id": 30
        },
        {
            "Subject": "The attackers",
            "SubjectType": "threat-actor",
            "Relation": "maintain",
            "Object": "several IP addresses",
            "ObjectType": "ipv4-addr",
            "tactic": "Reconnaissance",
            "technique": [
                "T1590-Gather Victim Network Information"
            ],
            "id": 31
        },
        {
            "Subject": "several IP addresses",
            "SubjectType": "ipv4-addr",
            "Relation": "use",
            "Object": "command and control",
            "ObjectType": "attack-pattern",
            "tactic": "Reconnaissance",
            "technique": [
                "T1590-Gather Victim Network Information"
            ],
            "id": 32
        },
        {
            "Subject": "Taidoor malware",
            "SubjectType": "Malware",
            "Relation": "exfiltrate-to",
            "Object": "C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ],
            "id": 33
        }
    ],
    "file_name": "wp_the_taidoor_campaign",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "The Taidoor campaign, primarily targeting Taiwanese government organizations, utilized social engineering tactics by spoofing Taiwanese government email addresses and sending socially engineered emails in Chinese, leveraging Taiwan-themed issues. The attackers sent out malicious documents and maintained several IP addresses for command and control.",
        "Initial Access": "The Taidoor attackers used a variety of vulnerabilities as attack vectors, including a Microsoft Common Controls vulnerability (CVE-2012-0158) and Adobe Reader, Acrobat, or Flash Player vulnerabilities (CVE-2009-4324, CVE-2010-1297, CVE-2010-2883, CVE-2011-0611). They also exploited vulnerabilities in Microsoft Excel and PowerPoint (CVE-2011-1269, CVE-2009-3129) using malicious .DOC, .PDF, .XLS, and .PPT files.",
        "Execution": "The Taidoor malware, upon opening a malicious document, creates two files in the user's Temp folder, executes a small executable file, modifies the Windows Registry, and maintains persistence. The malware also allows attackers to operate an interactive shell on compromised computers and to upload and download files.",
        "Persistence": "The Taidoor malware uses a file (~dfds3.reg) to modify the Windows Registry key HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run to maintain persistence on compromised systems.",
        "Defense Evasion": "The Taidoor malware produces identifiable network traffic, often directly accessing an IP address or using domain names for HTTP communication. The GET and POST requests contain a URL path with random characters and the compromised host's MAC address, which is obfuscated using a custom algorithm and used as an RC4 encryption key for subsequent network communication.",
        "Command and Control": "The Taidoor malware communicates with C&C servers using HTTP and RC4 encryption. The initial request to the C&C server includes the victim's MAC address, which is used as a key to encrypt data exchanged between the victim's machine and the C&C server. The malware installs an RC4-encrypted executable file in the memory space of a known Windows Service Process and creates an autorun registry entry for persistence.",
        "Exfiltration": "The Taidoor malware has the capability to upload files from infected machines to the C&C server, which can be used to exfiltrate data or files from the victim's network.",
        "Impact": "The Taidoor malware has functionalities typically seen in Remote Access Trojans (RATs), which can lead to data theft, data destruction, and the ability to remotely terminate processes on victims' machines, potentially causing denial of service (DoS).",
        "Others": "The Taidoor campaign has been active since at least March 4, 2009, with the earliest related activities seen as far back as October 2010. The campaign has consistently discovered malware samples connected to its infrastructure, indicating ongoing compromise attempts. Trend Micro's Smart Protection Network data was used to construct a timeline of related activities and to develop indicators of compromise based on the network traffic generated by the malware."
    },
    "technique_label": true
}