{
    "triplets": [
        {
            "Subject": "APT attack",
            "SubjectType": "campaign",
            "Relation": "target",
            "Object": "customer's company",
            "ObjectType": "identity",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "APT attack",
            "SubjectType": "campaign",
            "Relation": "lead to",
            "Object": "discovery of new backdoor malware",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "new backdoor malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Dropbox API",
            "ObjectType": "tool",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "load",
            "Object": "malicious DLL",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "malicious DLL",
            "SubjectType": "file",
            "Relation": "leverage",
            "Object": "Windows Defender Core Process",
            "ObjectType": "process",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "infection process",
            "SubjectType": "campaign",
            "Relation": "involve",
            "Object": "loader filenames",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "loader filenames",
            "SubjectType": "file",
            "Relation": "placed in",
            "Object": "C:\\ProgramData\\Microsoft",
            "ObjectType": "directory",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "older variant of mpsvc.dll",
            "SubjectType": "file",
            "Relation": "read",
            "Object": "shellcode",
            "ObjectType": "artifacts",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "shellcode",
            "SubjectType": "artifacts",
            "Relation": "from",
            "Object": "English.rtf payload file",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "newer variant",
            "SubjectType": "Malware",
            "Relation": "have",
            "Object": "hardcoded shellcode",
            "ObjectType": "artifacts",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "hardcoded shellcode",
            "SubjectType": "artifacts",
            "Relation": "inject and execute",
            "Object": "additional shellcode",
            "ObjectType": "artifacts",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "additional shellcode",
            "SubjectType": "artifacts",
            "Relation": "load",
            "Object": "fully functional backdoor executable",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "final malicious executable",
            "SubjectType": "Malware",
            "Relation": "released by",
            "Object": "mpsvc.dll",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1569-System Services"
            ]
        },
        {
            "Subject": "final malicious executable",
            "SubjectType": "Malware",
            "Relation": "interact with",
            "Object": "Dropbox API",
            "ObjectType": "software",
            "tactic": "Execution",
            "technique": [
                "T1569-System Services"
            ]
        },
        {
            "Subject": "final malicious executable",
            "SubjectType": "Malware",
            "Relation": "bypass",
            "Object": "User Account Control (UAC)",
            "ObjectType": "technique",
            "tactic": "Execution",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "final malicious executable",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": ".NET technique",
            "ObjectType": "technique",
            "tactic": "Execution",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "final malicious executable",
            "SubjectType": "Malware",
            "Relation": "have",
            "Object": "persistence mechanisms",
            "ObjectType": "technique",
            "tactic": "Execution",
            "technique": [
                "T1569-System Services"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "ensure",
            "Object": "persistence",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "register",
            "Object": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "register",
            "Object": "system service",
            "ObjectType": "Tactic",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "employ",
            "Object": "UAC bypass technique",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1548-Abuse Elevation Control Mechanism"
            ]
        },
        {
            "Subject": "UAC bypass technique",
            "SubjectType": "Technique",
            "Relation": "use",
            "Object": ".NET",
            "ObjectType": "software",
            "tactic": "Defense Evasion",
            "technique": [
                "T1548-Abuse Elevation Control Mechanism"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "IP address",
            "ObjectType": "ipv4-addr",
            "tactic": "Discovery",
            "technique": [
                "T1016-System Network Configuration Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "hostname",
            "ObjectType": "domain",
            "tactic": "Discovery",
            "technique": [
                "T1016-System Network Configuration Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "username",
            "ObjectType": "user-account",
            "tactic": "Discovery",
            "technique": [
                "T1033-System Owner/User Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "OS version",
            "ObjectType": "software",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "search",
            "Object": "Bitcoin wallet addresses",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1012-Query Registry"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "upload",
            "Object": "information",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1033-System Owner/User Discovery"
            ]
        },
        {
            "Subject": "This information",
            "SubjectType": "artifacts",
            "Relation": "upload",
            "Object": "Dropbox",
            "ObjectType": "infrastructure",
            "tactic": "Discovery",
            "technique": [
                "T1619-Cloud Storage Object Discovery"
            ]
        },
        {
            "Subject": "log file",
            "SubjectType": "file",
            "Relation": "named",
            "Object": "%Y-%m-%d %H-%M-%S.log",
            "ObjectType": "file",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "have",
            "Object": "recording features",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "T1123-Audio Capture",
                "T1115-Clipboard Data",
                "T1056-Input Capture",
                "T1113-Screen Capture"
            ]
        },
        {
            "Subject": "screen recording files",
            "SubjectType": "file",
            "Relation": "named with",
            "Object": "format",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged",
                "T1125-Video Capture"
            ]
        },
        {
            "Subject": "key-log",
            "SubjectType": "file",
            "Relation": "saved with",
            "Object": "filename",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ]
        },
        {
            "Subject": "clipboard log",
            "SubjectType": "file",
            "Relation": "saved with",
            "Object": "filename",
            "ObjectType": "artifact",
            "tactic": "Collection",
            "technique": [
                "T1115-Clipboard Data",
                "T1074-Data Staged"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "connect-to",
            "Object": "C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Dropbox API",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "Dropbox API token",
            "SubjectType": "artifact",
            "Relation": "hardcoded in",
            "Object": "malware",
            "ObjectType": "Malware",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "establish connection to",
            "Object": "C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "Dropbox",
            "ObjectType": "tool",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "control",
            "Object": "infected computers",
            "ObjectType": "infrastructure",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        }
    ],
    "file_name": "CLAMBLING - A New Backdoor Base On Dropbox (EN)",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "None",
        "Resource Development": "None",
        "Initial Access": "In July 2019, an APT attack targeted a customer's company, leading to the discovery of a new backdoor malware that uses Dropbox API for command and control (C&C) activities. The threat actor loaded a malicious DLL by leveraging the legitimate Windows Defender Core Process (MsMpEng.exe) with a legal digital signature. The infection process involved different loader filenames placed in C:\\ProgramData\\Microsoft, which called the function ServiceCrtMain from mpsvc.dll. The older variant of mpsvc.dll read shellcode from an English.rtf payload file, while the newer variant had hardcoded shellcode that would inject and execute to load additional shellcode from mpsvc.mui, ultimately releasing a fully functional backdoor executable.",
        "Execution": "The final malicious executable, released by the newer type of mpsvc.dll, had upgraded features, including the ability to interact with Dropbox API. It could bypass User Account Control (UAC) using a .NET technique disclosed in 2017 and had persistence mechanisms, either by registering as a startup program or as a system service.",
        "Persistence": "The malware ensured persistence by registering as a startup program in the registry path HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run if it lacked privileges, or as a system service if it had higher privileges.",
        "Privilege Escalation": "None",
        "Defense Evasion": "The malware employed a UAC bypass technique using .NET, which was not new but had been disclosed in 2017. The threat actor only changed the GUID to evade detection.",
        "Credential Access": "None",
        "Discovery": "The malware collected basic information such as IP address, hostname, username, OS version, and searched for Bitcoin wallet addresses in the registry key HKEY_CURRENT_USER\\Software\\Bitcoin\\Bitcoin-Qt. This information was uploaded to Dropbox with a log file named with the format %Y-%m-%d %H-%M-%S.log.",
        "Lateral Movement": "None",
        "Collection": "The malware had recording features that included keylogging, clipboard logging, and screen recording. The screen recording files were named with the format [%y-%m-%d]%H-%M-%S.avi, while the key-log and clipboard log were encoded and saved with the filenames <hash>.pas and <hash>.log, respectively.",
        "Command and Control": "The malware could connect to a specific C&C server and send back data using fake HTTP POST requests. It also interacted with Dropbox, uploading and downloading files using the Dropbox API. The malware checked for a fake GIF file header in the bin.asc file downloaded from Dropbox before proceeding to a custom decoding phase to release the inject payload.",
        "Exfiltration": "None",
        "Impact": "None",
        "Others": "The investigation revealed that the Dropbox API token was hardcoded in the malware. The Dropbox folder structure included a unique hash for each infected victim, log files, and payload files such as bin.asc. The malware's second stage involved establishing a connection to the C&C server and Dropbox, with Dropbox becoming a secondary C&C server with full remote control features if the primary C&C server's IP address was blocked. The malware could execute various commands, including listing drives, managing files, and opening terminals. The threat actor's approximate working hours were inferred from the decoded command files. Monitoring of the Dropbox tokens showed nearly 200 infected computers at the peak, with a drop in activity on August 21, 2019, when the threat actor cleared the Dropbox folder. The monitoring ended on September 20, 2019, when all tokens were revoked by the threat actor."
    },
    "technique_label": true
}