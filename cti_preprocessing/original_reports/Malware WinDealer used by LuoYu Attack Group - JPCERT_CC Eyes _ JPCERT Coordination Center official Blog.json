{
    "triplets": [
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "XOR encoding",
            "ObjectType": "technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1036-Masquerading"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C2 servers",
            "ObjectType": "infrastructure",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "encrypt",
            "Object": "stolen information",
            "ObjectType": "artifacts",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts"
            ]
        },
        {
            "Subject": "LuoYu Attack Group",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "WinDealer",
            "ObjectType": "Malware",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "monitor",
            "Object": "USB memory",
            "ObjectType": "artifacts",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "hardcoded RSA1024bit public key",
            "ObjectType": "artifacts",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C2 servers",
            "ObjectType": "infrastructure",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer malware",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "configuration",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "WinDealer malware",
            "SubjectType": "Malware",
            "Relation": "load",
            "Object": "DLL module",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ]
        },
        {
            "Subject": "WinDealer malware",
            "SubjectType": "Malware",
            "Relation": "steal",
            "Object": "information",
            "ObjectType": "artifacts",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "information",
            "SubjectType": "artifacts",
            "Relation": "save",
            "Object": ".a",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "information",
            "SubjectType": "artifacts",
            "Relation": "send-to",
            "Object": "C2 server",
            "ObjectType": "infrastrcucture",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "communicates with",
            "Object": "C2 servers",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1571-Non-Standard Port",
                "T1573-Encrypted Channel",
                "T1095-Non-Application Layer Protocol"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "uses",
            "Object": "UDP port 6999",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1571-Non-Standard Port",
                "T1095-Non-Application Layer Protocol"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "uses",
            "Object": "TCP port 55556",
            "ObjectType": "network traffic",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1571-Non-Standard Port"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "encrypts",
            "Object": "an AES key",
            "ObjectType": "artifacts",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "sends",
            "Object": "commands",
            "ObjectType": "artifacts",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "communicates with",
            "Object": "non-existent domains",
            "ObjectType": "domain-name",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "uses",
            "Object": "icanhazip[.]com",
            "ObjectType": "domain-name",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "discover",
            "Object": "information about the infected PC and network configuration",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1016-System Network Configuration Discovery"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "discover",
            "Object": "data from SNS applications",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1518-Software Discovery"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "process",
            "Object": "stolen data",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "stage",
            "Object": "stolen data",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "encrypt",
            "Object": "stolen data",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "send",
            "Object": "stolen data",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "AES",
            "ObjectType": "encryption-algorithm",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "WinDealer",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "C2 server",
            "ObjectType": "infrastructure",
            "tactic": "Discovery",
            "technique": [
                "T1049-System Network Connections Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "collect",
            "Object": "data",
            "ObjectType": "artifacts",
            "tactic": "Collection",
            "technique": [
                "T1025-Data from Removable Media"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "target",
            "Object": "folders",
            "ObjectType": "directory",
            "tactic": "Collection",
            "technique": [
                "T1025-Data from Removable Media"
            ]
        },
        {
            "Subject": "The collected data",
            "SubjectType": "artifacts",
            "Relation": "process into",
            "Object": "\".a\" files",
            "ObjectType": "file",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ]
        },
        {
            "Subject": "The collected data",
            "SubjectType": "artifacts",
            "Relation": "categorize into",
            "Object": "different directories",
            "ObjectType": "directory",
            "tactic": "Collection",
            "technique": [
                "T1074-Data Staged"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "exfiltrate-to",
            "Object": "C2 server",
            "ObjectType": "infrastructure",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ]
        },
        {
            "Subject": "data",
            "SubjectType": "artifacts",
            "Relation": "stage-at",
            "Object": "%TEMP% directory",
            "ObjectType": "directory",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ]
        },
        {
            "Subject": "data",
            "SubjectType": "artifacts",
            "Relation": "encrypt",
            "Object": "malware",
            "ObjectType": "Malware",
            "tactic": "Exfiltration",
            "technique": [
                "T1041-Exfiltration Over C2 Channel"
            ]
        }
    ],
    "file_name": "Malware WinDealer used by LuoYu Attack Group - JPCERT_CC Eyes _ JPCERT Coordination Center official Blog",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "None",
        "Resource Development": "None",
        "Initial Access": "None",
        "Execution": "The WinDealer malware, associated with the LuoYu Attack Group, executes upon launch by reading its configuration from a file located under C:\\ProgramData. It then loads a DLL module into memory. The malware is designed to steal information from the victim's PC, including network configuration and details from SNS applications, and saves this data with a \".a\" extension in the %TEMP% directory. This information is subsequently sent to a C2 server.",
        "Persistence": "None",
        "Privilege Escalation": "None",
        "Defense Evasion": "WinDealer employs defense evasion by encoding its configuration files using XOR with the key value \"b6a7%7486\". It also communicates with C2 servers using encrypted channels, specifically encrypting an AES key with RSA and sending it to the C2 server. The malware further encrypts stolen information using AES128bit ECB mode before transmission.",
        "Credential Access": "None",
        "Discovery": "WinDealer discovers information about the infected PC and network configuration, as well as data from SNS applications. It processes and stages the stolen data in a folder under %TEMP%, encrypting it with AES before sending it to a C2 server.",
        "Lateral Movement": "None",
        "Collection": "The malware collects data from the victim's PC, including files stored on USB memory, documents, desktop items, and recycle bin contents. It also targets folders related to SNS applications. The collected data is processed into \".a\" files by a module and is categorized into different directories based on the data type.",
        "Command and Control": "WinDealer communicates with C2 servers using UDP port 6999 or TCP port 55556. It encrypts an AES key with RSA and sends it to the C2 server, which then sends commands back to the victim PC. The malware executes these commands and sends the results back to the C2 server after encryption. It also communicates with non-existent domains and uses icanhazip[.]com for IP address verification.",
        "Exfiltration": "The malware exfiltrates stolen data to a C2 server after processing and encrypting it. The data is sent from the %TEMP% directory where it is staged as \".a\" files.",
        "Impact": "None",
        "Others": "The LuoYu Attack Group has been targeting Korean and Japanese organizations since 2014. The WinDealer malware is one of the tools used by this group, and it operates on various platforms. The malware has been observed to monitor and process data from USB memory, documents, desktop, recycle bin, and SNS application folders. The malware's configuration is stored in several folders under C:\\ProgramData, and it uses a hardcoded RSA1024bit public key for encryption. The malware's communication with C2 servers includes sending an encrypted AES key and receiving commands. The malware's DLL module, named \"MozillaDll.dll\", has export functions for stealing data, setting configuration, and initiating commands. The malware also monitors items such as files stored in USB memory and folders related to SNS applications, saving related items in separate files to be sent to a C2 server."
    },
    "technique_label": true
}