{
    "triplets": [
        {
            "Subject": "Sygnia Incident Response team",
            "SubjectType": "author",
            "Relation": "identified",
            "Object": "TG1021",
            "ObjectType": "threat-actor",
            "tactic": "Reconnaissance",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "known-as",
            "Object": "Silent Chollima",
            "ObjectType": "threat-actor",
            "tactic": "Reconnaissance",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "SILENTTRINITY",
            "ObjectType": "tool",
            "tactic": "Reconnaissance",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "cryptocurrency firms",
            "ObjectType": "identity",
            "tactic": "Reconnaissance",
            "technique": [
                "T1589-Gather Victim Identity Information"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "Windows IIS servers",
            "ObjectType": "infrastructure",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "deserialization attacks",
            "ObjectType": "attack-pattern",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "exploit",
            "Object": "0-day vulnerability",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "execute",
            "Object": "MEMORYGRABBER",
            "ObjectType": "Malware",
            "tactic": "Execution",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "utilize",
            "Object": "web shells",
            "ObjectType": "tool",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "utilize",
            "Object": "NodeIISWeb malware",
            "ObjectType": "Malware",
            "tactic": "Persistence",
            "technique": [
                "T1543-Create or Modify System Process"
            ]
        },
        {
            "Subject": "NodeIISWeb malware",
            "SubjectType": "Malware",
            "Relation": "intercept",
            "Object": "HTTP requests",
            "ObjectType": "network traffic",
            "tactic": "Persistence",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "remove",
            "Object": "disk-resident tools",
            "ObjectType": "tool",
            "tactic": "Persistence",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "PotatoEx.dll",
            "ObjectType": "tool",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1548-Abuse Elevation Control Mechanism"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "dynamic DLL loading and execution",
            "ObjectType": "technique",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "code injection",
            "ObjectType": "technique",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1055-Process Injection"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "token manipulation",
            "ObjectType": "technique",
            "tactic": "Privilege Escalation",
            "technique": [
                "T1134-Access Token Manipulation"
            ]
        },
        {
            "Subject": "second stage malware",
            "SubjectType": "Malware",
            "Relation": "provide",
            "Object": "ExtDLL.dll",
            "ObjectType": "tool",
            "tactic": "Privilege Escalation",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "interfere with",
            "Object": "logging mechanisms",
            "ObjectType": "artifacts",
            "tactic": "Defense Evasion",
            "technique": [
                "T1562-Impair Defenses"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "evade",
            "Object": "commercial EDRs",
            "ObjectType": "software",
            "tactic": "Defense Evasion",
            "technique": [
                "T1562-Impair Defenses"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "await",
            "Object": "incoming connections",
            "ObjectType": "network traffic",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "threat actor",
            "SubjectType": "threat-actor",
            "Relation": "remove",
            "Object": "disk-resident tools",
            "ObjectType": "tool",
            "tactic": "Defense Evasion",
            "technique": [
                "T1070-Indicator Removal"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "modify",
            "Object": "login webpages",
            "ObjectType": "file",
            "tactic": "Credential Access",
            "technique": [
                "T1056-Input Capture"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "save",
            "Object": "credentials",
            "ObjectType": "artifact",
            "tactic": "Credential Access",
            "technique": [
                "T1056-Input Capture"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "SharpHound",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "load",
            "Object": "SharpHound",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "execute",
            "Object": "SharpHound",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "retrieve",
            "Object": "output files",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "delete",
            "Object": "output files",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "load",
            "Object": "PowerSploit",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "execute",
            "Object": "PowerSploit",
            "ObjectType": "tool",
            "tactic": "Discovery",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "establish",
            "Object": "foothold",
            "ObjectType": "infrastructure",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "access",
            "Object": "shared folders",
            "ObjectType": "directory",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "compromised domain credentials",
            "ObjectType": "identity",
            "tactic": "Lateral Movement",
            "technique": [
                "T1550-Use Alternate Authentication Material"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "drop",
            "Object": "NodeIISWeb web shell loader",
            "ObjectType": "tool",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "compromise",
            "Object": "additional servers",
            "ObjectType": "infrastructure",
            "tactic": "Lateral Movement",
            "technique": [
                "T1021-Remote Services"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "utilize",
            "Object": "exploits",
            "ObjectType": "vulnerability",
            "tactic": "Lateral Movement",
            "technique": [
                "T1210-Exploitation of Remote Services"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "move",
            "Object": "laterally",
            "ObjectType": "Tactic",
            "tactic": "Lateral Movement",
            "technique": [
                "T1080-Taint Shared Content"
            ]
        },
        {
            "Subject": "TG1021",
            "SubjectType": "threat-actor",
            "Relation": "establish",
            "Object": "command and control",
            "ObjectType": "Tactic",
            "tactic": "Command and Control",
            "technique": [
                "T1219-Remote Access Software"
            ]
        },
        {
            "Subject": "NodeIISWeb",
            "SubjectType": "Malware",
            "Relation": "provide",
            "Object": "backdoor functionality",
            "ObjectType": "Technique",
            "tactic": "Command and Control",
            "technique": [
                "T1219-Remote Access Software"
            ]
        }
    ],
    "file_name": "TG1021 - Praying Mantis Threat Actor",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "The Sygnia Incident Response team identified that TG1021, also known as \\",
        "Resource Development": "None",
        "Initial Access": "TG1021 gained initial access to target networks by exploiting internet-facing Windows IIS servers using deserialization attacks. The threat actor leveraged a variety of exploits, including a 0-day vulnerability associated with the \\",
        "Execution": "TG1021 executed a sophisticated memory-resident malware, referred to as \\",
        "Persistence": "To maintain persistence, TG1021 utilized web shells and a custom malware framework that operates almost entirely in-memory. The core component of this framework, the NodeIISWeb malware, intercepts and handles HTTP requests received by the server. Additionally, the threat actor actively removed all disk-resident tools after using them, effectively giving up on persistency in exchange for stealth.",
        "Privilege Escalation": "TG1021 employed various techniques for privilege escalation, including the use of a custom version of the Potato family tools, known as PotatoEx.dll, which is a common local privilege escalation tool. The threat actor also used dynamic DLL loading and execution, as well as code injection and token manipulation functionalities provided by the second stage malware, ExtDLL.dll.",
        "Defense Evasion": "TG1021 demonstrated significant efforts to avoid detection by actively interfering with logging mechanisms and successfully evading commercial EDRs. The malware used by TG1021 shows a significant effort to avoid detection, both by actively interfering with logging mechanisms, successfully evading commercial EDRs, and by silently awaiting incoming connections, rather than connecting back to a C2 channel and continuously generating traffic. Furthermore, the threat actor actively removed all disk-resident tools after using them, effectively giving up on persistency in exchange for stealth.",
        "Credential Access": "TG1021 modified login webpages to record credentials and save them to a file in clear text format. The modification is a short-embedded code-block at the beginning of the webpage file with a simple try-catch phrase code.",
        "Discovery": "TG1021 used publicly available offensive security tools (OST) to perform reconnaissance, such as SharpHound to scan and map targets by loading it directly to infected machines' memory without writing the binary on the disk. Quickly after the execution, the threat actor retrieved the output files and deleted them. In addition, PowerSploit was loaded and executed using the same technique.",
        "Lateral Movement": "After establishing a foothold on an external IIS server, TG1021 accessed shared folders on internal web servers over SMB using compromised domain credentials. On several occasions, the threat actor dropped the NodeIISWeb web shell loader via SMB to compromise additional servers. Additionally, the threat actor utilized the exploits mentioned above to move laterally between IIS servers.",
        "Collection": "None",
        "Command and Control": "TG1021 established command and control by deploying an inline hook on a validation function within the IIS request handling process. The malware, NodeIISWeb, provided backdoor functionality, allowing the threat actor to perform various actions on the affected host, including file and directory manipulation, system information gathering, dynamic DLL loading and execution, and code injection.",
        "Exfiltration": "None",
        "Impact": "None",
        "Others": "None"
    },
    "technique_label": true
}