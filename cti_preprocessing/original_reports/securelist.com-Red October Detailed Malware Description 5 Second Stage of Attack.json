{
    "triplets": [
        {
            "Subject": "exfiltration group",
            "SubjectType": "threat-actor",
            "Relation": "include",
            "Object": "WNFTPSCAN",
            "ObjectType": "tool",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "WNFTPSCAN",
            "SubjectType": "tool",
            "Relation": "use",
            "Object": "WinInet library",
            "ObjectType": "software",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "WNFTPSCAN",
            "SubjectType": "tool",
            "Relation": "apply",
            "Object": "PCRE library",
            "ObjectType": "software",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "WNFTPSCAN",
            "SubjectType": "tool",
            "Relation": "send",
            "Object": "logs and collected files",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "GetFileReg module",
            "SubjectType": "tool",
            "Relation": "delete",
            "Object": "dump",
            "ObjectType": "file",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "GetFileReg module",
            "SubjectType": "tool",
            "Relation": "send",
            "Object": "packets",
            "ObjectType": "network traffic",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "GetFileReg module",
            "SubjectType": "tool",
            "Relation": "traverse",
            "Object": "directories",
            "ObjectType": "directory",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "GetFileReg module",
            "SubjectType": "tool",
            "Relation": "process",
            "Object": "email databases",
            "ObjectType": "file",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "FileInfo module",
            "SubjectType": "tool",
            "Relation": "start",
            "Object": "threads",
            "ObjectType": "process",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        },
        {
            "Subject": "FileInfo module",
            "SubjectType": "tool",
            "Relation": "store",
            "Object": "information about processed files",
            "ObjectType": "artifacts",
            "tactic": "Exfiltration",
            "technique": [
                "T1020-Automated Exfiltration"
            ]
        }
    ],
    "file_name": "securelist.com-Red October Detailed Malware Description 5 Second Stage of Attack",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "None",
        "Resource Development": "None",
        "Initial Access": "None",
        "Execution": "None",
        "Persistence": "None",
        "Privilege Escalation": "None",
        "Defense Evasion": "None",
        "Credential Access": "None",
        "Discovery": "None",
        "Lateral Movement": "None",
        "Collection": "None",
        "Command and Control": "None",
        "Exfiltration": "The second stage of the 'Red October' attack involves an exfiltration group, which includes the WNFTPSCAN and GetFileReg modules. The WNFTPSCAN module is a non-interactive FTP client that scans directories on an FTP server, copying files of interest based on specific criteria such as file size and modification date. It uses WinInet library functions to connect and iterate through directories, applying PCRE library checks for file extensions. The module logs directory listings and checks for write-access, although this functionality is not currently used. It sends logs and collected files to a C&C server after compressing, encrypting, and encoding the data.\nThe GetFileReg module is a PE DLL file that, upon loading, deletes a file named 'dump' and proceeds to its main function, which involves directory traversal and file matching based on creation/modification times, size, and regular expression matching. It raises privileges to access administrative credentials, sends several types of packets to the C&C server, and traverses different directories based on the configuration file. Special processing is applied to email databases, and the module sends the final C&C request after all operations are completed.\nThe FileInfo module is similar to GetFileReg, with additional options for network share traversal and matching. It starts four threads for different scopes of subjects to process and operates in a continuous mode, with delays between iterations controlled by specific options. It stores information about processed files in an encrypted log file.",
        "Impact": "None",
        "Others": "None"
    },
    "technique_label": true
}