{
    "triplets": [
        {
            "Subject": "DRAGONFISH",
            "SubjectType": "threat-actor",
            "Relation": "distributing",
            "Object": "Elise",
            "ObjectType": "Malware",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "Elise",
            "SubjectType": "Malware",
            "Relation": "variant-of",
            "Object": "malicious Microsoft Word document",
            "ObjectType": "artifact",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "malicious Microsoft Word document",
            "SubjectType": "artifact",
            "Relation": "exploit",
            "Object": "CVE-2017-11882",
            "ObjectType": "vulnerability",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "start",
            "Object": "iexplore.exe",
            "ObjectType": "process",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "inject",
            "Object": "NavShExt.dll",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "create",
            "Object": "donotbotherme",
            "ObjectType": "mutex",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "store",
            "Object": "thumbcache_1CD60.db",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "send",
            "Object": "data",
            "ObjectType": "artifact",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "download",
            "Object": "files and commands",
            "ObjectType": "artifact",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "The Elise malware",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "103.236.150[.]14",
            "ObjectType": "ipv4-addr",
            "tactic": "Execution",
            "technique": [
                "T1106-Native API"
            ]
        },
        {
            "Subject": "Persistence",
            "SubjectType": "Tactic",
            "Relation": "use",
            "Object": "Run Registry key",
            "ObjectType": "registry",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "Run Registry key",
            "SubjectType": "registry",
            "Relation": "locate-at",
            "Object": "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD",
            "ObjectType": "directory",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "DLLs",
            "SubjectType": "file",
            "Relation": "inject-into",
            "Object": "iexplore.exe",
            "ObjectType": "process",
            "tactic": "Persistence",
            "technique": [
                "T1547-Boot or Logon Autostart Execution"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "employ",
            "Object": "defense evasion techniques",
            "ObjectType": "Tactic",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information",
                "T1497-Virtualization/Sandbox Evasion"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "obfuscation techniques",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1027-Obfuscated Files or Information"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "exfiltrate-to",
            "Object": "C2 server",
            "ObjectType": "infrastructure",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "spoof",
            "Object": "host",
            "ObjectType": "infrastructure",
            "tactic": "Defense Evasion",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "malware",
            "SubjectType": "Malware",
            "Relation": "communicate-with",
            "Object": "103.236.150[.]14",
            "ObjectType": "ipv4-addr",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol"
            ]
        },
        {
            "Subject": "iDefense analysts",
            "SubjectType": "author",
            "Relation": "identify",
            "Object": "campaign",
            "ObjectType": "campaign",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "DRAGONFISH",
            "SubjectType": "threat-actor",
            "Relation": "target",
            "Object": "ASEAN Defence Ministers' Meeting",
            "ObjectType": "identity",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "security teams",
            "SubjectType": "identity",
            "Relation": "mitigate",
            "Object": "threat",
            "ObjectType": "attack-pattern",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "system information",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "ipaddress.com",
            "ObjectType": "domain",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "LAN IP addresses",
            "ObjectType": "ipv4-addr",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "WAN IP addresses",
            "ObjectType": "ipv4-addr",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "installed software list",
            "ObjectType": "artifacts",
            "tactic": "Discovery",
            "technique": [
                "T1082-System Information Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "proxy information",
            "ObjectType": "network traffic",
            "tactic": "Discovery",
            "technique": [
                "T1012-Query Registry",
                "T1016-System Network Configuration Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "process enumeration",
            "ObjectType": "process",
            "tactic": "Discovery",
            "technique": [
                "T1057-Process Discovery"
            ]
        },
        {
            "Subject": "The malware",
            "SubjectType": "Malware",
            "Relation": "harvest",
            "Object": "list of all files on the user's desktop",
            "ObjectType": "directory",
            "tactic": "Discovery",
            "technique": [
                "T1083-File and Directory Discovery"
            ]
        }
    ],
    "file_name": "Accenture-Security-Dragonfish-Threat-Analysis",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "None",
        "Resource Development": "None",
        "Initial Access": "The threat group DRAGONFISH, also known as Lotus Blossom, has been distributing a new variant of Elise malware through a malicious Microsoft Word document. The document, which contains information on ADMM-Plus members, embeds a malicious executable file as an OLE object. This file is dropped to the %temp% folder upon opening the document and is executed by exploiting the CVE-2017-11882 vulnerability. The payload is then moved to \\AppData\\Roaming\\Microsoft\\Windows\\Caches\\ as a file named NavShExt.dll, and the original executable is deleted.",
        "Execution": "The Elise malware initiates the following sequence of actions: it starts the Internet Explorer process (iexplore.exe) in a suspended state, injects the NavShExt.dll into the process, and calls the DLL's export function named 'Setting'. The process then continues to run in the background. The malware creates a mutex named 'donotbotherme' to prevent duplicate executions and stores harvested data in a file named thumbcache_1CD60.db located in AppData\\Local\\Microsoft\\Windows\\Explorer\\. It also sends data to and downloads files and commands from a hardcoded C2 server with the IP address 103.236.150[.]14.",
        "Persistence": "Persistence is achieved by using the Run Registry key with the value name IAStorD located at HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\IAStorD. Additionally, two hidden DLLs with export functions named DePatchEntry or EvilEntry are injected into iexplore.exe to provide loading and anti-analysis functionalities.",
        "Privilege Escalation": "None",
        "Defense Evasion": "The malware employs various defense evasion techniques, including heavy anti-virtual-machine features, obfuscation techniques to exfiltrate data to the C2 server using base64-encoded cookie values, and spoofing the host to query non-existing domains to mislead malware analysts or network administrators. Debug paths are completely stripped from the malware.",
        "Credential Access": "None",
        "Discovery": "The malware harvests extensive system information, including LAN and WAN IP addresses (using ipaddress.com for the latter), installed software list, proxy information, process enumeration via tasklist, and a list of all files on the user's desktop.",
        "Lateral Movement": "None",
        "Collection": "None",
        "Command and Control": "The malware communicates with a hardcoded C2 server with the IP address 103.236.150[.]14, sending harvested data and receiving files and commands.",
        "Exfiltration": "None",
        "Impact": "None",
        "Others": "iDefense analysts have identified a campaign by the threat group DRAGONFISH targeting the ASEAN Defence Ministers' Meeting (ADMM) and associated individuals for espionage. The malware is capable of providing the attacker with a remote shell on the host and can completely uninstall itself. Execution debug messages are stored in the %temp% folder in a file named FXSAPIDebugLogFile.tmp, and logs are encrypted using a static AES key. To mitigate the threat, security teams are advised to block access to the C2 server and ensure the installation of Microsoft Security Update KB2553204 to patch the CVE-2017-11882 vulnerability. Analysts should look for artifacts such as a value named IAStorD in the autorun key, a file named FXSAPIDebugLogFile.tmp, a mutex handle named donotbotherme, and thumbcache_1CD60.db in AppData\\Local\\Microsoft\\Windows\\Explorer\\."
    },
    "technique_label": true
}