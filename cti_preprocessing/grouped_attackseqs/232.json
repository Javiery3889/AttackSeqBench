{
    "file_name": "Emissary Panda Attacks Middle East Government Sharepoint Servers",
    "tactic_label": true,
    "rewrite": {
        "Reconnaissance": "In April 2019, Unit 42 observed Emissary Panda (APT27, TG-3390, Bronze Union, Lucky Mouse) exploiting a vulnerability in Microsoft SharePoint (CVE-2019-0604) to install webshells on SharePoint servers of Middle East Government Organizations. They used tools to identify systems vulnerable to CVE-2017-0144, the same exploited by EternalBlue in the WannaCry attacks.",
        "Initial Access": "Emissary Panda gained initial access by exploiting a vulnerability in Microsoft SharePoint (CVE-2019-0604) to install webshells on servers. This activity was first observed on April 1, 2019, and continued until April 16, 2019.",
        "Execution": "The threat actors uploaded a variety of tools to the compromised servers, including legitimate applications and post-exploitation tools like Mimikatz. They also uploaded custom backdoors such as HyperBro, commonly associated with Emissary Panda.",
        "Persistence": "The actors installed webshells on SharePoint servers for persistence. These included the Antak webshell, a variant of the China Chopper webshell, and other related webshells like stylecs.aspx, stylecss.aspx, and test.aspx.",
        "Defense Evasion": "Emissary Panda used webshells to upload legitimate executables for DLL sideloading, running malicious DLLs with code overlaps with known Emissary Panda attacks. They also used the China Chopper webshell to maintain access and evade defenses.",
        "Credential Access": "The actors used tools like Mimikatz to dump credentials, which were then used to pivot to additional systems within the network.",
        "Discovery": "The threat group used tools to perform network reconnaissance, identifying vulnerable systems and gathering information to facilitate lateral movement.",
        "Lateral Movement": "Emissary Panda moved laterally across the network using stolen credentials and exploiting vulnerabilities, particularly CVE-2017-0144 (EternalBlue).",
        "Command and Control": "The HyperBro backdoor was used for command and control, configured to communicate with a C2 server over HTTPS (hxxps://185.12.45[.]134:443/ajax).",
        "Others": "The CTI report includes indicators of compromise (IoCs) and SHA256 hashes of the webshells and malicious tools used by Emissary Panda. Additionally, the report correlates findings with advisories from the Saudi Arabian National Cyber Security Center and the Canadian Center for Cyber Security."
    },
    "technique_label": true,
    "triplet_groups": {
        "Reconnaissance": {
            "T1595-Active Scanning": [
                {
                    "Subject": "Unit 42",
                    "SubjectType": "CTI vender",
                    "Relation": "observed",
                    "Object": "Emissary Panda",
                    "ObjectType": "threat-actor",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning"
                    ],
                    "id": 1
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "exploiting",
                    "Object": "CVE-2019-0604",
                    "ObjectType": "vulnerability",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning"
                    ],
                    "id": 2
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "install",
                    "Object": "webshells",
                    "ObjectType": "tool",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning"
                    ],
                    "id": 3
                },
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "host",
                    "Object": "SharePoint servers",
                    "ObjectType": "infrastructure",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1592-Gather Victim Host Information"
                    ],
                    "id": 4
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "tools",
                    "ObjectType": "tool",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning"
                    ],
                    "id": 5
                },
                {
                    "Subject": "tools",
                    "SubjectType": "tool",
                    "Relation": "identify",
                    "Object": "CVE-2017-0144",
                    "ObjectType": "vulnerability",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1596-Search Open Technical Databases"
                    ],
                    "id": 6
                },
                {
                    "Subject": "EternalBlue",
                    "SubjectType": "Malware",
                    "Relation": "exploit",
                    "Object": "CVE-2017-0144",
                    "ObjectType": "vulnerability",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1596-Search Open Technical Databases"
                    ],
                    "id": 7
                },
                {
                    "Subject": "WannaCry",
                    "SubjectType": "Malware",
                    "Relation": "use",
                    "Object": "EternalBlue",
                    "ObjectType": "Malware",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning"
                    ],
                    "id": 8
                }
            ],
            "T1592-Gather Victim Host Information": [
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "host",
                    "Object": "SharePoint servers",
                    "ObjectType": "infrastructure",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1592-Gather Victim Host Information"
                    ],
                    "id": 4
                }
            ],
            "T1596-Search Open Technical Databases": [
                {
                    "Subject": "tools",
                    "SubjectType": "tool",
                    "Relation": "identify",
                    "Object": "CVE-2017-0144",
                    "ObjectType": "vulnerability",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1596-Search Open Technical Databases"
                    ],
                    "id": 6
                },
                {
                    "Subject": "EternalBlue",
                    "SubjectType": "Malware",
                    "Relation": "exploit",
                    "Object": "CVE-2017-0144",
                    "ObjectType": "vulnerability",
                    "tactic": "Reconnaissance",
                    "technique": [
                        "T1595-Active Scanning",
                        "T1596-Search Open Technical Databases"
                    ],
                    "id": 7
                }
            ]
        },
        "Initial Access": {
            "T1190-Exploit Public-Facing Application": [
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "exploit",
                    "Object": "CVE-2019-0604",
                    "ObjectType": "vulnerablity",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1190-Exploit Public-Facing Application"
                    ],
                    "id": 9
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "install",
                    "Object": "webshells",
                    "ObjectType": "tool",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1190-Exploit Public-Facing Application"
                    ],
                    "id": 10
                }
            ]
        },
        "Execution": {
            "T1072-Software Deployment Tools": [
                {
                    "Subject": "threat actors",
                    "SubjectType": "threat-actor",
                    "Relation": "upload",
                    "Object": "tools",
                    "ObjectType": "tool",
                    "tactic": "Execution",
                    "technique": [
                        "T1072-Software Deployment Tools"
                    ],
                    "id": 11
                },
                {
                    "Subject": "threat actors",
                    "SubjectType": "threat-actor",
                    "Relation": "upload",
                    "Object": "Mimikatz",
                    "ObjectType": "tool",
                    "tactic": "Execution",
                    "technique": [
                        "T1072-Software Deployment Tools"
                    ],
                    "id": 12
                },
                {
                    "Subject": "threat actors",
                    "SubjectType": "threat-actor",
                    "Relation": "upload",
                    "Object": "HyperBro",
                    "ObjectType": "Malware",
                    "tactic": "Execution",
                    "technique": [
                        "T1072-Software Deployment Tools"
                    ],
                    "id": 13
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "commonly associated with",
                    "Object": "HyperBro",
                    "ObjectType": "Malware",
                    "tactic": "Execution",
                    "technique": [
                        "T1072-Software Deployment Tools"
                    ],
                    "id": 14
                }
            ]
        },
        "Persistence": {
            "T1505-Server Software Component": [
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "install",
                    "Object": "webshells",
                    "ObjectType": "tool",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 15
                },
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "include",
                    "Object": "Antak webshell",
                    "ObjectType": "Malware",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 16
                },
                {
                    "Subject": "Antak webshell",
                    "SubjectType": "Malware",
                    "Relation": "variant-of",
                    "Object": "China Chopper webshell",
                    "ObjectType": "Malware",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 17
                },
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "include",
                    "Object": "stylecs.aspx",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 18
                },
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "include",
                    "Object": "stylecss.aspx",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 19
                },
                {
                    "Subject": "webshells",
                    "SubjectType": "tool",
                    "Relation": "include",
                    "Object": "test.aspx",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1505-Server Software Component"
                    ],
                    "id": 20
                }
            ]
        },
        "Defense Evasion": {
            "T1574-Hijack Execution Flow": [
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "webshells",
                    "ObjectType": "tool",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 21
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "upload",
                    "Object": "legitimate executables",
                    "ObjectType": "file",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 22
                },
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "run",
                    "Object": "malicious DLLs",
                    "ObjectType": "file",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1574-Hijack Execution Flow"
                    ],
                    "id": 23
                }
            ],
            "T1564-Hide Artifacts": [
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "China Chopper webshell",
                    "ObjectType": "tool",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1564-Hide Artifacts"
                    ],
                    "id": 24
                }
            ]
        },
        "Credential Access": {
            "T1003-OS Credential Dumping": [
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "Mimikatz",
                    "ObjectType": "tool",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 25
                },
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "dump",
                    "Object": "credentials",
                    "ObjectType": "artifact",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 26
                },
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "credentials",
                    "ObjectType": "artifact",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 27
                }
            ],
            "T1552-Unsecured Credentials": [
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "Mimikatz",
                    "ObjectType": "tool",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 25
                },
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "dump",
                    "Object": "credentials",
                    "ObjectType": "artifact",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 26
                },
                {
                    "Subject": "actors",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "credentials",
                    "ObjectType": "artifact",
                    "tactic": "Credential Access",
                    "technique": [
                        "T1003-OS Credential Dumping",
                        "T1552-Unsecured Credentials"
                    ],
                    "id": 27
                }
            ]
        },
        "Discovery": {
            "T1046-Network Service Discovery": [
                {
                    "Subject": "threat group",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "tools",
                    "ObjectType": "tool",
                    "tactic": "Discovery",
                    "technique": [
                        "T1046-Network Service Discovery"
                    ],
                    "id": 29
                }
            ]
        },
        "Lateral Movement": {
            "T1550-Use Alternate Authentication Material": [
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "use",
                    "Object": "stolen credentials",
                    "ObjectType": "artifact",
                    "tactic": "Lateral Movement",
                    "technique": [
                        "T1550-Use Alternate Authentication Material"
                    ],
                    "id": 31
                }
            ],
            "T1210-Exploitation of Remote Services": [
                {
                    "Subject": "Emissary Panda",
                    "SubjectType": "threat-actor",
                    "Relation": "exploit",
                    "Object": "CVE-2017-0144",
                    "ObjectType": "vulnerablity",
                    "tactic": "Lateral Movement",
                    "technique": [
                        "T1210-Exploitation of Remote Services"
                    ],
                    "id": 32
                }
            ]
        },
        "Command and Control": {
            "T1071-Application Layer Protocol": [
                {
                    "Subject": "The HyperBro backdoor",
                    "SubjectType": "Malware",
                    "Relation": "use",
                    "Object": "a C2 server",
                    "ObjectType": "infrastructure",
                    "tactic": "Command and Control",
                    "technique": [
                        "T1071-Application Layer Protocol"
                    ],
                    "id": 33
                }
            ]
        }
    }
}