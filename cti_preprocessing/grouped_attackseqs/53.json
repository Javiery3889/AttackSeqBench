{
    "file_name": "Docless Vietnam APT",
    "tactic_label": true,
    "rewrite": {
        "Initial Access": "A malware was sent to email accounts belonging to a Vietnam government domain on March 13th, 2019. The email, written in Vietnamese, appeared to originate from an internal account (gov.vn) and was flagged as suspicious. The malware was delivered via a zip file attachment that contained a .lnk file simulating a document icon, a technique known to be used by attackers but not widely popular.",
        "Execution": "The .lnk file's target property contained MS-DOS obfuscated code that, when executed, would carve out a base64 encoded PowerShell script named s.ps1 and save it in the %TEMP% directory. This PowerShell script was designed to execute another PowerShell script in memory, which would then run a WScript Shell. The WScript Shell created three files: a decoy DOC file, a legitimate tool for installing .NET assembled files to bypass SmartScreen and AppLocker protection, and a .NET DLL file containing the actual malicious payload.",
        "Persistence": "The PowerShell script checked for administrative privileges and copied the DLL file to WINDIR\\debug\\ or %TEMP% accordingly. It then created a scheduled task with SYSTEM privileges if the user was an administrator, or with lower privileges otherwise. The malware also checked for the presence of Kaspersky antivirus and adjusted its behavior accordingly, either running a VBS script or renaming it to TXT and executing it with wbscript /E:vbscript.",
        "Defense Evasion": "The malware employed a technique using InstallUtil.exe, a legitimate .NET tool, to avoid detection by Smartscreen and Applocker. The DLL was 'uninstalled' using InstallUtil.exe with the '/u' command, which paradoxically installed the malware. The .DAT file generated by the script was a DLL file compiled with .NET that contained the payload and was injected into memory.",
        "Command and Control": "The payload was identified as a Cobalt Strike beacon, evident from its communication pattern with the command and control server.",
        "Others": "The attack targeted the Vietnamese government using a combination of sophisticated techniques. The use of a .LNK file helped evade sandboxes, and the obfuscation techniques kept the malware under the radar. The execution technique allowed the malware to evade Endpoint Detection and Response (EDR) systems by loading through a legitimate binary and working in memory for deobfuscation and injection. The infrastructure used in this attack was not associated with any other known attacks. Indicators of Compromise (IOCs) include the IP address 144.202.54.86, hashes 0476ec8b4cb1b5dd368be52d9249f5b3cf6709b3141e9d02814c05f61cb90a91, 89fdef30c14db09e4e82c561db4a35cbc039b95bdfa6340546f7ee54b887f59b, 52dc9be06e921276c9df828b6be6da994df667e25af03bdddcc6cfec1470f1d7, and the mutex GLOBAL_VMSytnSCg."
    },
    "technique_label": true,
    "triplet_groups": {
        "Initial Access": {
            "T1566-Phishing": [
                {
                    "Subject": "malware",
                    "SubjectType": "Malware",
                    "Relation": "sent to",
                    "Object": "email accounts",
                    "ObjectType": "Email Message",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 1
                },
                {
                    "Subject": "email",
                    "SubjectType": "Email Message",
                    "Relation": "originate from",
                    "Object": "internal account",
                    "ObjectType": "Email Message",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 2
                },
                {
                    "Subject": "malware",
                    "SubjectType": "Malware",
                    "Relation": "delivered via",
                    "Object": "zip file attachment",
                    "ObjectType": "file",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 3
                },
                {
                    "Subject": "zip file attachment",
                    "SubjectType": "file",
                    "Relation": "contain",
                    "Object": ".lnk file",
                    "ObjectType": "file",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 4
                },
                {
                    "Subject": ".lnk file",
                    "SubjectType": "file",
                    "Relation": "simulate",
                    "Object": "document icon",
                    "ObjectType": "artifacts",
                    "tactic": "Initial Access",
                    "technique": [
                        "T1566-Phishing"
                    ],
                    "id": 5
                }
            ]
        },
        "Execution": {
            "T1059-Command and Scripting Interpreter": [
                {
                    "Subject": ".lnk file",
                    "SubjectType": "file",
                    "Relation": "contain",
                    "Object": "MS-DOS obfuscated code",
                    "ObjectType": "artifacts",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 6
                },
                {
                    "Subject": "MS-DOS obfuscated code",
                    "SubjectType": "artifacts",
                    "Relation": "carve out",
                    "Object": "s.ps1",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 7
                },
                {
                    "Subject": "s.ps1",
                    "SubjectType": "file",
                    "Relation": "execute",
                    "Object": "PowerShell script",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 8
                },
                {
                    "Subject": "WScript Shell",
                    "SubjectType": "tool",
                    "Relation": "create",
                    "Object": "decoy DOC file",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 9
                },
                {
                    "Subject": "WScript Shell",
                    "SubjectType": "tool",
                    "Relation": "use",
                    "Object": "legitimate tool",
                    "ObjectType": "tool",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 10
                },
                {
                    "Subject": "WScript Shell",
                    "SubjectType": "tool",
                    "Relation": "contain",
                    "Object": ".NET DLL file",
                    "ObjectType": "file",
                    "tactic": "Execution",
                    "technique": [
                        "T1059-Command and Scripting Interpreter"
                    ],
                    "id": 11
                }
            ]
        },
        "Defense Evasion": {
            "T1127-Trusted Developer Utilities Proxy Execution": [
                {
                    "Subject": "The malware",
                    "SubjectType": "Malware",
                    "Relation": "employ",
                    "Object": "InstallUtil.exe",
                    "ObjectType": "tool",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1127-Trusted Developer Utilities Proxy Execution"
                    ],
                    "id": 12
                },
                {
                    "Subject": "The DLL",
                    "SubjectType": "file",
                    "Relation": "uninstall",
                    "Object": "using InstallUtil.exe",
                    "ObjectType": "tool",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1127-Trusted Developer Utilities Proxy Execution"
                    ],
                    "id": 13
                }
            ],
            "T1553-Subvert Trust Controls": [
                {
                    "Subject": "The .DAT file",
                    "SubjectType": "file",
                    "Relation": "generate",
                    "Object": "DLL file",
                    "ObjectType": "file",
                    "tactic": "Defense Evasion",
                    "technique": [
                        "T1553-Subvert Trust Controls"
                    ],
                    "id": 14
                }
            ]
        },
        "Command and Control": {
            "T1219-Remote Access Software": [
                {
                    "Subject": "The payload",
                    "SubjectType": "Malware",
                    "Relation": "identified as",
                    "Object": "a Cobalt Strike beacon",
                    "ObjectType": "Malware",
                    "tactic": "Command and Control",
                    "technique": [
                        "T1219-Remote Access Software"
                    ],
                    "id": 15
                }
            ]
        },
        "Persistence": {
            "T1053-Scheduled Task/Job": [
                {
                    "Subject": "The PowerShell script",
                    "SubjectType": "tool",
                    "Relation": "check",
                    "Object": "administrative privileges",
                    "ObjectType": "artifact",
                    "tactic": "Persistence",
                    "technique": [
                        "T1053-Scheduled Task/Job"
                    ],
                    "id": 16
                },
                {
                    "Subject": "The PowerShell script",
                    "SubjectType": "tool",
                    "Relation": "copy",
                    "Object": "the DLL file",
                    "ObjectType": "file",
                    "tactic": "Persistence",
                    "technique": [
                        "T1053-Scheduled Task/Job"
                    ],
                    "id": 17
                },
                {
                    "Subject": "The PowerShell script",
                    "SubjectType": "tool",
                    "Relation": "create",
                    "Object": "scheduled task",
                    "ObjectType": "artifact",
                    "tactic": "Persistence",
                    "technique": [
                        "T1053-Scheduled Task/Job"
                    ],
                    "id": 18
                }
            ]
        }
    }
}